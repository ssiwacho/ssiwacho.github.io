<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
        <meta name="date" content="2021-11-28" />
    
    <title>Social Networks Analysis and Visualization</title>

        <script src="document_files/header-attrs-2.11/header-attrs.js"></script>
        <script src="document_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="document_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="document_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="document_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="document_files/navigation-1.1/tabsets.js"></script>
        <link href="document_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="document_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="document_files/robobook-0.1/robobook.css" rel="stylesheet" />
        <link href="document_files/robobook-0.1/robobook_fonts_embed.css" rel="stylesheet" />
        <script src="document_files/robobook-0.1/robobook.js"></script>
        <script src="document_files/htmlwidgets-1.5.4/htmlwidgets.js"></script>
        <script src="document_files/threejs-111/three.min.js"></script>
        <script src="document_files/threejs-111/Detector.js"></script>
        <script src="document_files/threejs-111/Projector.js"></script>
        <script src="document_files/threejs-111/CanvasRenderer.js"></script>
        <script src="document_files/threejs-111/TrackballControls.js"></script>
        <script src="document_files/threejs-111/StateOrbitControls.js"></script>
        <script src="document_files/scatterplotThree-binding-0.3.3/scatterplotThree.js"></script>
        <link href="document_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
        <script src="document_files/crosstalk-1.1.1/js/crosstalk.min.js"></script>
        <script src="document_files/d3-4.5.0/d3.min.js"></script>
        <script src="document_files/forceNetwork-binding-0.4/forceNetwork.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
            <!-- robobook start -->   
   <div class="book with-summary">
      <div class="book-summary">
        <ul>
          <li class="title">Social Networks Analysis and Visualization</li>
          <li class="divider"></li>
        </ul>
        <nav role="navigation" id="toc">
          <ul>
          <li><a href="#social-networks">Social Networks?</a></li>
          <li><a href="#ลักษณะข้อมูล">ลักษณะข้อมูล</a>
          <ul>
          <li><a href="#adjacency-matrix">Adjacency matrix</a></li>
          <li><a href="#edgelist">Edgelist</a></li>
          </ul></li>
          <li><a href="#igraph-package">igraph package</a></li>
          <li><a href="#network-attributes">Network Attributes</a>
          <ul>
          <li><a href="#subsetting-networks">Subsetting networks</a></li>
          <li><a href="#plotting">plotting</a></li>
          <li><a href="#กิจกรรม">กิจกรรม</a></li>
          </ul></li>
          <li><a href="#network-visualization">Network Visualization</a>
          <ul>
          <li><a href="#network-layout">Network layout</a></li>
          <li><a href="#visualizing-edges">Visualizing edges</a></li>
          </ul></li>
          <li><a href="#directed-networks">Directed networks</a>
          <ul>
          <li><a href="#กิจกรรม-1">กิจกรรม</a></li>
          <li><a href="#ความสัมพันธ์ระหว่างจุดยอด">ความสัมพันธ์ระหว่างจุดยอด</a></li>
          <li><a href="#กิจกรรม-2">กิจกรรม</a></li>
          </ul></li>
          <li><a href="#importantinfluential-vertices">Important/Influential vertices</a>
          <ul>
          <li><a href="#degree">degree</a></li>
          <li><a href="#betweenness">betweenness</a></li>
          <li><a href="#eigenvector-centrality">eigenvector centrality</a></li>
          <li><a href="#กิจกรรม-3">กิจกรรม</a></li>
          </ul></li>
          <li><a href="#overall-network-summary">Overall network summary</a>
          <ul>
          <li><a href="#network-density">Network Density</a></li>
          <li><a href="#average-path-length">Average path length</a></li>
          </ul></li>
          <li><a href="#interactive-nework-visualization">Interactive nework visualization</a>
          <ul>
          <li><a href="#threejs">threejs</a></li>
          <li><a href="#networkd3">networkD3</a></li>
          </ul></li>
          </ul>
        </nav>
        <ul class="authors">
          <li class="divider"></li>
                               <li><span><i class="glyphicon glyphicon-calendar"></i> 2021-11-28</span></li>
                  </ul>     
      </div>
      <div class="book-body fixed">
        <div class="body-inner">
            <a class="btn pull-left js-toolbar-action toggle-sidebar" aria-label="Toggle Sidebar" title="Toggle Sidebar" href="#">
              <span class="glyphicon glyphicon-menu-hamburger"></span>
            </a>
            <div class="page-inner">
              <section id="content" class="normal">
      
   
        
      <h1 class="title">Social Networks Analysis and Visualization</h1>
      
        

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="social-networks" class="section level1">
<h1>Social Networks?</h1>
<ul>
<li><p>Network graph คือทัศนภาพที่ใช้แสดงความเชื่อมโยง/ความสัมพันธ์ระหว่างหน่วยข้อมูล</p></li>
<li><p>รูปด้านล่างแสดงตัวอย่างของ network graph สัญลักษณ์วงกลมในรูปใช้แสดงหน่วยข้อมูล (ในที่นี้คือคน) และเส้นเชื่อมใช้แสดงความเชื่อมโยงหรือความสัมพันธ์ระหว่างคนกลุ่มดังกล่าว</p></li>
<li><p>สารสนเทศที่แสดงจาก network graph เป็นไปได้หลากหลายขึ้นอยู่กับข้อมูล เช่นอาจเป็นการแสดงความสัมพันธ์ระหว่างบุคคล การร่วมมือ/โครงข่ายในการดำเนินงาน การติดต่อสื่อสารซึ่งกันและกัน การเดินทาง การเชื่อมโยงกันระหว่างหน่วยข้อมูล เป็นต้น</p></li>
<li><p>จุดยอด (vertex หรือ node) ใช้แทนหน่วยข้อมูล</p></li>
<li><p>เส้นเชื่อม (edge) ใช้แทนความสัมพันธ์ระหว่างหน่วยข้อมูล</p></li>
</ul>
<p><img src="document_files/figure-html/unnamed-chunk-1-1.png" width="768" /></p>
</div>
<div id="ลักษณะข้อมูล" class="section level1">
<h1>ลักษณะข้อมูล</h1>
<p>ข้อมูลที่ใช้สำหรับสร้าง network graph มี 2 ลักษณะ ลักษณะแรกเรียกว่า adjacency matrix และลักษณะที่สองเรียกว่า edgelist</p>
<div id="adjacency-matrix" class="section level2">
<h2>Adjacency matrix</h2>
<p>adjacency matrix คือเมทริกซ์ที่ด้านแถวและคอลัมน์คือจุดยอด และในแต่ละ cell ของเมทริกซ์จะใส่ตัวเลขที่เป็นไปได้ 2 ค่า ได้แก่ 0 กับ 1 โดยที่ถ้ามีค่าเป็น 1 หมายถึง จุดยอดของ cell นั้นมีความเชื่อมโยงกัน ตัวอย่างด้านล่างแสดง adjacency matrix ของ network graph ในข้างต้น</p>
<pre><code>##       บุญหนัก บุญทับ บุญมา บุญรอด บุญมี บุญยิ่ง
## บุญหนัก     0    0    1     1   0    0
## บุญทับ      1    0    0     0   0    0
## บุญมา      0    0    0     0   0    0
## บุญรอด     1    0    0     0   0    0
## บุญมี       0    0    0     0   1    0
## บุญยิ่ง      0    0    0     1   0    1</code></pre>
</div>
<div id="edgelist" class="section level2">
<h2>Edgelist</h2>
<p>Edgelist คือเมทริกซ์ข้อมูล (หรือ data.frame ก็ได้) ที่มี 2 คอลัมน์ แต่ละแถวของเมทริกซ์ดังกล่าวใช้แสดงคู่ของจุดยอดที่เชื่อมโยงกัน ดังตัวอย่างด้านล่าง</p>
<pre><code>##   col1 col2
## 1    A    B
## 2    A    C
## 3    A    D
## 4    A    E
## 5    A    F
## 6    E    F
## 7    F    G</code></pre>
</div>
</div>
<div id="igraph-package" class="section level1">
<h1>igraph package</h1>
<p>มีหลาย package ใน R ที่สามารถใช้สร้าง network graph ได้ เช่น</p>
<ul>
<li><p>igraph</p></li>
<li><p>statnet</p></li>
<li><p>ggnet</p></li>
<li><p>ggnetwork</p></li>
<li><p>ggraph</p></li>
<li><p>visNetwork</p></li>
<li><p>networkD3</p></li>
<li><p>sigma</p></li>
<li><p>rgexf</p></li>
<li><p>treejs</p></li>
</ul>
<p>package หนึ่งที่มีประสิทธิภาพและจะกล่าวถึงในหัวข้อนี้คือ package-igraph การทำงานด้วย igraph มี 2 ขั้นตอน ขั้นแรกคือการสร้าง igraph object จากชุดข้อมูลดิบทั้งที่อยู่ในรูป adjacency matrix และ edgelist และขั้นที่สองคือการสร้าง network graph</p>
<p>จาก edgelist ข้างต้นสามารถนำมาสร้าง igraph object ได้ดังนี้</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">library</span>(igraph)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>g&lt;-<span class="kw">graph.edgelist</span>(<span class="kw">as.matrix</span>(edgelist), <span class="dt">directed=</span><span class="ot">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>g</span></code></pre></div>
<pre><code>## IGRAPH 31360d0 UN-- 7 7 -- 
## + attr: name (v/c)
## + edges from 31360d0 (vertex names):
## [1] A--B A--C A--D A--E A--F E--F F--G</code></pre>
<p>เมื่อเรียก printout ของ igraph object ขึ้นมาดูจะให้สารสนเทศพื้นฐานเกี่ยวกับข้อมูลที่จะนำไปใช้สร้าง network graph ได้แก่ จำนวนจุดยอด, จำนวนเส้นเชื่อม, ตัวแปร attribute (ถ้ามี), …</p>
<p>นอกจากการเรีย printout ตรง ๆ แล้ว igraph ยังมีฟังก์ชันพื้นฐานที่ใช้เรียกดูสารสนเทศด้านต่าง ๆ ของข้อมูล network ได้ด้วย ได้แก่</p>
<ul>
<li><p><code>V()</code> ใช้สำหรับเรียกดูจุดยอดของ network</p></li>
<li><p><code>E()</code> ใช้สำหรับเรียกดูเส้นเชื่อมของ network</p></li>
<li><p><code>gorder()</code> ใช้เรียกดูจำนวนจุดยอดของ network</p></li>
<li><p><code>gsize()</code> ใช้เรียกดูจำนวนเส้นเชื่อมของ network</p></li>
</ul>
<p>การสร้าง network graph จาก igraph object สามารถทำได้ง่าย ๆ โดยใช้ฟังก์ชัน <code>plot()</code> ดังนี้</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">plot</span>(g)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
</div>
<div id="network-attributes" class="section level1">
<h1>Network Attributes</h1>
<p>ผู้วิเคราะห์สามารถใส่สารสนเทศอื่น ๆ ของจุดยอดและเส้นเชื่อมใน network graph เพื่อนำเสนอสารสนเทศที่เป็นคุณลักษณะของหน่วยข้อมูลหรือความสัมพันธ์กันระหว่างหน่วยข้อมูลได้ เรียกคุณลักษณะดังกล่าวว่า network attributes</p>
<ul>
<li><p>attributes ของจุดยอด (vertex attributes) ใช้แสดงคุณลักษณะของหน่วยข้อมูล ซึ่งคุณลักษณะดังกล่าวสามารถกำหนดได้จากทั้งตัวแปรแบบจัดประเภท และตัวแปรเชิงปริมาณ</p></li>
<li><p>attributes ของเส้นเชื่อม (edge attributes) ใช้แสดงคุณลักษณะของความเชื่อมโยงหรือความสัมพันธ์ระหว่างหน่วยข้อมูล เช่น ประเภทของความสัมพันธ์ (มีทิศทาง ไม่มีทิศทาง) ระดับของความสัมพันธ์ หรือความบ่อยในการติดต่อพบเจอกันของหน่วยข้อมูล เป็นต้น</p></li>
<li><p>attribute ที่มักใช้แสดงคุณลักษณะของเส้นเชื่อมบ่อย ๆ คือ ความหนา/น้ำหนักของเส้นเชื่อม ซึ่งปรับน้ำหนักตามค่าของตัวแปรที่ใช้กำหนดคุณลักษณะของเส้นเชื่อมนั้น ๆ</p></li>
</ul>
<p>การใส่ข้อมูลเกี่ยวกับ attribute ของจุดยอดและเส้นเชื่อมใน igraph สามารถทำได้โดยใช้คำสั่ง 2 ตัว ได้แก่</p>
<ul>
<li><code>set_vertex_attr()</code></li>
</ul>
<p>ยกตัวอย่างเช่น</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>g&lt;-<span class="kw">set_vertex_attr</span>(g,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>    <span class="st">&quot;age&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>    <span class="dt">value=</span><span class="kw">runif</span>(<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">30</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="kw">vertex_attr</span>(g)</span></code></pre></div>
<pre><code>## $name
## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot;
## 
## $age
## [1] 24.22599 26.35282 19.30773 24.61097 24.41289 20.75185 27.95434</code></pre>
<p>ในทำนองเดียวกัน การใส่สารสนเทศให้กับเส้นเชื่อสามารถทำได้โดยใช้ฟังก์ชัน</p>
<ul>
<li><code>set_edge_attr()</code></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>g&lt;-<span class="kw">set_edge_attr</span>(g,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>    <span class="st">&quot;freq&quot;</span>, <span class="co"># ความบ่อยในการติดต่อ</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    <span class="dt">value=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="kw">edge_attr</span>(g)</span></code></pre></div>
<pre><code>## $freq
## [1] 2 1 1 1 3 4 2</code></pre>
<ul>
<li>จาก printout ของ igraph ข้่้างต้นจะเห็นว่า network graph ที่สร้างขึ้นนี้มี attributes ของ จุดยอด 1 ตัวได้แก่ name</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>g</span></code></pre></div>
<pre><code>## IGRAPH 31360d0 UN-- 7 7 -- 
## + attr: name (v/c), age (v/n), freq (e/n)
## + edges from 31360d0 (vertex names):
## [1] A--B A--C A--D A--E A--F E--F F--G</code></pre>
<p>อีกวิธีการหนึ่งในการสร้าง igraph object คือการใช้ฟังก์ชัน <code>graph_from_data_frame()</code> ซึ่งสะดวกในกรณีที่ผู้วิเคราะห์มีชุดข้อมูลแบบ data.frame ที่จะใช้สำหรับทำ network graph อยู่แล้ว โดยชุดข้อมูลดังกล่าวต้องประกอบด้วย ชุดข้อมูลของจุดยอด (vertices dataframe) และชุดข้อมูลของเส้นเชื่อม (edge dataframe) เช่น</p>
<p><img src="Screen%20Shot%202564-11-28%20at%2007.32.47.png" style="width:70.0%" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>vertices.df&lt;-<span class="kw">data.frame</span>(<span class="dt">name=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>],</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>                        <span class="dt">age=</span><span class="kw">runif</span>(<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">30</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>                        )</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>edge.df&lt;-<span class="kw">data.frame</span>(<span class="dt">from=</span>col1,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>                    <span class="dt">to=</span>col2,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a>                    <span class="dt">frequency=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>g&lt;-<span class="kw">graph_from_data_frame</span>(<span class="dt">vertices=</span>vertices.df,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>                        <span class="dt">d=</span>edge.df,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>                        <span class="dt">directed=</span><span class="ot">FALSE</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a>g</span></code></pre></div>
<pre><code>## IGRAPH 2c45222 UN-- 7 7 -- 
## + attr: name (v/c), age (v/n), frequency (e/n)
## + edges from 2c45222 (vertex names):
## [1] A--B A--C A--D A--E A--F E--F F--G</code></pre>
<div id="subsetting-networks" class="section level2">
<h2>Subsetting networks</h2>
<p>ผู้วิเคราะห์สามารถแบ่งส่วนย่อยของ network graph โดยใช้ attribute ของ network เป็นตัวคัดกรองได้ เช่น</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">E</span>(g)[[<span class="kw">inc</span>(<span class="st">&quot;E&quot;</span>)]] <span class="co"># เรียกดูเฉพาะส่วนที่เกี่ยวข้องกับจุดยอด E</span></span></code></pre></div>
<pre><code>## + 2/7 edges from 2c45222 (vertex names):
##   tail head tid hid frequency
## 4    A    E   1   5         1
## 6    E    F   5   6         4</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">E</span>(g)[[frequency<span class="op">&gt;</span><span class="dv">3</span>]] <span class="co"># เรียกดูเฉพาะส่วนที่ frequency &gt; 3</span></span></code></pre></div>
<pre><code>## + 1/7 edge from 2c45222 (vertex names):
##   tail head tid hid frequency
## 6    E    F   5   6         4</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="kw">V</span>(g)[[age<span class="op">&gt;</span><span class="dv">25</span>]] <span class="co"># เรียกดูเฉพาะส่วนที่เกี่ยวข้องกับหน่วยข้อมูลที่อายุมากกว่า 25 ปี</span></span></code></pre></div>
<pre><code>## + 2/7 vertices, named, from 2c45222:
##   name      age
## 1    A 25.34716
## 7    G 27.23301</code></pre>
</div>
<div id="plotting" class="section level2">
<h2>plotting</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">V</span>(g)<span class="op">$</span>color.age&lt;-<span class="kw">ifelse</span>(<span class="kw">V</span>(g)<span class="op">$</span>age<span class="op">&gt;</span><span class="dv">25</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>g</span></code></pre></div>
<pre><code>## IGRAPH 2c45222 UN-- 7 7 -- 
## + attr: name (v/c), age (v/n), color.age (v/c), frequency (e/n)
## + edges from 2c45222 (vertex names):
## [1] A--B A--C A--D A--E A--F E--F F--G</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="kw">plot</span>(g, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>    <span class="dt">vertex.color=</span><span class="kw">V</span>(g)<span class="op">$</span>color.age,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>    <span class="dt">vertex.label.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>    <span class="dt">vertex.size=</span><span class="dv">45</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>    <span class="dt">font.family=</span><span class="st">&quot;ChulaChrasNew&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a>    )</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
</div>
<div id="กิจกรรม" class="section level2">
<h2>กิจกรรม</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="kw">library</span>(tm)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a>dat&lt;-<span class="kw">read_excel</span>(<span class="st">&quot;/Users/siwachoat/Downloads/data_AJ suchada.xlsx&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a>dat&lt;-<span class="kw">data.frame</span>(dat)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="kw">plot</span>(g)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-13-1.png" width="768" /></p>
</div>
</div>
<div id="network-visualization" class="section level1">
<h1>Network Visualization</h1>
<p>การสร้างทัศนภาพของ network สามารถทำได้หลายลักษณะ ขึ้นอยู่กับการจัดวาง/ออกแบบ layout ของจุดยอดและเส้นเชื่อม การจัดวาง layout ที่เหมาะสมจะช่วยให้ผู้อ่านสามารถทำความเข้าใจสารสนเทศเชิงลึกใน network ได้อย่างรวดเร็วและแม่นยำ</p>
<p><img src="Screen%20Shot%202564-11-28%20at%2008.17.40.png" /></p>
<ul>
<li><p>size ของจุดยอด เหมาะสำหรับนำเสนอจุดยอดสำคัญ หรือ influencer ของ network นั้น ๆ</p></li>
<li><p>label ช่วยในการระบุตัวตนของจุดยอดที่สำคัญ อย่างไรก็ตามการใส่ label มากจนเกินไปทำให้การอ่าน network graph ทำได้ยากดังตัวอย่างในกิจกรรมข้างต้น</p></li>
<li><p>color และ shape ช่วยให้การจำแนกความแตกต่างระหว่างจุดยอดที่ต่างประเภทกัน</p></li>
<li><p>edge ได้แก่ การปรับเปลี่ยนน้ำหนัก สี และลักษณะของเส้นเชื่อม ซึ่งช่วยให้สามารถนำเสนอสารสนเทศในมิติต่าง ๆ เกี่ยวกับความสัมพันธ์ระหว่างหน่วยข้อมูลได้</p></li>
</ul>
<p><strong>note:</strong> การเลือกกำหนด visual element ต่าง ๆ ของ network ในข้างต้น ควรพิจารณาว่าการกำหนดดังกล่าวสามารถนำเสนอสารสนเทศสำคัญของ network ได้ดีมากน้อยเพียงใด</p>
<div id="network-layout" class="section level2">
<h2>Network layout</h2>
<p>layout หรือการจัดวางจุดยอดและเส้นเชื่อมใน network เป็นอีกหนึ่งปัจจัยที่มีผลต่อคุณภาพของ network ที่สร้างขึ้น ในชุดข้อมูลขนาดใหญ่เป็นไปได้ยากที่ผู้วิเคราะห์จะทำการจัดวางตำแหน่งของจุดยอดและเส้นเชื่อมด้วยตัวเอง จึงมีการพัฒนาอัลกอริทึมทางคณิตศาสตร์ที่ช่วยในการจัดวาง layout ของ network โดยอัตโนมัติ อัลกอริทึมที่แตกต่างกันจะจัดวาง layout ด้วยหลักคิดที่แตกต่างกัน และมีความเหมาะสมกับสถานการณ์/ชุดข้อมูลที่แตกต่างกันด้วย ผู้วิเคราะห์สามารถกำหนดวิธีการจัดวางได้จากอาร์กิวเมนท์ <code>layout</code> ทั้งนี้การพิจารณา layout ที่เหมาะสมอาจพิจารณาจาก เกณฑ์ต่อไปนี้</p>
<ul>
<li><p>เส้นเชื่อมที่ซ้อนทับกันควรมีจำนวนน้อยที่สุด</p></li>
<li><p>จุดยอดของ network ต้องไม่ซ้อนทับกัน</p></li>
<li><p>ความยาวของเส้นเชื่อมแต่ละเส้นระหว่างจุดยอดควรมีความยาวเท่าเทียมกัน</p></li>
<li><p>รูปร่างของ network ควรมีลักษณะสมมาตรเท่าที่จะเป็นไปได้</p></li>
<li><p>key node/influencer ควรอยู่ตำแหน่งตรงกลางของ network</p></li>
</ul>
<p>igraph มีอัลกอริทึมสำหรับจัดวาง layout ของ network หลายตัว เช่น</p>
<p><img src="Screen%20Shot%202564-11-28%20at%2008.31.39.png" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>vertices.df&lt;-<span class="kw">data.frame</span>(<span class="dt">name=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>],</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>                        <span class="dt">age=</span><span class="kw">runif</span>(<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">30</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>                        )</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>edge.df&lt;-<span class="kw">data.frame</span>(<span class="dt">from=</span>col1,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>                    <span class="dt">to=</span>col2,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a>                    <span class="dt">frequency=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>g&lt;-<span class="kw">graph_from_data_frame</span>(<span class="dt">vertices=</span>vertices.df,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a>                        <span class="dt">d=</span>edge.df,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a>                        <span class="dt">directed=</span><span class="ot">FALSE</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a>g</span></code></pre></div>
<pre><code>## IGRAPH ea103b7 UN-- 7 7 -- 
## + attr: name (v/c), age (v/n), frequency (e/n)
## + edges from ea103b7 (vertex names):
## [1] A--B A--C A--D A--E A--F E--F F--G</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="kw">plot</span>(g, <span class="dt">layout =</span> <span class="kw">layout_in_circle</span>(g),</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>        <span class="dt">vertex.label=</span><span class="ot">NA</span>)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-14-1.png" width="768" /></p>
</div>
<div id="visualizing-edges" class="section level2">
<h2>Visualizing edges</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>w&lt;-<span class="kw">E</span>(g)<span class="op">$</span>frequency <span class="co">#น้ำหนักของเส้นเชื่อม</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>m1&lt;-<span class="kw">layout_nicely</span>(g)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a><span class="kw">plot</span>(g, <span class="dt">vertex.label.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a>        <span class="dt">edge.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>        <span class="dt">edge.width=</span>w,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>        <span class="dt">layout=</span>m1)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-15-1.png" width="768" /></p>
<p>ในกรณีที่เส้นเชื่อมมีจำนวนมากเกินไป และมีบางเส้นที่ไม่จำเป็นต้อง plot ลงบน graph ผู้วิเคราะห์สามารถตัดเส้นเชื่อมดังกล่าวออกไปได้ โดยใช้ฟังก์ชัน <code>delete_edges()</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a>g2&lt;-<span class="kw">delete_edges</span>(g, <span class="kw">E</span>(g)[[frequency<span class="op">&lt;</span><span class="dv">2</span>]])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>w2&lt;-<span class="kw">E</span>(g2)<span class="op">$</span>frequency</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="kw">plot</span>(g2, <span class="dt">vertex.label.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>        <span class="dt">edge.color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>        <span class="dt">edge.width=</span>w2,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>        <span class="dt">layout=</span>m1)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
</div>
</div>
<div id="directed-networks" class="section level1">
<h1>Directed networks</h1>
<p>undirected network ในหัวข้อที่ผ่านมาใช้สำหรับบรรยายความสัมพันธ์แบบไม่มีทิศทางระหว่างหน่วยข้อมูล อย่างไรก็ตามในบางกรณีผู้วิเคราะห์อาจมีข้อมูลเกี่ยวกับทิศทางของความสัมพันธ์ระหว่างจุดยอด ซึ่งสามารถนำเสนอผ่าน directed network ที่ใช้ลูกศรเป็นบนเส้นเชื่อมเป็นสัญลักษณ์แทนทิศทางความสัมพันธ์</p>
<p><img src="Screen%20Shot%202564-11-28%20at%2009.34.37.png" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a>vertices.df&lt;-<span class="kw">data.frame</span>(<span class="dt">name=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>],</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>                        <span class="dt">age=</span><span class="kw">runif</span>(<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">30</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>                        )</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a>edge.df&lt;-<span class="kw">data.frame</span>(<span class="dt">from=</span>col1,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>                    <span class="dt">to=</span>col2,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a>                    <span class="dt">frequency=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a>g&lt;-<span class="kw">graph_from_data_frame</span>(<span class="dt">vertices=</span>vertices.df,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a>                        <span class="dt">d=</span>edge.df,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a>                        <span class="dt">directed=</span>T)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a>g</span></code></pre></div>
<pre><code>## IGRAPH f35b453 DN-- 7 7 -- 
## + attr: name (v/c), age (v/n), frequency (e/n)
## + edges from f35b453 (vertex names):
## [1] A-&gt;B A-&gt;C A-&gt;D A-&gt;E A-&gt;F E-&gt;F F-&gt;G</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">plot</span>(g)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
<p>directed network สามารถใช้เป็นเครื่องมือในการระบุความสำคัญของหน่วยข้อมูลที่แทนด้วยจุดยอดแต่ละจุดได้ โดยอาจพิจารณาจากจำนวนลูกศรที่ออกจากจุดยอด (out-degree) หรือจำนวนลูกศรที่ชี้เข้าจุดยอด (in-degree) ขึ้นอยู่กับความหมายของความสัมพันธ์ใน network</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a>g[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>] <span class="co">#มีเส้นเชื่อมระหว่าง A กับ B หรือไม่</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a>g[<span class="st">&quot;A&quot;</span>,<span class="st">&quot;G&quot;</span>]</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="kw">incident</span>(g, <span class="st">&quot;A&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>)) <span class="co">#แสดงเส้นเชื่อมทั้งหมดของ A</span></span></code></pre></div>
<pre><code>## + 5/7 edges from f35b453 (vertex names):
## [1] A-&gt;B A-&gt;C A-&gt;D A-&gt;E A-&gt;F</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="kw">incident</span>(g, <span class="st">&quot;F&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))</span></code></pre></div>
<pre><code>## + 3/7 edges from f35b453 (vertex names):
## [1] F-&gt;G A-&gt;F E-&gt;F</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="kw">head_of</span>(g, <span class="kw">E</span>(g)) <span class="co">#จุดยอดที่เป็นจุดเริ่มต้นทั้งหมดใน network g</span></span></code></pre></div>
<pre><code>## + 7/7 vertices, named, from f35b453:
## [1] B C D E F F G</code></pre>
<div id="กิจกรรม-1" class="section level2">
<h2>กิจกรรม</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>dat2&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;COVID.csv&quot;</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a>covid&lt;-<span class="kw">data.frame</span>(<span class="dt">from=</span>dat2<span class="op">$</span>infector, <span class="dt">to=</span>dat2<span class="op">$</span>case_ID)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a>g.covid&lt;-<span class="kw">graph_from_data_frame</span>(covid, <span class="dt">directed=</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in graph_from_data_frame(covid, directed = TRUE): In `d&#39; `NA&#39; elements
## were replaced with string &quot;NA&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a><span class="kw">plot</span>(g.covid, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>     <span class="dt">vertex.label.color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a>     <span class="dt">edge.color =</span> <span class="st">&#39;gray77&#39;</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a>     <span class="dt">vertex.size =</span> <span class="dv">0</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a>     <span class="dt">edge.arrow.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a>     <span class="dt">layout =</span> <span class="kw">layout_nicely</span>(g.covid))</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-20-1.png" width="768" /></p>
<ul>
<li><p>หน่วยข้อมูล 184 มี total-degree เท่ากับเท่าใด?</p></li>
<li><p>หน่วยข้อมูล 184 มี out-degree เท่ากับเท่าใด?</p></li>
</ul>
</div>
<div id="ความสัมพันธ์ระหว่างจุดยอด" class="section level2">
<h2>ความสัมพันธ์ระหว่างจุดยอด</h2>
<p>การวิเคราะห์ความสัมพันธ์ระหว่างจุดยอดใน network สามารถทำได้หลายวิธีการ วิธีการหนึ่งคือการระบุ neighborhood ของจุดยอด โดยพิจารณาจากเส้นเชื่อมระหว่างจุดยอด</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="kw">plot</span>(g)</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-21-1.png" width="768" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="kw">neighbors</span>(g,<span class="st">&quot;A&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))</span></code></pre></div>
<pre><code>## + 5/7 vertices, named, from f35b453:
## [1] B C D E F</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="kw">neighbors</span>(g,<span class="st">&quot;F&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))</span></code></pre></div>
<pre><code>## + 3/7 vertices, named, from f35b453:
## [1] A E G</code></pre>
<p>ฟังก์ชัน <code>intersection()</code> สามารถใช้ตรวจสอบความสัมพันธ์ทางอ้อมระหว่างจุดยอดได้</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a>x&lt;-<span class="kw">neighbors</span>(g,<span class="st">&quot;B&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a>y&lt;-<span class="kw">neighbors</span>(g,<span class="st">&quot;E&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a><span class="kw">intersection</span>(x,y)</span></code></pre></div>
<pre><code>## + 1/7 vertex, named, from f35b453:
## [1] A</code></pre>
<p>วิธีการที่สองที่ใช้วิเคราะห์ความสัมพันธ์ระหว่างจุดยอดใน network คือการพิจารณาจากความยาวของเส้นทางที่เชื่อมระหว่างจุดยอด กล่าวคือ</p>
<ul>
<li><p>ถ้าจุดยอดที่พิจารณาอยู่ภายใต้ neighborhood เดียวกัน path length จะมีค่าเท่ากับ 1</p></li>
<li><p>ถ้าจุดยอดที่พิจารณาอยู่คนละ neighborhood แล้ว path length จะมีค่ามากกว่า 1</p></li>
</ul>
<p>ในการวิเคราะห​์ network ตัวชี้วัดหนึ่งที่มักใช่้พิจารณาความสัมพันธ์ระหว่างจุดยอดคือ diameter ของ network ที่มีค่าเท่ากับ path length ที่มากที่สุดของ network นั้น การหา diameter ของ network สามารถทำได้โดยใช้ฟังก์ชัน <code>farthest_vertices()</code></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a><span class="kw">farthest_vertices</span>(g)</span></code></pre></div>
<pre><code>## $vertices
## + 2/7 vertices, named, from f35b453:
## [1] A G
## 
## $distance
## [1] 2</code></pre>
<p>และการหาเส้นทางการเชื่อมโยงกันระหว่างจุดยอดที่อยู่ห่างกันมากที่สุด สามารถทำได้โดยใช้ฟังก์ชัน <code>get_diameter()</code></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a><span class="kw">get_diameter</span>(g)</span></code></pre></div>
<pre><code>## + 3/7 vertices, named, from f35b453:
## [1] A F G</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a><span class="kw">ego</span>(g, <span class="dv">2</span>, <span class="st">&quot;A&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;out&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## + 7/7 vertices, named, from f35b453:
## [1] A B C D E F G</code></pre>
</div>
<div id="กิจกรรม-2" class="section level2">
<h2>กิจกรรม</h2>
<p>จาก COVID network ที่สร้างไว้ข้างต้น</p>
<ol style="list-style-type: decimal">
<li><p>จงหา neighborhood ของหน่วยข้อมูลเบอร์ 12 (ทุก direction)</p></li>
<li><p>จงหาหน่วยข้อมูลที่ติดโรคจากหน่วยข้อมูลเบอร์ 12</p></li>
<li><p>จงหาหน่วยข้อมูลที่แพร่เชื้อมาให้หน่วยข้อมูลเบอร์ 12</p></li>
<li><p>network นี้มีการแพร่เชื้อติดต่อกันไกลที่สุดแค่ไหน</p></li>
<li><p>เส้นทางการติดต่อที่ไกลที่สุดเป็นอย่างไร</p></li>
</ol>
</div>
</div>
<div id="importantinfluential-vertices" class="section level1">
<h1>Important/Influential vertices</h1>
<p>การระบุว่าจุดยอดใดเป็นจุดยอดที่มีความสำคัญหรือเป็นจุดยอดที่มีอิทธิพลสามารถพิจารณาได้จากหลายตัวบ่งชี้</p>
<ul>
<li><p>degree</p></li>
<li><p>betweenness</p></li>
<li><p>eigenvector centrality</p></li>
<li><p>closeness centrality</p></li>
<li><p>pagerank centrality</p></li>
</ul>
<div id="degree" class="section level2">
<h2>degree</h2>
<p>คือจำนวนเส้นเชื่อมที่เข้าหาหรือส่งออกจากจุดยอดแต่ละจุด การหา degree ของแต่ละจุดยอดสามารถทำได้โดยใช้ฟังก์ชัน <code>degree()</code></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a><span class="kw">degree</span>(g, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;out&quot;</span>))</span></code></pre></div>
<pre><code>## A B C D E F G 
## 5 0 0 0 1 1 0</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="kw">degree</span>(g, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;in&quot;</span>))</span></code></pre></div>
<pre><code>## A B C D E F G 
## 0 1 1 1 1 2 1</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a><span class="kw">degree</span>(g, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))</span></code></pre></div>
<pre><code>## A B C D E F G 
## 5 1 1 1 2 3 1</code></pre>
</div>
<div id="betweenness" class="section level2">
<h2>betweenness</h2>
<p>จุดยอดที่มีค่า betweenness สูงคือจุดยอดที่เป็นจุดเชื่อมของหลาย ๆ ทางเชื่อมที่สั้นที่สุดระหว่งจุดยอดอื่น ๆ ใน network ยกตัวอย่างเช่น</p>
<p><img src="Screen%20Shot%202564-11-28%20at%2010.57.40.png" /></p>
<p>จากรูปจะเห็นว่าการเชื่อมโยงที่สั้นที่สุดระหว่างจุดยอดหลาย ๆ คู่ จำเป็นจะต้องผ่าน A เป็นส่วนมาก ในกรณีนี้จุดยอด A จะมีค่า betweenness สูง การหายไปของจุดยอด A จะตัดการเชื่อมโยงระหว่างจุดยอดหลายกลุ่มใน network นี้ จุดยอด A ในทางกลับกันจุดยอด J, K, L, B,… ไม่ได้เป็นจุดยอดที่ทำหน้าที่เป็นตัวเชื่อมเหมือน A การขาดหายไปของจุดยอดดังกล่าวจะทำให้หน่วยข้อมูลลดลงเท่านั้น แต่ไม่ได้กระทบการเชื่อมโยงของ network อย่างมีนัยสำคัญ</p>
<p>ค่าสถิติ betweenness สามารถคำนวณได้จากฟังก์ชัน <code>betweenness()</code> ฟังก์ชันดังกล่าวมีอาร์กิวเมนท์สำคัญ 3 ตัวได้แก่ <code>igraph object</code>, <code>directed = T or F</code> และ <code>normalized =T or F</code></p>
</div>
<div id="eigenvector-centrality" class="section level2">
<h2>eigenvector centrality</h2>
<p>เป็นค่าสถิติที่ใช้วัดว่าจุดยอดแต่ละจุดนั้นมีการเชื่อมโยงกับจุดยอดที่มี degree สูงจุดอื่น ๆ มากน้อยแค่ไหน</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a><span class="kw">eigen_centrality</span>(g)<span class="op">$</span>vector <span class="co">#calculate eigenvector centrality score</span></span></code></pre></div>
<pre><code>##         A         B         C         D         E         F         G 
## 1.0000000 0.3854455 0.3854455 0.3854455 0.6782950 0.7597688 0.2928495</code></pre>
</div>
<div id="กิจกรรม-3" class="section level2">
<h2>กิจกรรม</h2>
<p>จากชุดข้อมูล covid</p>
<ol style="list-style-type: decimal">
<li><p>คำนวณ out-degree ของแต่ละจุดยอด เพื่อวิเคราะห์รูปแบบการแพร่เชื้อและพิจารณาว่าหน่วยข้อมูลใดเป็น infector ที่สำคัญ</p></li>
<li><p>หน่วยข้อมูลที่แพร่เชื้อมากที่สุด เป็นหน่วยข้อมูลใด และแพร่เชื้อให้คนอื่นกี่คน</p></li>
<li><p>คำนวณค่า betweenness ของแต่ละจุดยอด</p></li>
<li><p>สำรวจการแจกแจงของ betweenness พบอะไรบ้าง</p></li>
<li><p>ลอง plot network อีกครั้งโดยกำหนดให้ vertex.size แปรผันตามคะแนน betweenness ผลลัพธ์ที่ได้เป็นอย่างไร?</p></li>
</ol>
<p><img src="document_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
<p>เราสามารถตัดส่วนย่อยของ network ขึ้นมาวิเคราะห์ได้ เช่น</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a>g.covid184&lt;-<span class="kw">make_ego_graph</span>(g.covid, <span class="kw">diameter</span>(g), <span class="dt">nodes=</span><span class="st">&quot;184&quot;</span>, <span class="dt">mode=</span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>))[[<span class="dv">1</span>]]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a><span class="kw">plot</span>(g.covid184, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true"></a>     <span class="co">#vertex.label = NA,</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true"></a>     <span class="dt">edge.color =</span> <span class="st">&#39;grey&#39;</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true"></a>     <span class="dt">edge.size=</span><span class="dv">1</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true"></a>     <span class="dt">vertex.size =</span> <span class="kw">sqrt</span>(<span class="kw">betweenness</span>(g.covid, <span class="dt">directed=</span>T)),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true"></a>     <span class="dt">edge.arrow.size =</span> <span class="fl">0.5</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true"></a>     <span class="dt">layout =</span> <span class="kw">layout_nicely</span>(g.covid184))</span></code></pre></div>
<pre><code>## Warning in layout[, 1] + label.dist * cos(-label.degree) * (vertex.size + :
## longer object length is not a multiple of shorter object length</code></pre>
<pre><code>## Warning in layout[, 2] + label.dist * sin(-label.degree) * (vertex.size + :
## longer object length is not a multiple of shorter object length</code></pre>
<p><img src="document_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
<p>ฟังก์ชัน distance() สามารถใข้คำนวณ path length จากจุดยอดที่กำหนดไปยังจุดยอดอื่น ๆ ใน network ได้ ซึ่งมีประโยชน์มากในการสร้างสารสนเทศเพื่อแสดงอิทธิพลการแพร่เชื้อของหน่วยข้อมูล 184</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a>dists&lt;-<span class="kw">distances</span>(g.covid184, <span class="st">&quot;184&quot;</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a><span class="kw">summary</span>(dists)</span></code></pre></div>
<pre><code>##        45         180          42         182          12         181   
##  Min.   :1   Min.   :2   Min.   :2   Min.   :1   Min.   :2   Min.   :1  
##  1st Qu.:1   1st Qu.:2   1st Qu.:2   1st Qu.:1   1st Qu.:2   1st Qu.:1  
##  Median :1   Median :2   Median :2   Median :1   Median :2   Median :1  
##  Mean   :1   Mean   :2   Mean   :2   Mean   :1   Mean   :2   Mean   :1  
##  3rd Qu.:1   3rd Qu.:2   3rd Qu.:2   3rd Qu.:1   3rd Qu.:2   3rd Qu.:1  
##  Max.   :1   Max.   :2   Max.   :2   Max.   :1   Max.   :2   Max.   :1  
##        22          10          31          34          17          93   
##  Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :2   Median :2   Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##       178         184          8           56          58         186   
##  Min.   :1   Min.   :0   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:1   1st Qu.:0   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :1   Median :0   Median :2   Median :2   Median :2   Median :2  
##  Mean   :1   Mean   :0   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:1   3rd Qu.:0   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :1   Max.   :0   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##        11          19          64         179          74          5    
##  Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :2   Median :2   Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##        78          39          82          44          1           47   
##  Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :2   Median :2   Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##       183          97          21          37          16         116   
##  Min.   :1   Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:1   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :1   Median :2   Median :2   Median :2   Median :2   Median :2  
##  Mean   :1   Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:1   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :1   Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##        14          NA         145         153         156         174   
##  Min.   :2   Min.   :1   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:1   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :1   Median :2   Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :1   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:1   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :1   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##       173         177          2           9           15          20   
##  Min.   :2   Min.   :1   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:1   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :1   Median :2   Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :1   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:1   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :1   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##        23          26          30          32          33          35   
##  Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :2   Median :2   Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2   Max.   :2  
##        46          94         141   
##  Min.   :2   Min.   :2   Min.   :2  
##  1st Qu.:2   1st Qu.:2   1st Qu.:2  
##  Median :2   Median :2   Median :2  
##  Mean   :2   Mean   :2   Mean   :2  
##  3rd Qu.:2   3rd Qu.:2   3rd Qu.:2  
##  Max.   :2   Max.   :2   Max.   :2</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="kw">table</span>(dists)</span></code></pre></div>
<pre><code>## dists
##  0  1  2 
##  1  7 49</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>pal&lt;-<span class="kw">brewer.pal</span>(<span class="st">&quot;RdBu&quot;</span>,<span class="dt">n=</span><span class="dv">11</span>)[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">11</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="kw">V</span>(g.covid184)<span class="op">$</span>color&lt;-pal[dists<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a><span class="kw">plot</span>(g.covid184, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true"></a>     <span class="dt">vertex.label =</span> dists,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true"></a>     <span class="dt">vertex.label.color=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true"></a>     <span class="dt">vertex.color=</span><span class="kw">V</span>(g.covid184)<span class="op">$</span>color,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true"></a>     <span class="dt">edge.color =</span> <span class="st">&#39;grey&#39;</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true"></a>     <span class="co">#vertex.size = sqrt(betweenness(g.covid, directed=T)),</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true"></a>     <span class="dt">edge.arrow.size =</span> <span class="fl">0.05</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true"></a>     <span class="dt">layout =</span> <span class="kw">layout_nicely</span>(g.covid184))</span></code></pre></div>
<p><img src="document_files/figure-html/unnamed-chunk-32-1.png" width="768" /></p>
</div>
</div>
<div id="overall-network-summary" class="section level1">
<h1>Overall network summary</h1>
<div id="network-density" class="section level2">
<h2>Network Density</h2>
<p>ใช้วิเคราะห์ความหนาแน่นของการเชื่อมโยงภายใน network มีค่าเท่ากับสัดส่วนของเส้นเชื่อมต่อจำนวนเส้นเชื่อมทั้งหมดที่เป็นไปได้</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="kw">edge_density</span>(g)</span></code></pre></div>
<pre><code>## [1] 0.1666667</code></pre>
</div>
<div id="average-path-length" class="section level2">
<h2>Average path length</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="kw">mean_distance</span>(g, <span class="dt">directed=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 1.222222</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="kw">mean_distance</span>(g, <span class="dt">directed=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 1.809524</code></pre>
</div>
</div>
<div id="interactive-nework-visualization" class="section level1">
<h1>Interactive nework visualization</h1>
<p>โปรแกรม R มี package หลายตัวที่สามารถใช้สร้าง interactive network visualization ได้</p>
<div id="threejs" class="section level2">
<h2>threejs</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="kw">library</span>(threejs)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a><span class="kw">graphjs</span>(g.covid184,</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true"></a>        <span class="dt">vertex.size=</span><span class="dv">1</span>)</span></code></pre></div>
<div id="3ygstojkTs" style="width:768px;height:480px;" class="scatterplotThree html-widget"></div>
<script type="application/json" data-for="3ygstojkTs">{"x":{"NROW":57,"height":null,"width":null,"axis":false,"numticks":[6,6,6],"xticklabs":null,"yticklabs":null,"zticklabs":null,"color":[["#D1E5F0","#053061","#053061","#D1E5F0","#053061","#D1E5F0","#053061","#053061","#053061","#053061","#053061","#053061","#D1E5F0","#67001F","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#D1E5F0","#053061","#053061","#053061","#053061","#053061","#053061","#D1E5F0","#053061","#053061","#053061","#053061","#053061","#D1E5F0","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061","#053061"]],"size":1,"stroke":"black","flipy":true,"grid":false,"renderer":"auto","signif":8,"bg":"white","cexsymbols":1,"xlim":[-1,1],"ylim":[-1,1],"zlim":[-1,1],"axisscale":[1,1,1],"pch":["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],"elementId":"3ygstojkTs","from":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,5,5,5,5,5,5,5,5,12,13,13,13,13,13,13,30,37,37,37,37,43,43]],"to":[[4,6,7,8,11,14,15,16,17,20,22,23,25,26,27,28,29,31,35,38,39,40,44,46,48,49,50,51,52,54,18,33,45,53,9,10,19,24,32,34,36,47,2,0,3,5,12,30,43,55,13,41,42,56,1,21]],"lwd":1,"linealpha":1,"center":true,"main":[""],"options":true,"alpha":[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"vertices":[[-0.61504244,0.27627292,-0.10615732,0.57775963,1,-0.21173242,0.55008069,-1,-0.49988196,0.46406732,0.28977316,-0.67980007,-0.74610473,0.2181429,-0.51111443,0.74149565,-0.52689855,0.63027797,-0.6864597,0.2475678,0.30117873,-0.47591246,0.75836903,-0.21991112,-0.59184236,0.62830283,-0.43174182,0.73254462,-0.57450736,1,0.86479492,-0.97899328,0.61791898,-0.66257406,0.86872707,0.034459946,0.42589055,-0.5852578,-0.29923601,0.27548736,-0.014393785,-0.063527836,-0.96622814,0.20295686,0.053018219,-0.59101141,-0.10547744,0.18490798,-0.82567084,0.21812319,0.28475136,-0.85724454,0.27562177,-0.39411743,0.64368949,0.29968604,-0.92316944,0.85493594,-0.36580377,0.96205315,-0.89499112,0.66867619,-0.10803614,0.6424374,0.98626543,-0.066511823,-0.39686914,0.53429989,0.010481059,-0.62229473,-0.21705894,-0.33557573,0.88392429,-0.91394322,0.84041641,-0.67637842,0.57649755,0.25267937,-0.74263355,-0.24861045,-0.097551699,-0.61862753,-0.33375232,-0.11299471,-0.63597141,-0.011856096,-0.46882172,-0.55080145,0.73209834,0.1542954,0.5301454,-0.16483547,-0.25457154,-0.71652862,0.80756453,-0.28017843,0.73051613,-0.88168325,0.90200948,0.49646775,0.53171258,-0.99319366,1,-0.70917314,0.60419797,-0.80798501,0.57849997,0.01806562,0.96955613,-0.45296743,0.8757294,0.72323757,0.16422424,-0.019948482,-0.48141847,-0.18969815,-0.021301678,-0.92155132,-0.06109894,-0.15005677,-1,0.15388981,-0.15962248,0.90215642,0.42871587,0.11203216,0.97736692,0.14964521,0.031210601,0.4754046,0.6018715,-0.10004076,-0.95594176,0.41430453,-0.17860723,0.48690311,0.20655083,-1,-0.86613333,-0.2311305,-0.072487589,0.98243716,-0.6093735,0.77148649,-0.93118297,0.2383179,0.19117729,-0.72923026,0.87825242,-0.13328717,-0.47928852,0.25853854,0.23636449,-0.7392107,0.67342959,-0.44095219,-0.38150857,0.27111966,-0.32848337,0.62522738,0.60616041,-0.86794232,-0.56080833,0.30858496,-0.51867093,0.74343275,-0.2994144,-0.44048173,0.99463506,0.22595916,-0.14068916]],"xticklab":["-1.00","-0.60","-0.20","0.20","0.60","1.00"],"yticklab":["-1.00","-0.60","-0.20","0.20","0.60","1.00"],"zticklab":["1.00","0.60","0.20","-0.20","-0.60","-1.00"],"xtick":[0,0.2,0.4,0.6,0.8,1],"ytick":[0,0.2,0.4,0.6,0.8,1],"ztick":[0,0.2,0.4,0.6,0.8,1],"axislength":[1,1,1]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a>x&lt;-<span class="kw">cluster_edge_betweenness</span>(g.covid184)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>i&lt;-<span class="kw">membership</span>(x)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a>g.covid184&lt;-<span class="kw">set_vertex_attr</span>(g.covid184,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true"></a>                <span class="st">&quot;color&quot;</span>,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true"></a>                <span class="dt">value=</span>pal[i]</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true"></a>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true"></a><span class="kw">graphjs</span>(g.covid184,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true"></a>        <span class="dt">vertex.size=</span><span class="dv">1</span>)</span></code></pre></div>
<div id="sfDdjZrGTd" style="width:768px;height:480px;" class="scatterplotThree html-widget"></div>
<script type="application/json" data-for="sfDdjZrGTd">{"x":{"NROW":57,"height":null,"width":null,"axis":false,"numticks":[6,6,6],"xticklabs":null,"yticklabs":null,"zticklabs":null,"color":[["#67001F","#D1E5F0","#D1E5F0","#053061","#67001F","#FFFFFF","#67001F","#67001F","#67001F","#FFFFFF","#FFFFFF","#67001F","#D1E5F0","#D1E5F0","#67001F","#67001F","#67001F","#67001F","#053061","#FFFFFF","#67001F","#D1E5F0","#67001F","#67001F","#FFFFFF","#67001F","#67001F","#67001F","#67001F","#67001F","#D1E5F0","#67001F","#FFFFFF","#053061","#FFFFFF","#67001F","#FFFFFF","#FFFFFF","#67001F","#67001F","#67001F","#FFFFFF","#FFFFFF","#D1E5F0","#67001F","#053061","#67001F","#FFFFFF","#67001F","#67001F","#67001F","#67001F","#67001F","#053061","#67001F","#D1E5F0","#FFFFFF"]],"size":1,"stroke":"black","flipy":true,"grid":false,"renderer":"auto","signif":8,"bg":"white","cexsymbols":1,"xlim":[-1,1],"ylim":[-1,1],"zlim":[-1,1],"axisscale":[1,1,1],"pch":["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],"elementId":"sfDdjZrGTd","from":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,5,5,5,5,5,5,5,5,12,13,13,13,13,13,13,30,37,37,37,37,43,43]],"to":[[4,6,7,8,11,14,15,16,17,20,22,23,25,26,27,28,29,31,35,38,39,40,44,46,48,49,50,51,52,54,18,33,45,53,9,10,19,24,32,34,36,47,2,0,3,5,12,30,43,55,13,41,42,56,1,21]],"lwd":1,"linealpha":1,"center":true,"main":[""],"options":true,"alpha":[[1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,1,0,0,1,1,1,1,0,1,1,1,1,1,1,1,1,0]],"vertices":[[-0.52514982,-0.52412262,0.55774412,-0.25084171,0.20712209,-0.98824497,0.22511522,1,-0.012194631,0.55722081,0.38488091,0.29710881,-0.51434315,-0.20105207,0.87719267,0.64241993,-0.20137261,-0.61191912,-0.93182534,-0.80516979,0.56434375,-1,-0.43894567,0.64446414,-0.26562816,-0.88545666,0.71480207,0.91582962,-0.048276752,-0.86095948,0.9626362,-0.48718879,-0.63268127,-0.31755013,-0.37568296,0.95267285,0.14229225,0.60327551,-0.036225472,0.025693813,0.10837866,-0.078872543,-0.64353427,-0.37659914,0.99141741,-0.35726902,-0.75615248,0.25480357,-0.6989921,-0.12037175,0.75415339,-0.65986908,-0.98019832,0.48195771,0.71761665,0.63929759,0.53747113,0.61410381,-0.16311412,-1,-0.63769368,-0.8057075,0.19022842,-0.45377814,0.16863172,-0.92905901,-0.074535968,-0.62264443,0.63976627,-0.88122452,-0.31113008,0.81957161,0.81078447,-0.47645973,-0.73514288,-0.95738674,-0.34526375,0.40088257,-0.33932206,-0.14710586,0.60600971,-0.4747066,-0.92439453,0.82036759,-0.83020466,-0.8000707,0.34899664,-0.22430921,-0.87885431,0.47647702,-0.15691689,0.53668744,-0.021226343,-0.22043045,-0.67364697,0.88244691,1,-0.2454246,-0.66682161,0.85526531,0.45405388,0.57176931,0.67027152,-0.51390434,-0.86861179,-0.88647498,-0.74900697,0.80047171,0.77889246,-0.22259664,-0.92856246,-0.23578752,0.51980944,-0.42518236,-0.66989625,-0.95043118,0.72473366,-0.92595039,-0.57621455,0.34828031,-0.7250882,-0.15287176,0.50182986,-0.27719243,0.87877349,-0.5398893,-0.48860075,0.77567103,-0.62096163,-0.21559441,0.13464453,-0.62616942,-0.42395247,-1,0.48760725,0.79392508,0.67813097,0.29633171,-0.85951357,-0.56167486,0.91455763,0.97760127,-0.062061759,-0.56814304,-0.63783716,-0.533147,0.1567692,-0.78656063,-0.33396182,0.26913749,-0.16948091,-0.55288892,0.3930139,-0.171054,-0.36837843,0.76945904,-0.62443016,-0.746646,0.95209786,0.93389081,0.47906338,0.33173213,-0.47879698,-0.60067619,1,-0.28003611,0.91719411,0.010144889,-0.25231046,0.75289005,-0.73130203]],"xticklab":["-1.00","-0.60","-0.20","0.20","0.60","1.00"],"yticklab":["-1.00","-0.60","-0.20","0.20","0.60","1.00"],"zticklab":["1.00","0.60","0.20","-0.20","-0.60","-1.00"],"xtick":[0,0.2,0.4,0.6,0.8,1],"ytick":[0,0.2,0.4,0.6,0.8,1],"ztick":[0,0.2,0.4,0.6,0.8,1],"axislength":[1,1,1]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="networkd3" class="section level2">
<h2>networkD3</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="kw">library</span>(networkD3)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true"></a>src &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true"></a>        <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true"></a>target &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;J&quot;</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true"></a>            <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;I&quot;</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true"></a>networkData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(src, target)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true"></a><span class="co"># Plot</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true"></a><span class="kw">simpleNetwork</span>(networkData)</span></code></pre></div>
<div id="htmlwidget-d320ca3ca05099a23426" style="width:768px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d320ca3ca05099a23426">{"x":{"links":{"source":[0,0,0,0,1,1,2,2,3],"target":[1,2,3,9,4,5,6,7,8],"value":[1,1,1,1,1,1,1,1,1],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["A","B","C","D","E","F","G","H","I","J"],"group":[1,1,1,1,1,1,1,1,1,1],"nodesize":[8,8,8,8,8,8,8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="kw">library</span>(networkD3)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a>graph&lt;-<span class="kw">igraph_to_networkD3</span>(g.covid184)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true"></a><span class="kw">forceNetwork</span>(<span class="dt">Link=</span>graph<span class="op">$</span>links, <span class="dt">Nodes=</span>graph<span class="op">$</span>nodes,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true"></a>            <span class="dt">Source=</span><span class="st">&quot;source&quot;</span>, <span class="dt">Target=</span><span class="st">&quot;target&quot;</span>,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true"></a>            <span class="dt">NodeID=</span><span class="st">&quot;name&quot;</span>, <span class="dt">Group=</span><span class="st">&quot;name&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-e112697624230bc4a865" style="width:768px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e112697624230bc4a865">{"x":{"links":{"source":[0,0,3,0,0,5,37,0,0,0,0,5,5,37,37,13,13,43,43,13,13,13,37,0,5,0,5,5,0,0,0,0,0,0,0,5,3,3,0,12,0,13,0,0,0,0,0,0,0,5,0,0,3,0,30,0],"target":[28,7,18,35,4,36,56,38,46,39,40,34,10,42,41,43,12,21,1,5,3,30,13,17,19,44,47,32,6,48,49,50,8,51,52,9,53,33,25,2,27,0,54,29,23,15,16,20,22,24,14,26,45,11,55,31],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["45","180","42","182","12","181","22","10","31","34","17","93","178","184","8","56","58","186","11","19","64","179","74","5","78","39","82","44","1","47","183","97","21","37","16","116","14","NA","145","153","156","174","173","177","2","9","15","20","23","26","30","32","33","35","46","94","141"],"group":["45","180","42","182","12","181","22","10","31","34","17","93","178","184","8","56","58","186","11","19","64","179","74","5","78","39","82","44","1","47","183","97","21","37","16","116","14","NA","145","153","156","174","173","177","2","9","15","20","23","26","30","32","33","35","46","94","141"]},"options":{"NodeID":"name","Group":"name","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":false,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="kw">library</span>(networkD3)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a>x&lt;-<span class="kw">cluster_edge_betweenness</span>(g.covid184)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a>group&lt;-<span class="kw">membership</span>(x)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true"></a>graph&lt;-<span class="kw">igraph_to_networkD3</span>(g.covid184, <span class="dt">group=</span>group)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true"></a><span class="kw">forceNetwork</span>(<span class="dt">Link=</span>graph<span class="op">$</span>links, <span class="dt">Nodes=</span>graph<span class="op">$</span>nodes,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true"></a>            <span class="dt">Source=</span><span class="st">&quot;source&quot;</span>, <span class="dt">Target=</span><span class="st">&quot;target&quot;</span>,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true"></a>            <span class="dt">NodeID=</span><span class="st">&quot;name&quot;</span>, </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true"></a>            <span class="dt">Group=</span><span class="st">&quot;group&quot;</span>,</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true"></a>            <span class="dt">opacity =</span> <span class="fl">0.9</span>,</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true"></a>            <span class="dt">fontFamily =</span> <span class="st">&quot;ChulaCharasNew&quot;</span>, <span class="dt">fontSize=</span><span class="dv">16</span>,</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true"></a>            <span class="dt">zoom=</span><span class="ot">TRUE</span>, <span class="dt">legend=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-3374839830a2abbe84ba" style="width:768px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3374839830a2abbe84ba">{"x":{"links":{"source":[0,0,3,0,0,5,37,0,0,0,0,5,5,37,37,13,13,43,43,13,13,13,37,0,5,0,5,5,0,0,0,0,0,0,0,5,3,3,0,12,0,13,0,0,0,0,0,0,0,5,0,0,3,0,30,0],"target":[28,7,18,35,4,36,56,38,46,39,40,34,10,42,41,43,12,21,1,5,3,30,13,17,19,44,47,32,6,48,49,50,8,51,52,9,53,33,25,2,27,0,54,29,23,15,16,20,22,24,14,26,45,11,55,31],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["45","180","42","182","12","181","22","10","31","34","17","93","178","184","8","56","58","186","11","19","64","179","74","5","78","39","82","44","1","47","183","97","21","37","16","116","14","NA","145","153","156","174","173","177","2","9","15","20","23","26","30","32","33","35","46","94","141"],"group":[1,2,2,3,1,4,1,1,1,4,4,1,2,2,1,1,1,1,3,4,1,2,1,1,4,1,1,1,1,1,2,1,4,3,4,1,4,5,1,1,1,5,5,2,1,3,1,4,1,1,1,1,1,3,1,2,5]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":16,"fontFamily":"ChulaCharasNew","clickTextSize":40,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.9,"zoom":true,"legend":true,"arrows":false,"nodesize":false,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>

   
   
           </section>
  </div>
  </div>
  </div>
  </div>
      
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
