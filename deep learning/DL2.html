<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>การเรียนรู้เชิงลึก</title>

        <script src="DL2_files/header-attrs-2.7/header-attrs.js"></script>
        <script src="DL2_files/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="DL2_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="DL2_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="DL2_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="DL2_files/navigation-1.1/tabsets.js"></script>
        <link href="DL2_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="DL2_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="DL2_files/robobook-0.1/robobook.css" rel="stylesheet" />
        <link href="DL2_files/robobook-0.1/robobook_fonts_embed.css" rel="stylesheet" />
        <script src="DL2_files/robobook-0.1/robobook.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
            <!-- robobook start -->   
   <div class="book with-summary">
      <div class="book-summary">
        <ul>
          <li class="title">การเรียนรู้เชิงลึก</li>
          <li class="divider"></li>
        </ul>
        <nav role="navigation" id="toc">
          <ul>
          <li><a href="#introduction"><strong>Introduction</strong></a>
          <ul>
          <li><a href="#deep-learning-model"><strong>Deep learning model</strong></a></li>
          <li><a href="#activation-function"><strong>Activation function</strong></a></li>
          <li><a href="#ประเภทของ-dl-model"><strong>ประเภทของ ​DL model</strong></a></li>
          </ul></li>
          <li><a href="#the-first-dl-model-slp-and-mlp-with-keras"><strong>The first DL model (SLP and MLP) with Keras</strong></a>
          <ul>
          <li><a href="#ติดตั้ง-package">ติดตั้ง package</a></li>
          <li><a href="#regression-example">Regression example</a></li>
          <li><a href="#classification-example">Classification example</a></li>
          </ul></li>
          </ul>
        </nav>
        <ul class="authors">
          <li class="divider"></li>
                            </ul>     
      </div>
      <div class="book-body fixed">
        <div class="body-inner">
            <a class="btn pull-left js-toolbar-action toggle-sidebar" aria-label="Toggle Sidebar" title="Toggle Sidebar" href="#">
              <span class="glyphicon glyphicon-menu-hamburger"></span>
            </a>
            <div class="page-inner">
              <section id="content" class="normal">
      
   
        
      <h1 class="title">การเรียนรู้เชิงลึก</h1>
      
        

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<p style="line-height:1.3; font-size:16px; color: #353b48; text-align:right;">
สิวะโชติ ศรีสุทธิยากร </br> </br> ภาควิชาวิจัยและจิตวิทยาการศึกษา คณะครุศาสตร์ </br> จุฬาลงกรณ์มหาวิทยาลัย </br> </font> 13 May 2021 </font>
</p>
<html>
<head>
<!-- Load require.js. Delete this if your page already loads require.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" crossorigin="anonymous"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>
<script type="application/vnd.jupyter.widget-state+json">
{
    "version_major": 2,
    "version_minor": 0,
    "state": {}
}
</script>
</head>
<body>
</body>
</html>
<div id="introduction" class="section level1">
<h1><strong>Introduction</strong></h1>
<div id="deep-learning-model" class="section level2">
<h2><strong>Deep learning model</strong></h2>
<p>โมเดล deep learning พื้นฐานที่สุดจะประกอบด้วยส่วนประกอบหลักที่เรียกว่าชั้น (layer) จำนวน 3 ส่วนได้แก่</p>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2009.15.17.png" style="width:50.0%" /></left></p>
<ul>
<li><p>input layer</p></li>
<li><p>hidden layer</p></li>
<li><p>output layer</p></li>
</ul>
<p>จากรูปจะเห็นว่าโมเดลมี input layer ที่ประกอบด้วยหน่วยย่อยหรือที่เรียกว่า นิวรอน (neurons) จำนวน 2 หน่วย โดยนิวรอนใน input layer จะใช้แทนตัวแปรอิสระของโมเดล ในที่นี้จะได้ว่า <span class="math inline">\(X = [x_1, x_2]\)</span></p>
<p>โมเดลจะนำข้อมูลนำเข้าใน input layer ที่กำหนดมาประมวลผลเป็น hidden layer และส่งผ่านค่าไปยัง output layer ในท้ายที่สุด</p>
<p>การประมวลผลของ neuron ใน hidden layer จะนำข้อมูลของ neuron ที่อยู่ใน layer ก่อนหน้ามาคำนวณผลรวมเชิงเส้นแบบถ่วงน้ำหนัก จากตัวอย่างของ deep learning model ในข้างต้น จะได้ว่าผลรวมเชิงเส้นของแต่ละ neuron ใน hidden layer คำนวณได้ดังนี้</p>
<p><span class="math inline">\(h_j=b+w_1x_1+w_2x_2\)</span></p>
<p>เรียก <span class="math inline">\(w_k\)</span> ว่าน้ำหนัก (weight) และ <span class="math inline">\(b\)</span> ว่าค่าความลำเอียง (bias)</p>
<p>โดยทั่วไปมีความเป็นไปได้ที่ค่าของผลรวมเชิงเส้นที่คำนวณได้ข้างต้นจะมีพิสัยที่ไม่สอดคล้องกับตัวแปรตามที่ต้องการทำนาย จึงมีการนำค่าผลรวมเชิงเส้นดังกล่าวมาแปลงค่าด้วยฟังก์ชันที่เรียกว่า activation function ก่อนที่จะส่งค่าไปยัง neuron ใน layer ถัดไป ดังตัวอย่างในรูปด้านล่าง</p>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2009.35.57.png" style="width:70.0%" /></left></p>
</div>
<div id="activation-function" class="section level2">
<h2><strong>Activation function</strong></h2>
<p>activation function เป็นฟังก์ชันทางคณิตศาสตร์ ที่ผู้วิเคราะห์ใช้สำหรับแปลงค่าผลรวมเชิงเส้นของข้อมูลนำเข้า ให้มีพิสัยอยู่ในช่วงที่สมเหตุสมผลหรือสอดคล้องกับตัวแปรตามที่ต้องการทำนาย</p>
<p>activation function ที่ใช้ในการวิเคราะห์มีได้หลากหลาย โดยอาจจำแนกเป็น 2 ประเภทได้แก่ <strong>linear activation function</strong> ซึ่งเขียนในรูปทั่วไปดังนี้</p>
<p><span class="math inline">\(\sigma(x)=m(x)+c\)</span></p>
<p>ฟังก์ชันประเภทนี้จะไม่ได้ทำให้พิสัยของข้อมูลนำเข้าเปลี่ยนแปลงไปจากเดิม กล่าวคือหาก <span class="math inline">\(x \in [-\infty, \infty]\)</span> แล้ว <span class="math inline">\(\sigma(x) \in [-\infty, \infty]\)</span> เช่นเดิม แต่อาจช่วยแปลงสเกลของข้อมูลนำเข้าให้เหมาะสมมากหรือใกล้เคียงกับช่วงที่เป็นไปได้ของตัวแปรตามมากขึ้น ดังตัวอย่างในรูปด้านล่าง</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-1-1.png" width="480" /></p>
<p>และ <strong>nonlinear activation function</strong> ซึ่งมักใช้ใช้บ่อยกว่า linear activation function ทั้งนี้เป็นเพราะมีความสามารถที่จะแปลงพิสัยของข้อมูลนำเข้าให้อยู่ในช่วงที่เหมาะสมได้ เช่นแปลง <span class="math inline">\(x \in [-\infty, \infty]\)</span> ให้อยู่ในช่วง <span class="math inline">\([0,1]\)</span> หรือ <span class="math inline">\([0, \infty]\)</span> หรือ <span class="math inline">\([-1,1]\)</span></p>
<div id="ตัวอย่าง-activation-function" class="section level3">
<h3>ตัวอย่าง activation function</h3>
<p><strong>Sigmoid function:</strong> <span class="math inline">\(\sigma(x)=\frac{1}{1+exp(-x)}\)</span></p>
<p>เหมาะสำหรับใช้เป็น activation function ในปัญหา binary classification ฟังก์ชันนี้จะแปลงข้อมูลนำเข้าในอยู่ในพิสัย <span class="math inline">\([0,1]\)</span></p>
<p><strong>Hyperbolic Tangent function:</strong> <span class="math inline">\(\sigma(x)=\frac{e^x-e^{-x}}{e^x+e^{-x}}\)</span></p>
<p>ฟังก์ชันนี้มีลักษณะคล้ายกับ sigmoid function แต่พิสัยของฟังก์ชันจะอยู่ในช่วง <span class="math inline">\([-1,1]\)</span> บางครั้งเรียกว่า sigmoidal funcion หรือ tanh function</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Rectified Linear Unit:</strong> <span class="math inline">\(\sigma(x)=max(0,x)\)</span></p>
<p>เป็น activation function ที่มักใช้บ่อยใน hidden layer โดยพิสัยของฟังก์ชันจะอยู่ในช่วง <span class="math inline">\([0,\infty]\)</span> ดังรูป</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Leaky Rectified Linear Unit:</strong> <span class="math inline">\(\sigma(x)= \begin{cases} x,&amp; \text{if } x\geq 1\\ax, &amp; \text{otherwise}\end{cases}\)</span></p>
<p><img src="DL2_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Softmax</strong></p>
<p>softmax activation function เป็น function ที่เหมาะสำหรับใช้ในปัญหา multi-class classification จากสูตรของฟังก์ชันจะเห็นว่าผลลัพธ์ที่ได้จะเป็นความน่าจะเป็นที่มีพิสัยอยู่ในช่วง <span class="math inline">\([0,1]\)</span></p>
<p>กำหนดให้ <span class="math inline">\(x=(x_1, x_2, x_3, x_4)\)</span> เป็นเวกเตอร์ของข้อมูลนำเข้า และตัวแปรตามเป็นตัวแปรแบบจัดประเภทที่มี 3 ระดับได้แก่ <span class="math inline">\(a, b, c\)</span></p>
<p>สมมุติว่าต้องการหาความน่าจะเป็นของการเกิดผลลัพธ์ <span class="math inline">\(a, b, c\)</span> เมื่อกำหนดข้อมูลนำเข้า <span class="math inline">\(x\)</span> จะสามารถหาได้โดยใช้ความน่าจะเป็นแบบมีเงื่อนไข (conditional probability) ดังนี้</p>
<p><span class="math inline">\(P(a|x)=\frac{y_a}{y_a+y_b+y_c}\)</span></p>
<p><span class="math inline">\(P(b|x)=\frac{y_b}{y_a+y_b+y_c}\)</span></p>
<p><span class="math inline">\(P(c|x)=\frac{y_c}{y_a+y_b+y_c}\)</span></p>
<p>เมื่อ</p>
<p><span class="math inline">\(y_a=w_{1,a}x_1+w_{2,a}x_2+w_{3,a}x_3+w_{4,a}x_4\)</span></p>
<p><span class="math inline">\(y_b=w_{1,b}x_1+w_{2,b}x_2+w_{3,b}x_3+w_{4,b}x_4\)</span></p>
<p><span class="math inline">\(y_c=w_{1,c}x_1+w_{2,c}x_2+w_{3,c}x_3+w_{4,c}x_4\)</span></p>
<p>จะสังเกตเห็นว่า <span class="math inline">\(P(a|x)+P(b|x)+P(c|x)=1\)</span></p>
<p>เนื่องจากผลรวมเชิงเส้นในข้างต้นมีพิสัยเป็นจำนวนจริง จึงทำให้ผลรวมเชิงเส้นดังกล่าวสามารถมีค่าติดลบได้ ซึ่งอาจส่งผลให้ค่าความน่าจะเป็นแบบมีเงื่อนไขมีค่าอยู่นอกช่วง <span class="math inline">\([0,1]\)</span></p>
<p>เพื่อแก้ปัญหานี้จึงมีการใช้ฟังก์ชัน exponential แปลงพิสัยของผลรวมเชิงเส้นที่เป็นจำนวนจริงให้อยู่ในช่วง <span class="math inline">\([0, \infty]\)</span> ซึ่งทำให้ sofmax activation function สามารถเขียนในรูปทั่วไปได้ดังนี้</p>
<p>กำหนดให้ <span class="math inline">\(x = (x_1, x_2, x_3, ..., x_p)^T\)</span> เป็นเวกเตอร์ข้อมูลนำเข้าของตัวแปรอิสระจำนวน <span class="math inline">\(p\)</span> ตัว และ <span class="math inline">\(y\)</span> เป็นตัวแปรตามแบบจัดประเภทที่มีจำนวน <span class="math inline">\(k\)</span> ระดับ softmax activation function นิยามดังนี้</p>
<p><span class="math inline">\(\sigma(x)=P(y=y_m|x)=\frac{exp(x_i)}{\sum_{j=1}^pexp(x_j)}\)</span></p>
<p>เมื่อ <span class="math inline">\(i = 1,2,...,p\)</span> และ <span class="math inline">\(m = 1,2,...,k\)</span></p>
<p>์Note: สังเกตว่า DL model ทำนายตัวแปรตามที่ต้องการด้วยการแยกส่วนการประมวลผลออกเป็นส่วนย่อย ๆ หลาย ๆ ส่วน โดยที่แต่ละส่วนถูกบรรจุอยู่ใน neuron</p>
</div>
</div>
<div id="ประเภทของ-dl-model" class="section level2">
<h2><strong>ประเภทของ ​DL model</strong></h2>
<ul>
<li><p>Multilayer Perceptron Model (MLP models)</p></li>
<li><p>Convolutional Neural Network (CNNs)</p></li>
<li><p>Recurrent Neural Network (RNNs)</p></li>
<li><p>Restricted Boltzmann Machines (RBMs)</p></li>
<li><p>Deep Belief Networks (DBNs)</p></li>
</ul>
</div>
</div>
<div id="the-first-dl-model-slp-and-mlp-with-keras" class="section level1">
<h1><strong>The first DL model (SLP and MLP) with Keras</strong></h1>
<p><img src="1200px-Keras_logo.png" style="width:30.0%" /></p>
<p>หนังสือบางเล่มเรียก DL ประเภทนี้ว่า Feedforward neural networks (FFNNs) เป็นโมเดล DL พื้นฐานที่ใช้กันทั่วไป ภายในโมเดลประกอบด้วย input, hidden และ output layers ดังที่กล่าวมาแล้ว โมเดลประเภทนี้สามารถประยุกต์ใช้ได้กับทั้งปัญหา classification และ regression</p>
<p>หัวข้อนี้จะกล่าวถึงการสร้าง DL model พื้นฐานโดยใช้ package-keras</p>
<p><img src="Screen%20Shot%202564-05-14%20at%2010.04.28.png" /></p>
<p>นิสิตสามารถศึกษาภาพรวมของ package-keras ได้จากคลิปด้านล่าง</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/j_pJmXJwMLA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="ติดตั้ง-package" class="section level2">
<h2>ติดตั้ง package</h2>
<p>keras สามารถติดตั้งและเรียกใช้งานได้ทั้งบน python และ R</p>
<div id="สำหรับ-python" class="section level3">
<h3>สำหรับ python</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pip install <span class="op">--</span>upgrade tensorflow</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pip install keras</span></code></pre></div>
</div>
<div id="สำหรับ-r" class="section level3">
<h3>สำหรับ R</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;keras&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_keras</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span></code></pre></div>
</div>
</div>
<div id="regression-example" class="section level2">
<h2>Regression example</h2>
<p>จากชุดข้อมูล crimm.csv</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/Users/siwachoat/Library/Mobile Documents/com~apple~CloudDocs/เอกสารประกอบการสอน/Machine Learning/เอกสาร/ep2_regression/_02_multiple regression/crimm.csv&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>  householdSize pct.lao pct.thai pct.myanmar pct.cambodia numPop.urban
1          3.10    1.37    91.78        6.50         1.88        11980
2          2.82    0.80    95.57        3.44         0.85        23123
3          2.43    0.74    94.33        3.43         2.35        29344
4          2.40    1.70    97.35        0.50         0.70            0
5          2.76    0.53    89.16        1.17         0.52            0
6          2.45    2.51    95.65        0.90         0.95       140494
  medIncome.household pctWPubAsst pctPop.poor pchLessM3 PctUnemployed
1               75122        1.03        1.96      5.81          2.70
2               47917        2.75        3.98      5.61          2.43
3               35669        2.94        4.75      2.80          4.01
4               20580       11.71       17.23     11.05          9.86
5               17390       11.21       29.99     12.15          9.08
6               21577        7.12       17.78      8.76          5.72
  NumIlllegal.labor HousVacant Num.HomelessInShelters Num.HomelessInStreet
1              1277         64                     11                    0
2              1920        240                      0                    0
3              1468        544                     16                    0
4               339        669                      0                    0
5               196        333                      2                    0
6              2091       5119                    327                    4
  PopDens TheifperPop
1  1845.9      114.85
2  2186.7      242.37
3  2780.9      758.14
4  3217.7     1301.78
5   974.2      728.93
6  1995.7     1386.46</code></pre>
<p>สมมุติว่าต้องการสร้างโมเดลทำนายอัตราการเกิดคดีโจรกรรมในแต่ละพื้นที่โดยใช้ตัวแปรอิสระทั้งหมดที่มีในชุดข้อมูล</p>
<div id="import-and-manipulating-data" class="section level3">
<h3>1. Import and manipulating data</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>train.id <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dat<span class="sc">$</span>TheifperPop, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> F)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[train.id, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(training) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>training_outcome <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[train.id, <span class="dv">17</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>testing <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[<span class="sc">-</span>train.id, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(testing) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>testing_outcome <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[<span class="sc">-</span>train.id, <span class="dv">17</span>])</span></code></pre></div>
</div>
<div id="create-the-model-in-python" class="section level3">
<h3>2. Create the Model (in Python)</h3>
<p>ระบุ DL model โดยกำหนดให้มี hidden layer 1 ชั้น จำนวน 5 neurons</p>
<p>การสร้างโมเดล DL ข้างต้นด้วย Sequential API ของ Keras package สามารถทำได้โดยเขียนคำสั่งดังนี้</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Create a Sequential model</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#2. Add an input layer and a hidden layer with 2 neurons.</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">5</span>, input_shape<span class="op">=</span>[<span class="dv">16</span>],</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">5</span>, activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#3. Add 1-neuron output layer</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#4. model summary</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#5. compile and train the model</span></span></code></pre></div>
<pre><code>Model: &quot;sequential_47&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_135 (Dense)            (None, 5)                 85        
_________________________________________________________________
dense_136 (Dense)            (None, 5)                 30        
_________________________________________________________________
dense_137 (Dense)            (None, 1)                 6         
=================================================================
Total params: 121
Trainable params: 121
Non-trainable params: 0
_________________________________________________________________</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">&quot;adam&quot;</span>, loss <span class="op">=</span> <span class="st">&quot;mse&quot;</span>)  <span class="co">#compiling</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># manipulating data</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> np.array(r.training)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>train_out <span class="op">=</span> np.array(r.training_outcome)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> np.array(r.testing)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>test_out<span class="op">=</span> np.array(r.testing_outcome)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(train, train_out, epochs<span class="op">=</span><span class="dv">500</span>) <span class="co">#training</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#7. calcualte the predicted value using training model</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># การคำนวณค่าทำนายของตัวแปรตามสามารถทำได้โดยใช้ method `predict()` ดังนี้</span></span></code></pre></div>
<pre><code>Epoch 1/500

 1/56 [..............................] - ETA: 0s - loss: 19345643520.0000
56/56 [==============================] - 0s 623us/step - loss: 487797024.0000
Epoch 2/500

 1/56 [..............................] - ETA: 0s - loss: 12682996.0000
56/56 [==============================] - 0s 600us/step - loss: 307179552.0000
Epoch 3/500

 1/56 [..............................] - ETA: 0s - loss: 6517242.0000
56/56 [==============================] - 0s 589us/step - loss: 185284864.0000
Epoch 4/500

 1/56 [..............................] - ETA: 0s - loss: 18546532.0000
56/56 [==============================] - 0s 580us/step - loss: 113309920.0000
Epoch 5/500

 1/56 [..............................] - ETA: 0s - loss: 72111264.0000
56/56 [==============================] - 0s 581us/step - loss: 64224472.0000
Epoch 6/500

 1/56 [..............................] - ETA: 0s - loss: 1653259.8750
56/56 [==============================] - 0s 587us/step - loss: 37737164.0000
Epoch 7/500

 1/56 [..............................] - ETA: 0s - loss: 3886789.5000
56/56 [==============================] - 0s 664us/step - loss: 22490866.0000
Epoch 8/500

 1/56 [..............................] - ETA: 0s - loss: 5182000.5000
56/56 [==============================] - 0s 605us/step - loss: 12253614.0000
Epoch 9/500

 1/56 [..............................] - ETA: 0s - loss: 959830.4375
56/56 [==============================] - 0s 593us/step - loss: 7000647.5000
Epoch 10/500

 1/56 [..............................] - ETA: 0s - loss: 991560.6875
56/56 [==============================] - 0s 589us/step - loss: 3973208.7500
Epoch 11/500

 1/56 [..............................] - ETA: 0s - loss: 782060.4375
56/56 [==============================] - 0s 599us/step - loss: 2630170.5000
Epoch 12/500

 1/56 [..............................] - ETA: 0s - loss: 1048384.1250
56/56 [==============================] - 0s 617us/step - loss: 1764567.3750
Epoch 13/500

 1/56 [..............................] - ETA: 0s - loss: 587556.4375
56/56 [==============================] - 0s 615us/step - loss: 1548534.1250
Epoch 14/500

 1/56 [..............................] - ETA: 0s - loss: 706659.7500
56/56 [==============================] - 0s 614us/step - loss: 1259135.3750
Epoch 15/500

 1/56 [..............................] - ETA: 0s - loss: 1621103.8750
56/56 [==============================] - 0s 604us/step - loss: 1192480.2500
Epoch 16/500

 1/56 [..............................] - ETA: 0s - loss: 933296.0000
56/56 [==============================] - 0s 611us/step - loss: 1150065.6250
Epoch 17/500

 1/56 [..............................] - ETA: 0s - loss: 1094485.2500
56/56 [==============================] - 0s 611us/step - loss: 1123069.5000
Epoch 18/500

 1/56 [..............................] - ETA: 0s - loss: 916157.1250
56/56 [==============================] - 0s 600us/step - loss: 1099354.8750
Epoch 19/500

 1/56 [..............................] - ETA: 0s - loss: 1208960.0000
56/56 [==============================] - 0s 606us/step - loss: 1083245.0000
Epoch 20/500

 1/56 [..............................] - ETA: 0s - loss: 673863.3750
56/56 [==============================] - 0s 632us/step - loss: 1068368.1250
Epoch 21/500

 1/56 [..............................] - ETA: 0s - loss: 1071003.1250
56/56 [==============================] - 0s 645us/step - loss: 1055314.3750
Epoch 22/500

 1/56 [..............................] - ETA: 0s - loss: 679027.0000
56/56 [==============================] - 0s 595us/step - loss: 1042474.1250
Epoch 23/500

 1/56 [..............................] - ETA: 0s - loss: 585728.8750
56/56 [==============================] - 0s 585us/step - loss: 1027126.0625
Epoch 24/500

 1/56 [..............................] - ETA: 0s - loss: 1210713.2500
56/56 [==============================] - 0s 583us/step - loss: 1016394.3750
Epoch 25/500

 1/56 [..............................] - ETA: 0s - loss: 649377.2500
56/56 [==============================] - 0s 580us/step - loss: 1004179.5625
Epoch 26/500

 1/56 [..............................] - ETA: 0s - loss: 1264921.2500
56/56 [==============================] - 0s 578us/step - loss: 993356.2500
Epoch 27/500

 1/56 [..............................] - ETA: 0s - loss: 1194682.8750
56/56 [==============================] - 0s 592us/step - loss: 982668.5000
Epoch 28/500

 1/56 [..............................] - ETA: 0s - loss: 930689.0000
56/56 [==============================] - 0s 568us/step - loss: 973498.3125
Epoch 29/500

 1/56 [..............................] - ETA: 0s - loss: 711662.0625
56/56 [==============================] - 0s 595us/step - loss: 965323.7500
Epoch 30/500

 1/56 [..............................] - ETA: 0s - loss: 569159.6250
56/56 [==============================] - 0s 586us/step - loss: 957915.5625
Epoch 31/500

 1/56 [..............................] - ETA: 0s - loss: 399710.5625
56/56 [==============================] - 0s 587us/step - loss: 951468.4375
Epoch 32/500

 1/56 [..............................] - ETA: 0s - loss: 567834.8750
56/56 [==============================] - 0s 588us/step - loss: 941492.9375
Epoch 33/500

 1/56 [..............................] - ETA: 0s - loss: 1666251.5000
56/56 [==============================] - 0s 591us/step - loss: 934928.8750
Epoch 34/500

 1/56 [..............................] - ETA: 0s - loss: 835399.1250
56/56 [==============================] - 0s 584us/step - loss: 928944.1250
Epoch 35/500

 1/56 [..............................] - ETA: 0s - loss: 566156.5625
56/56 [==============================] - 0s 586us/step - loss: 921940.4375
Epoch 36/500

 1/56 [..............................] - ETA: 0s - loss: 1061538.5000
56/56 [==============================] - 0s 573us/step - loss: 916428.1250
Epoch 37/500

 1/56 [..............................] - ETA: 0s - loss: 751284.7500
56/56 [==============================] - 0s 575us/step - loss: 910899.1250
Epoch 38/500

 1/56 [..............................] - ETA: 0s - loss: 680661.3750
56/56 [==============================] - 0s 600us/step - loss: 909972.6875
Epoch 39/500

 1/56 [..............................] - ETA: 0s - loss: 1171496.7500
56/56 [==============================] - 0s 612us/step - loss: 900316.9375
Epoch 40/500

 1/56 [..............................] - ETA: 0s - loss: 833576.6250
56/56 [==============================] - 0s 596us/step - loss: 899595.1875
Epoch 41/500

 1/56 [..............................] - ETA: 0s - loss: 626896.5625
56/56 [==============================] - 0s 802us/step - loss: 890329.6250
Epoch 42/500

 1/56 [..............................] - ETA: 0s - loss: 494350.0312
53/56 [===========================&gt;..] - ETA: 0s - loss: 896517.0625
56/56 [==============================] - 0s 946us/step - loss: 886373.7500
Epoch 43/500

 1/56 [..............................] - ETA: 0s - loss: 875294.1250
56/56 [==============================] - 0s 659us/step - loss: 886903.0000
Epoch 44/500

 1/56 [..............................] - ETA: 0s - loss: 612566.8750
56/56 [==============================] - 0s 597us/step - loss: 876784.2500
Epoch 45/500

 1/56 [..............................] - ETA: 0s - loss: 870422.9375
56/56 [==============================] - 0s 643us/step - loss: 876061.1250
Epoch 46/500

 1/56 [..............................] - ETA: 0s - loss: 312414.1250
56/56 [==============================] - 0s 624us/step - loss: 873981.6250
Epoch 47/500

 1/56 [..............................] - ETA: 0s - loss: 917482.0000
56/56 [==============================] - 0s 609us/step - loss: 870008.4375
Epoch 48/500

 1/56 [..............................] - ETA: 0s - loss: 522805.3750
56/56 [==============================] - 0s 610us/step - loss: 865217.5625
Epoch 49/500

 1/56 [..............................] - ETA: 0s - loss: 612135.8125
56/56 [==============================] - 0s 627us/step - loss: 860861.5000
Epoch 50/500

 1/56 [..............................] - ETA: 0s - loss: 936954.7500
56/56 [==============================] - 0s 654us/step - loss: 858342.6875
Epoch 51/500

 1/56 [..............................] - ETA: 0s - loss: 1333101.5000
56/56 [==============================] - 0s 632us/step - loss: 859325.6250
Epoch 52/500

 1/56 [..............................] - ETA: 0s - loss: 462723.1562
56/56 [==============================] - 0s 593us/step - loss: 854086.5625
Epoch 53/500

 1/56 [..............................] - ETA: 0s - loss: 1246025.2500
56/56 [==============================] - 0s 587us/step - loss: 851400.8750
Epoch 54/500

 1/56 [..............................] - ETA: 0s - loss: 610702.4375
56/56 [==============================] - 0s 574us/step - loss: 851412.5000
Epoch 55/500

 1/56 [..............................] - ETA: 0s - loss: 453093.0938
56/56 [==============================] - 0s 588us/step - loss: 842770.2500
Epoch 56/500

 1/56 [..............................] - ETA: 0s - loss: 554199.6250
56/56 [==============================] - 0s 606us/step - loss: 841338.8750
Epoch 57/500

 1/56 [..............................] - ETA: 0s - loss: 536139.4375
56/56 [==============================] - 0s 592us/step - loss: 848248.7500
Epoch 58/500

 1/56 [..............................] - ETA: 0s - loss: 599486.5000
56/56 [==============================] - 0s 552us/step - loss: 839672.0625
Epoch 59/500

 1/56 [..............................] - ETA: 0s - loss: 721866.1250
56/56 [==============================] - 0s 558us/step - loss: 838598.6250
Epoch 60/500

 1/56 [..............................] - ETA: 0s - loss: 310473.2500
56/56 [==============================] - 0s 553us/step - loss: 832845.0000
Epoch 61/500

 1/56 [..............................] - ETA: 0s - loss: 288271.2500
56/56 [==============================] - 0s 563us/step - loss: 835076.3125
Epoch 62/500

 1/56 [..............................] - ETA: 0s - loss: 1263199.5000
56/56 [==============================] - 0s 567us/step - loss: 842415.1875
Epoch 63/500

 1/56 [..............................] - ETA: 0s - loss: 790426.3125
56/56 [==============================] - 0s 615us/step - loss: 832395.5000
Epoch 64/500

 1/56 [..............................] - ETA: 0s - loss: 453419.6875
56/56 [==============================] - 0s 592us/step - loss: 822288.1250
Epoch 65/500

 1/56 [..............................] - ETA: 0s - loss: 593199.6250
56/56 [==============================] - 0s 589us/step - loss: 822709.5000
Epoch 66/500

 1/56 [..............................] - ETA: 0s - loss: 1434198.0000
56/56 [==============================] - 0s 573us/step - loss: 819413.3750
Epoch 67/500

 1/56 [..............................] - ETA: 0s - loss: 586322.6875
56/56 [==============================] - 0s 572us/step - loss: 811325.8125
Epoch 68/500

 1/56 [..............................] - ETA: 0s - loss: 508456.1250
56/56 [==============================] - 0s 577us/step - loss: 828509.8125
Epoch 69/500

 1/56 [..............................] - ETA: 0s - loss: 1045437.0000
56/56 [==============================] - 0s 576us/step - loss: 815225.9375
Epoch 70/500

 1/56 [..............................] - ETA: 0s - loss: 595261.2500
56/56 [==============================] - 0s 596us/step - loss: 808241.0000
Epoch 71/500

 1/56 [..............................] - ETA: 0s - loss: 615397.7500
56/56 [==============================] - 0s 626us/step - loss: 808892.8750
Epoch 72/500

 1/56 [..............................] - ETA: 0s - loss: 1615440.2500
56/56 [==============================] - 0s 674us/step - loss: 800678.3750
Epoch 73/500

 1/56 [..............................] - ETA: 0s - loss: 827281.0625
56/56 [==============================] - 0s 668us/step - loss: 799584.4375
Epoch 74/500

 1/56 [..............................] - ETA: 0s - loss: 538221.8750
56/56 [==============================] - 0s 654us/step - loss: 809366.1875
Epoch 75/500

 1/56 [..............................] - ETA: 0s - loss: 1014717.5000
56/56 [==============================] - 0s 753us/step - loss: 805656.6875
Epoch 76/500

 1/56 [..............................] - ETA: 0s - loss: 793543.3125
56/56 [==============================] - 0s 623us/step - loss: 794924.6875
Epoch 77/500

 1/56 [..............................] - ETA: 0s - loss: 680663.5000
56/56 [==============================] - 0s 609us/step - loss: 793164.1875
Epoch 78/500

 1/56 [..............................] - ETA: 0s - loss: 5129843.5000
56/56 [==============================] - 0s 610us/step - loss: 793900.4375
Epoch 79/500

 1/56 [..............................] - ETA: 0s - loss: 797139.9375
56/56 [==============================] - 0s 623us/step - loss: 790611.1250
Epoch 80/500

 1/56 [..............................] - ETA: 0s - loss: 361022.8125
56/56 [==============================] - 0s 636us/step - loss: 816759.3125
Epoch 81/500

 1/56 [..............................] - ETA: 0s - loss: 1728774.8750
56/56 [==============================] - 0s 653us/step - loss: 787218.5625
Epoch 82/500

 1/56 [..............................] - ETA: 0s - loss: 513042.1250
56/56 [==============================] - 0s 641us/step - loss: 801217.9375
Epoch 83/500

 1/56 [..............................] - ETA: 0s - loss: 1477067.1250
56/56 [==============================] - 0s 633us/step - loss: 777406.3125
Epoch 84/500

 1/56 [..............................] - ETA: 0s - loss: 1059150.3750
56/56 [==============================] - 0s 621us/step - loss: 780375.1875
Epoch 85/500

 1/56 [..............................] - ETA: 0s - loss: 659209.6875
56/56 [==============================] - 0s 637us/step - loss: 776292.5625
Epoch 86/500

 1/56 [..............................] - ETA: 0s - loss: 536303.0000
56/56 [==============================] - 0s 642us/step - loss: 769336.1250
Epoch 87/500

 1/56 [..............................] - ETA: 0s - loss: 414756.0312
56/56 [==============================] - 0s 622us/step - loss: 785816.0625
Epoch 88/500

 1/56 [..............................] - ETA: 0s - loss: 1171444.3750
56/56 [==============================] - 0s 667us/step - loss: 776141.8750
Epoch 89/500

 1/56 [..............................] - ETA: 0s - loss: 1032232.7500
56/56 [==============================] - 0s 658us/step - loss: 759025.0000
Epoch 90/500

 1/56 [..............................] - ETA: 0s - loss: 891150.1875
56/56 [==============================] - 0s 656us/step - loss: 808647.3750
Epoch 91/500

 1/56 [..............................] - ETA: 0s - loss: 317019.1875
56/56 [==============================] - 0s 627us/step - loss: 759391.0000
Epoch 92/500

 1/56 [..............................] - ETA: 0s - loss: 426054.8750
56/56 [==============================] - 0s 643us/step - loss: 752212.8125
Epoch 93/500

 1/56 [..............................] - ETA: 0s - loss: 991166.8125
56/56 [==============================] - 0s 630us/step - loss: 808556.1875
Epoch 94/500

 1/56 [..............................] - ETA: 0s - loss: 889550.6875
56/56 [==============================] - 0s 624us/step - loss: 808357.2500
Epoch 95/500

 1/56 [..............................] - ETA: 0s - loss: 758035.6250
56/56 [==============================] - 0s 601us/step - loss: 1223551.1250
Epoch 96/500

 1/56 [..............................] - ETA: 0s - loss: 799242.3750
56/56 [==============================] - 0s 621us/step - loss: 757346.4375
Epoch 97/500

 1/56 [..............................] - ETA: 0s - loss: 700658.4375
56/56 [==============================] - 0s 631us/step - loss: 759414.1250
Epoch 98/500

 1/56 [..............................] - ETA: 0s - loss: 800095.6250
56/56 [==============================] - 0s 720us/step - loss: 753363.8125
Epoch 99/500

 1/56 [..............................] - ETA: 0s - loss: 680851.0000
56/56 [==============================] - 0s 690us/step - loss: 730596.1250
Epoch 100/500

 1/56 [..............................] - ETA: 0s - loss: 526639.8125
56/56 [==============================] - 0s 663us/step - loss: 815521.6875
Epoch 101/500

 1/56 [..............................] - ETA: 0s - loss: 879146.3750
56/56 [==============================] - 0s 619us/step - loss: 841480.3750
Epoch 102/500

 1/56 [..............................] - ETA: 0s - loss: 801263.8750
56/56 [==============================] - 0s 588us/step - loss: 720095.4375
Epoch 103/500

 1/56 [..............................] - ETA: 0s - loss: 402263.6875
56/56 [==============================] - 0s 591us/step - loss: 845826.5000
Epoch 104/500

 1/56 [..............................] - ETA: 0s - loss: 951154.9375
56/56 [==============================] - 0s 616us/step - loss: 729812.8125
Epoch 105/500

 1/56 [..............................] - ETA: 0s - loss: 750716.7500
56/56 [==============================] - 0s 638us/step - loss: 785732.3125
Epoch 106/500

 1/56 [..............................] - ETA: 0s - loss: 896193.7500
56/56 [==============================] - 0s 610us/step - loss: 1336882.1250
Epoch 107/500

 1/56 [..............................] - ETA: 0s - loss: 615198.8750
56/56 [==============================] - 0s 600us/step - loss: 781616.8125
Epoch 108/500

 1/56 [..............................] - ETA: 0s - loss: 822084.7500
56/56 [==============================] - 0s 580us/step - loss: 2500340.2500
Epoch 109/500

 1/56 [..............................] - ETA: 0s - loss: 898239.1250
56/56 [==============================] - 0s 595us/step - loss: 744509.3750
Epoch 110/500

 1/56 [..............................] - ETA: 0s - loss: 1106409.2500
56/56 [==============================] - 0s 570us/step - loss: 759995.8750
Epoch 111/500

 1/56 [..............................] - ETA: 0s - loss: 1088865.6250
56/56 [==============================] - 0s 608us/step - loss: 731796.5625
Epoch 112/500

 1/56 [..............................] - ETA: 0s - loss: 844539.6250
56/56 [==============================] - 0s 596us/step - loss: 772959.5000
Epoch 113/500

 1/56 [..............................] - ETA: 0s - loss: 499703.8125
56/56 [==============================] - 0s 589us/step - loss: 1643489.6250
Epoch 114/500

 1/56 [..............................] - ETA: 0s - loss: 504398.9375
56/56 [==============================] - 0s 598us/step - loss: 7611688.5000
Epoch 115/500

 1/56 [..............................] - ETA: 0s - loss: 2365381.5000
56/56 [==============================] - 0s 582us/step - loss: 4082578.5000
Epoch 116/500

 1/56 [..............................] - ETA: 0s - loss: 400491.3125
56/56 [==============================] - 0s 569us/step - loss: 5749669.5000
Epoch 117/500

 1/56 [..............................] - ETA: 0s - loss: 949560.8750
56/56 [==============================] - 0s 587us/step - loss: 1382328.0000
Epoch 118/500

 1/56 [..............................] - ETA: 0s - loss: 381414.6875
56/56 [==============================] - 0s 582us/step - loss: 1139855.0000
Epoch 119/500

 1/56 [..............................] - ETA: 0s - loss: 397064.7812
56/56 [==============================] - 0s 606us/step - loss: 808328.5000
Epoch 120/500

 1/56 [..............................] - ETA: 0s - loss: 404619.0938
56/56 [==============================] - 0s 621us/step - loss: 719200.8750
Epoch 121/500

 1/56 [..............................] - ETA: 0s - loss: 1362092.8750
56/56 [==============================] - 0s 613us/step - loss: 707694.5625
Epoch 122/500

 1/56 [..............................] - ETA: 0s - loss: 348030.8125
56/56 [==============================] - 0s 617us/step - loss: 693896.0000
Epoch 123/500

 1/56 [..............................] - ETA: 0s - loss: 668917.2500
56/56 [==============================] - 0s 578us/step - loss: 685654.6250
Epoch 124/500

 1/56 [..............................] - ETA: 0s - loss: 1190608.6250
56/56 [==============================] - 0s 568us/step - loss: 654994.0000
Epoch 125/500

 1/56 [..............................] - ETA: 0s - loss: 621622.5625
56/56 [==============================] - 0s 571us/step - loss: 638111.1250
Epoch 126/500

 1/56 [..............................] - ETA: 0s - loss: 1157725.7500
56/56 [==============================] - 0s 565us/step - loss: 595220.6875
Epoch 127/500

 1/56 [..............................] - ETA: 0s - loss: 442286.0938
56/56 [==============================] - 0s 576us/step - loss: 573320.3125
Epoch 128/500

 1/56 [..............................] - ETA: 0s - loss: 565951.1875
56/56 [==============================] - 0s 591us/step - loss: 617095.9375
Epoch 129/500

 1/56 [..............................] - ETA: 0s - loss: 585954.5625
56/56 [==============================] - 0s 603us/step - loss: 522373.8125
Epoch 130/500

 1/56 [..............................] - ETA: 0s - loss: 287751.5938
56/56 [==============================] - 0s 601us/step - loss: 526809.1250
Epoch 131/500

 1/56 [..............................] - ETA: 0s - loss: 546678.9375
56/56 [==============================] - 0s 606us/step - loss: 515863.3438
Epoch 132/500

 1/56 [..............................] - ETA: 0s - loss: 355344.0000
56/56 [==============================] - 0s 601us/step - loss: 527393.3125
Epoch 133/500

 1/56 [..............................] - ETA: 0s - loss: 423038.2812
56/56 [==============================] - 0s 589us/step - loss: 536103.7500
Epoch 134/500

 1/56 [..............................] - ETA: 0s - loss: 298977.8438
56/56 [==============================] - 0s 611us/step - loss: 588388.0625
Epoch 135/500

 1/56 [..............................] - ETA: 0s - loss: 393377.3750
56/56 [==============================] - 0s 631us/step - loss: 593850.2500
Epoch 136/500

 1/56 [..............................] - ETA: 0s - loss: 681784.8125
56/56 [==============================] - 0s 643us/step - loss: 1159940.0000
Epoch 137/500

 1/56 [..............................] - ETA: 0s - loss: 45753584.0000
56/56 [==============================] - 0s 612us/step - loss: 3677400.2500
Epoch 138/500

 1/56 [..............................] - ETA: 0s - loss: 1129849.5000
56/56 [==============================] - 0s 614us/step - loss: 2578011.5000
Epoch 139/500

 1/56 [..............................] - ETA: 0s - loss: 1595012.8750
56/56 [==============================] - 0s 617us/step - loss: 5587586.5000
Epoch 140/500

 1/56 [..............................] - ETA: 0s - loss: 503658.5625
56/56 [==============================] - 0s 649us/step - loss: 8865813.0000
Epoch 141/500

 1/56 [..............................] - ETA: 0s - loss: 882743.5000
56/56 [==============================] - 0s 661us/step - loss: 5750696.5000
Epoch 142/500

 1/56 [..............................] - ETA: 0s - loss: 815105.8750
56/56 [==============================] - 0s 625us/step - loss: 2492685.2500
Epoch 143/500

 1/56 [..............................] - ETA: 0s - loss: 771157.5000
56/56 [==============================] - 0s 593us/step - loss: 1483320.3750
Epoch 144/500

 1/56 [..............................] - ETA: 0s - loss: 781897.4375
56/56 [==============================] - 0s 571us/step - loss: 820753.0625
Epoch 145/500

 1/56 [..............................] - ETA: 0s - loss: 494775.4688
56/56 [==============================] - 0s 565us/step - loss: 670628.6875
Epoch 146/500

 1/56 [..............................] - ETA: 0s - loss: 497377.4688
56/56 [==============================] - 0s 573us/step - loss: 641296.1875
Epoch 147/500

 1/56 [..............................] - ETA: 0s - loss: 467491.7812
56/56 [==============================] - 0s 591us/step - loss: 628691.8125
Epoch 148/500

 1/56 [..............................] - ETA: 0s - loss: 1000035.6250
56/56 [==============================] - 0s 608us/step - loss: 644884.4375
Epoch 149/500

 1/56 [..............................] - ETA: 0s - loss: 776567.1250
56/56 [==============================] - 0s 619us/step - loss: 624480.8750
Epoch 150/500

 1/56 [..............................] - ETA: 0s - loss: 661929.0000
56/56 [==============================] - 0s 608us/step - loss: 652214.7500
Epoch 151/500

 1/56 [..............................] - ETA: 0s - loss: 586107.4375
56/56 [==============================] - 0s 592us/step - loss: 636987.4375
Epoch 152/500

 1/56 [..............................] - ETA: 0s - loss: 338847.5625
56/56 [==============================] - 0s 572us/step - loss: 648496.3750
Epoch 153/500

 1/56 [..............................] - ETA: 0s - loss: 377109.9688
56/56 [==============================] - 0s 563us/step - loss: 630798.4375
Epoch 154/500

 1/56 [..............................] - ETA: 0s - loss: 401138.5312
56/56 [==============================] - 0s 579us/step - loss: 639650.6250
Epoch 155/500

 1/56 [..............................] - ETA: 0s - loss: 710240.0000
56/56 [==============================] - 0s 577us/step - loss: 629809.0625
Epoch 156/500

 1/56 [..............................] - ETA: 0s - loss: 254093.1719
56/56 [==============================] - 0s 594us/step - loss: 629014.5625
Epoch 157/500

 1/56 [..............................] - ETA: 0s - loss: 411655.6875
56/56 [==============================] - 0s 612us/step - loss: 639693.3125
Epoch 158/500

 1/56 [..............................] - ETA: 0s - loss: 662550.8125
56/56 [==============================] - 0s 611us/step - loss: 607617.3750
Epoch 159/500

 1/56 [..............................] - ETA: 0s - loss: 1039978.3750
56/56 [==============================] - 0s 598us/step - loss: 587643.1250
Epoch 160/500

 1/56 [..............................] - ETA: 0s - loss: 403741.0312
56/56 [==============================] - 0s 599us/step - loss: 630385.0625
Epoch 161/500

 1/56 [..............................] - ETA: 0s - loss: 863010.0000
56/56 [==============================] - 0s 585us/step - loss: 596700.9375
Epoch 162/500

 1/56 [..............................] - ETA: 0s - loss: 594257.9375
56/56 [==============================] - 0s 579us/step - loss: 561806.3125
Epoch 163/500

 1/56 [..............................] - ETA: 0s - loss: 598544.3750
56/56 [==============================] - 0s 600us/step - loss: 586757.3750
Epoch 164/500

 1/56 [..............................] - ETA: 0s - loss: 293403.1250
56/56 [==============================] - 0s 601us/step - loss: 599809.4375
Epoch 165/500

 1/56 [..............................] - ETA: 0s - loss: 937395.3750
56/56 [==============================] - 0s 612us/step - loss: 658524.3125
Epoch 166/500

 1/56 [..............................] - ETA: 0s - loss: 538180.8750
56/56 [==============================] - 0s 609us/step - loss: 667577.8750
Epoch 167/500

 1/56 [..............................] - ETA: 0s - loss: 440949.3750
56/56 [==============================] - 0s 604us/step - loss: 502847.6250
Epoch 168/500

 1/56 [..............................] - ETA: 0s - loss: 818370.7500
56/56 [==============================] - 0s 596us/step - loss: 549592.0625
Epoch 169/500

 1/56 [..............................] - ETA: 0s - loss: 504013.2500
56/56 [==============================] - 0s 590us/step - loss: 1171381.6250
Epoch 170/500

 1/56 [..............................] - ETA: 0s - loss: 376274.8438
56/56 [==============================] - 0s 592us/step - loss: 853213.3750
Epoch 171/500

 1/56 [..............................] - ETA: 0s - loss: 242238.0781
56/56 [==============================] - 0s 589us/step - loss: 562547.1250
Epoch 172/500

 1/56 [..............................] - ETA: 0s - loss: 867758.6250
56/56 [==============================] - 0s 577us/step - loss: 600192.1875
Epoch 173/500

 1/56 [..............................] - ETA: 0s - loss: 355399.9375
56/56 [==============================] - 0s 587us/step - loss: 1037112.8750
Epoch 174/500

 1/56 [..............................] - ETA: 0s - loss: 1437286.0000
56/56 [==============================] - 0s 572us/step - loss: 633994.8125
Epoch 175/500

 1/56 [..............................] - ETA: 0s - loss: 711763.6250
56/56 [==============================] - 0s 616us/step - loss: 599053.3750
Epoch 176/500

 1/56 [..............................] - ETA: 0s - loss: 1430024.7500
56/56 [==============================] - 0s 623us/step - loss: 902202.6250
Epoch 177/500

 1/56 [..............................] - ETA: 0s - loss: 217197.5469
56/56 [==============================] - 0s 592us/step - loss: 1810715.1250
Epoch 178/500

 1/56 [..............................] - ETA: 0s - loss: 474590.9375
56/56 [==============================] - 0s 601us/step - loss: 538046.8750
Epoch 179/500

 1/56 [..............................] - ETA: 0s - loss: 213619.8750
56/56 [==============================] - 0s 613us/step - loss: 1694351.6250
Epoch 180/500

 1/56 [..............................] - ETA: 0s - loss: 1061488.2500
56/56 [==============================] - 0s 588us/step - loss: 1369866.2500
Epoch 181/500

 1/56 [..............................] - ETA: 0s - loss: 2286357.5000
56/56 [==============================] - 0s 601us/step - loss: 858001.2500
Epoch 182/500

 1/56 [..............................] - ETA: 0s - loss: 315549.4062
56/56 [==============================] - 0s 597us/step - loss: 444374.5000
Epoch 183/500

 1/56 [..............................] - ETA: 0s - loss: 1758145.1250
56/56 [==============================] - 0s 607us/step - loss: 501168.2500
Epoch 184/500

 1/56 [..............................] - ETA: 0s - loss: 4264856.0000
56/56 [==============================] - 0s 619us/step - loss: 639699.5625
Epoch 185/500

 1/56 [..............................] - ETA: 0s - loss: 509656.3750
56/56 [==============================] - 0s 759us/step - loss: 426266.6250
Epoch 186/500

 1/56 [..............................] - ETA: 0s - loss: 551765.4375
56/56 [==============================] - ETA: 0s - loss: 518875.4062
56/56 [==============================] - 0s 912us/step - loss: 518875.4062
Epoch 187/500

 1/56 [..............................] - ETA: 0s - loss: 381784.2500
56/56 [==============================] - 0s 790us/step - loss: 627394.5000
Epoch 188/500

 1/56 [..............................] - ETA: 0s - loss: 155537.3438
56/56 [==============================] - 0s 661us/step - loss: 495377.1250
Epoch 189/500

 1/56 [..............................] - ETA: 0s - loss: 136162.8750
56/56 [==============================] - 0s 664us/step - loss: 1653757.8750
Epoch 190/500

 1/56 [..............................] - ETA: 0s - loss: 492551.7500
56/56 [==============================] - 0s 643us/step - loss: 496671.0938
Epoch 191/500

 1/56 [..............................] - ETA: 0s - loss: 259210.7188
56/56 [==============================] - 0s 648us/step - loss: 465597.0312
Epoch 192/500

 1/56 [..............................] - ETA: 0s - loss: 535580.8750
56/56 [==============================] - 0s 633us/step - loss: 824501.6875
Epoch 193/500

 1/56 [..............................] - ETA: 0s - loss: 463375.1250
56/56 [==============================] - 0s 599us/step - loss: 523979.5312
Epoch 194/500

 1/56 [..............................] - ETA: 0s - loss: 502151.8750
56/56 [==============================] - 0s 599us/step - loss: 600965.1875
Epoch 195/500

 1/56 [..............................] - ETA: 0s - loss: 340700.5625
56/56 [==============================] - 0s 590us/step - loss: 566351.4375
Epoch 196/500

 1/56 [..............................] - ETA: 0s - loss: 492010.7188
56/56 [==============================] - 0s 588us/step - loss: 722990.3750
Epoch 197/500

 1/56 [..............................] - ETA: 0s - loss: 211651.2656
56/56 [==============================] - 0s 590us/step - loss: 441760.7188
Epoch 198/500

 1/56 [..............................] - ETA: 0s - loss: 213477.0938
56/56 [==============================] - 0s 563us/step - loss: 714055.4375
Epoch 199/500

 1/56 [..............................] - ETA: 0s - loss: 230827.8438
56/56 [==============================] - 0s 569us/step - loss: 449634.7500
Epoch 200/500

 1/56 [..............................] - ETA: 0s - loss: 159065.5312
56/56 [==============================] - 0s 604us/step - loss: 525742.9375
Epoch 201/500

 1/56 [..............................] - ETA: 0s - loss: 405899.2500
56/56 [==============================] - 0s 596us/step - loss: 931228.7500
Epoch 202/500

 1/56 [..............................] - ETA: 0s - loss: 880025.8125
56/56 [==============================] - 0s 580us/step - loss: 429723.9688
Epoch 203/500

 1/56 [..............................] - ETA: 0s - loss: 161720.7500
56/56 [==============================] - 0s 557us/step - loss: 420186.8750
Epoch 204/500

 1/56 [..............................] - ETA: 0s - loss: 314785.3750
56/56 [==============================] - 0s 559us/step - loss: 501318.5000
Epoch 205/500

 1/56 [..............................] - ETA: 0s - loss: 368233.9375
56/56 [==============================] - 0s 556us/step - loss: 878920.0000
Epoch 206/500

 1/56 [..............................] - ETA: 0s - loss: 420501.1562
56/56 [==============================] - 0s 560us/step - loss: 402371.7812
Epoch 207/500

 1/56 [..............................] - ETA: 0s - loss: 454235.5625
56/56 [==============================] - 0s 565us/step - loss: 397788.0312
Epoch 208/500

 1/56 [..............................] - ETA: 0s - loss: 254593.3594
56/56 [==============================] - 0s 563us/step - loss: 423065.4688
Epoch 209/500

 1/56 [..............................] - ETA: 0s - loss: 194289.2812
56/56 [==============================] - 0s 598us/step - loss: 397395.1562
Epoch 210/500

 1/56 [..............................] - ETA: 0s - loss: 370401.9375
56/56 [==============================] - 0s 561us/step - loss: 393516.8125
Epoch 211/500

 1/56 [..............................] - ETA: 0s - loss: 164273.0312
56/56 [==============================] - 0s 554us/step - loss: 391989.5000
Epoch 212/500

 1/56 [..............................] - ETA: 0s - loss: 297719.2500
56/56 [==============================] - 0s 560us/step - loss: 391224.0625
Epoch 213/500

 1/56 [..............................] - ETA: 0s - loss: 245677.4062
56/56 [==============================] - 0s 555us/step - loss: 390340.8125
Epoch 214/500

 1/56 [..............................] - ETA: 0s - loss: 622265.4375
56/56 [==============================] - 0s 558us/step - loss: 394939.2188
Epoch 215/500

 1/56 [..............................] - ETA: 0s - loss: 205794.2188
56/56 [==============================] - 0s 555us/step - loss: 393630.5938
Epoch 216/500

 1/56 [..............................] - ETA: 0s - loss: 332275.0000
56/56 [==============================] - 0s 545us/step - loss: 388896.1562
Epoch 217/500

 1/56 [..............................] - ETA: 0s - loss: 355159.5938
56/56 [==============================] - 0s 608us/step - loss: 387164.7812
Epoch 218/500

 1/56 [..............................] - ETA: 0s - loss: 350502.7812
56/56 [==============================] - 0s 611us/step - loss: 409402.9062
Epoch 219/500

 1/56 [..............................] - ETA: 0s - loss: 188262.8438
56/56 [==============================] - 0s 612us/step - loss: 449401.9062
Epoch 220/500

 1/56 [..............................] - ETA: 0s - loss: 162755.2344
56/56 [==============================] - 0s 597us/step - loss: 511554.6875
Epoch 221/500

 1/56 [..............................] - ETA: 0s - loss: 325510.5312
56/56 [==============================] - 0s 594us/step - loss: 577601.6875
Epoch 222/500

 1/56 [..............................] - ETA: 0s - loss: 376702.8125
56/56 [==============================] - 0s 568us/step - loss: 1174263.3750
Epoch 223/500

 1/56 [..............................] - ETA: 0s - loss: 201655.0312
56/56 [==============================] - 0s 585us/step - loss: 422607.5938
Epoch 224/500

 1/56 [..............................] - ETA: 0s - loss: 260437.1562
56/56 [==============================] - 0s 569us/step - loss: 404021.4062
Epoch 225/500

 1/56 [..............................] - ETA: 0s - loss: 286087.0938
56/56 [==============================] - 0s 575us/step - loss: 404450.3125
Epoch 226/500

 1/56 [..............................] - ETA: 0s - loss: 524565.1875
56/56 [==============================] - 0s 540us/step - loss: 896269.7500
Epoch 227/500

 1/56 [..............................] - ETA: 0s - loss: 369528.0625
56/56 [==============================] - 0s 574us/step - loss: 409594.6562
Epoch 228/500

 1/56 [..............................] - ETA: 0s - loss: 4420421.0000
56/56 [==============================] - 0s 570us/step - loss: 401692.2812
Epoch 229/500

 1/56 [..............................] - ETA: 0s - loss: 218394.6875
56/56 [==============================] - 0s 570us/step - loss: 445457.7812
Epoch 230/500

 1/56 [..............................] - ETA: 0s - loss: 4228276.5000
56/56 [==============================] - 0s 546us/step - loss: 419823.0000
Epoch 231/500

 1/56 [..............................] - ETA: 0s - loss: 202414.2344
56/56 [==============================] - 0s 577us/step - loss: 409796.5625
Epoch 232/500

 1/56 [..............................] - ETA: 0s - loss: 186430.4688
56/56 [==============================] - 0s 563us/step - loss: 496352.4688
Epoch 233/500

 1/56 [..............................] - ETA: 0s - loss: 263739.9375
56/56 [==============================] - 0s 567us/step - loss: 403826.1562
Epoch 234/500

 1/56 [..............................] - ETA: 0s - loss: 342997.9375
56/56 [==============================] - 0s 531us/step - loss: 443033.5312
Epoch 235/500

 1/56 [..............................] - ETA: 0s - loss: 393820.6562
56/56 [==============================] - 0s 566us/step - loss: 397750.0625
Epoch 236/500

 1/56 [..............................] - ETA: 0s - loss: 172634.3125
56/56 [==============================] - 0s 540us/step - loss: 918411.5625
Epoch 237/500

 1/56 [..............................] - ETA: 0s - loss: 528123.1250
56/56 [==============================] - 0s 582us/step - loss: 416599.9062
Epoch 238/500

 1/56 [..............................] - ETA: 0s - loss: 4248170.0000
56/56 [==============================] - 0s 562us/step - loss: 448026.2500
Epoch 239/500

 1/56 [..............................] - ETA: 0s - loss: 270628.4375
56/56 [==============================] - 0s 566us/step - loss: 476474.3750
Epoch 240/500

 1/56 [..............................] - ETA: 0s - loss: 92928.2344
56/56 [==============================] - 0s 538us/step - loss: 733325.3750
Epoch 241/500

 1/56 [..............................] - ETA: 0s - loss: 271109.6875
56/56 [==============================] - 0s 575us/step - loss: 537420.8750
Epoch 242/500

 1/56 [..............................] - ETA: 0s - loss: 460873.9062
56/56 [==============================] - 0s 553us/step - loss: 401110.3438
Epoch 243/500

 1/56 [..............................] - ETA: 0s - loss: 320832.0625
56/56 [==============================] - 0s 678us/step - loss: 389761.8125
Epoch 244/500

 1/56 [..............................] - ETA: 0s - loss: 180794.4062
56/56 [==============================] - 0s 692us/step - loss: 373534.9062
Epoch 245/500

 1/56 [..............................] - ETA: 0s - loss: 235501.7500
56/56 [==============================] - 0s 669us/step - loss: 376843.7500
Epoch 246/500

 1/56 [..............................] - ETA: 0s - loss: 388348.5000
56/56 [==============================] - 0s 621us/step - loss: 380490.7188
Epoch 247/500

 1/56 [..............................] - ETA: 0s - loss: 485247.0000
56/56 [==============================] - 0s 614us/step - loss: 392047.6250
Epoch 248/500

 1/56 [..............................] - ETA: 0s - loss: 229348.4688
56/56 [==============================] - 0s 606us/step - loss: 386480.1562
Epoch 249/500

 1/56 [..............................] - ETA: 0s - loss: 770902.4375
56/56 [==============================] - 0s 651us/step - loss: 379579.1562
Epoch 250/500

 1/56 [..............................] - ETA: 0s - loss: 220076.0469
56/56 [==============================] - 0s 642us/step - loss: 960064.5625
Epoch 251/500

 1/56 [..............................] - ETA: 0s - loss: 597783.0625
56/56 [==============================] - 0s 604us/step - loss: 457915.6875
Epoch 252/500

 1/56 [..............................] - ETA: 0s - loss: 224829.8438
56/56 [==============================] - 0s 591us/step - loss: 397102.2812
Epoch 253/500

 1/56 [..............................] - ETA: 0s - loss: 313016.9062
56/56 [==============================] - 0s 595us/step - loss: 564620.5625
Epoch 254/500

 1/56 [..............................] - ETA: 0s - loss: 595809.8750
56/56 [==============================] - 0s 595us/step - loss: 398215.1250
Epoch 255/500

 1/56 [..............................] - ETA: 0s - loss: 127734.2500
56/56 [==============================] - 0s 594us/step - loss: 725475.6250
Epoch 256/500

 1/56 [..............................] - ETA: 0s - loss: 282593.4375
56/56 [==============================] - 0s 584us/step - loss: 403943.8125
Epoch 257/500

 1/56 [..............................] - ETA: 0s - loss: 239545.2500
56/56 [==============================] - 0s 601us/step - loss: 381877.2500
Epoch 258/500

 1/56 [..............................] - ETA: 0s - loss: 276900.0312
56/56 [==============================] - 0s 575us/step - loss: 394064.7812
Epoch 259/500

 1/56 [..............................] - ETA: 0s - loss: 239204.3594
56/56 [==============================] - 0s 587us/step - loss: 372161.5312
Epoch 260/500

 1/56 [..............................] - ETA: 0s - loss: 197261.0312
56/56 [==============================] - 0s 569us/step - loss: 367600.4688
Epoch 261/500

 1/56 [..............................] - ETA: 0s - loss: 330154.3125
56/56 [==============================] - 0s 567us/step - loss: 383748.6250
Epoch 262/500

 1/56 [..............................] - ETA: 0s - loss: 330639.3750
56/56 [==============================] - 0s 566us/step - loss: 367318.9062
Epoch 263/500

 1/56 [..............................] - ETA: 0s - loss: 4067747.0000
56/56 [==============================] - 0s 588us/step - loss: 371880.2500
Epoch 264/500

 1/56 [..............................] - ETA: 0s - loss: 208893.4062
56/56 [==============================] - 0s 572us/step - loss: 427830.3125
Epoch 265/500

 1/56 [..............................] - ETA: 0s - loss: 524660.3750
56/56 [==============================] - 0s 577us/step - loss: 674268.9375
Epoch 266/500

 1/56 [..............................] - ETA: 0s - loss: 527578.1875
56/56 [==============================] - 0s 566us/step - loss: 1525067.2500
Epoch 267/500

 1/56 [..............................] - ETA: 0s - loss: 443886.5312
56/56 [==============================] - 0s 561us/step - loss: 512429.0625
Epoch 268/500

 1/56 [..............................] - ETA: 0s - loss: 250825.2812
56/56 [==============================] - 0s 569us/step - loss: 478716.2500
Epoch 269/500

 1/56 [..............................] - ETA: 0s - loss: 136381.9844
56/56 [==============================] - 0s 574us/step - loss: 421423.9375
Epoch 270/500

 1/56 [..............................] - ETA: 0s - loss: 403630.7812
56/56 [==============================] - 0s 569us/step - loss: 392617.3750
Epoch 271/500

 1/56 [..............................] - ETA: 0s - loss: 215266.2812
56/56 [==============================] - 0s 575us/step - loss: 380000.0312
Epoch 272/500

 1/56 [..............................] - ETA: 0s - loss: 233225.3125
56/56 [==============================] - 0s 591us/step - loss: 376335.2500
Epoch 273/500

 1/56 [..............................] - ETA: 0s - loss: 474485.5000
56/56 [==============================] - 0s 580us/step - loss: 372614.0312
Epoch 274/500

 1/56 [..............................] - ETA: 0s - loss: 195590.6875
56/56 [==============================] - 0s 580us/step - loss: 391646.1562
Epoch 275/500

 1/56 [..............................] - ETA: 0s - loss: 4196494.5000
56/56 [==============================] - 0s 562us/step - loss: 386934.4062
Epoch 276/500

 1/56 [..............................] - ETA: 0s - loss: 209641.4688
56/56 [==============================] - 0s 570us/step - loss: 365605.8438
Epoch 277/500

 1/56 [..............................] - ETA: 0s - loss: 265267.4375
56/56 [==============================] - 0s 569us/step - loss: 362924.2812
Epoch 278/500

 1/56 [..............................] - ETA: 0s - loss: 503417.0938
56/56 [==============================] - 0s 575us/step - loss: 363242.5312
Epoch 279/500

 1/56 [..............................] - ETA: 0s - loss: 164083.8281
56/56 [==============================] - 0s 574us/step - loss: 362499.4062
Epoch 280/500

 1/56 [..............................] - ETA: 0s - loss: 119245.3125
56/56 [==============================] - 0s 596us/step - loss: 360538.5000
Epoch 281/500

 1/56 [..............................] - ETA: 0s - loss: 403205.1562
56/56 [==============================] - 0s 614us/step - loss: 361530.8750
Epoch 282/500

 1/56 [..............................] - ETA: 0s - loss: 572389.1875
56/56 [==============================] - 0s 594us/step - loss: 368353.2500
Epoch 283/500

 1/56 [..............................] - ETA: 0s - loss: 430154.3750
56/56 [==============================] - 0s 588us/step - loss: 358464.9375
Epoch 284/500

 1/56 [..............................] - ETA: 0s - loss: 200293.6875
56/56 [==============================] - 0s 576us/step - loss: 357720.6250
Epoch 285/500

 1/56 [..............................] - ETA: 0s - loss: 279397.7500
56/56 [==============================] - 0s 571us/step - loss: 357444.1250
Epoch 286/500

 1/56 [..............................] - ETA: 0s - loss: 337183.2188
56/56 [==============================] - 0s 570us/step - loss: 357527.7500
Epoch 287/500

 1/56 [..............................] - ETA: 0s - loss: 236698.5938
56/56 [==============================] - 0s 575us/step - loss: 357982.5938
Epoch 288/500

 1/56 [..............................] - ETA: 0s - loss: 409466.9688
56/56 [==============================] - 0s 567us/step - loss: 363008.8438
Epoch 289/500

 1/56 [..............................] - ETA: 0s - loss: 604340.2500
56/56 [==============================] - 0s 576us/step - loss: 392342.5625
Epoch 290/500

 1/56 [..............................] - ETA: 0s - loss: 120571.2344
56/56 [==============================] - 0s 596us/step - loss: 387643.5000
Epoch 291/500

 1/56 [..............................] - ETA: 0s - loss: 366877.6250
56/56 [==============================] - 0s 596us/step - loss: 365583.0938
Epoch 292/500

 1/56 [..............................] - ETA: 0s - loss: 3876678.2500
56/56 [==============================] - 0s 589us/step - loss: 380349.1875
Epoch 293/500

 1/56 [..............................] - ETA: 0s - loss: 219049.9219
56/56 [==============================] - 0s 617us/step - loss: 737142.3125
Epoch 294/500

 1/56 [..............................] - ETA: 0s - loss: 216117.4375
56/56 [==============================] - 0s 608us/step - loss: 515052.7812
Epoch 295/500

 1/56 [..............................] - ETA: 0s - loss: 1139742.7500
56/56 [==============================] - 0s 598us/step - loss: 503420.2812
Epoch 296/500

 1/56 [..............................] - ETA: 0s - loss: 249818.9062
56/56 [==============================] - 0s 611us/step - loss: 424262.9688
Epoch 297/500

 1/56 [..............................] - ETA: 0s - loss: 156397.5000
56/56 [==============================] - 0s 604us/step - loss: 403370.8438
Epoch 298/500

 1/56 [..............................] - ETA: 0s - loss: 213125.1094
56/56 [==============================] - 0s 594us/step - loss: 365996.9062
Epoch 299/500

 1/56 [..............................] - ETA: 0s - loss: 228141.3438
56/56 [==============================] - 0s 597us/step - loss: 361575.6562
Epoch 300/500

 1/56 [..............................] - ETA: 0s - loss: 157473.5000
56/56 [==============================] - 0s 584us/step - loss: 361578.7188
Epoch 301/500

 1/56 [..............................] - ETA: 0s - loss: 385224.1875
56/56 [==============================] - 0s 571us/step - loss: 427068.8438
Epoch 302/500

 1/56 [..............................] - ETA: 0s - loss: 1054153.6250
56/56 [==============================] - 0s 580us/step - loss: 409897.6875
Epoch 303/500

 1/56 [..............................] - ETA: 0s - loss: 210383.3281
56/56 [==============================] - 0s 590us/step - loss: 379831.2812
Epoch 304/500

 1/56 [..............................] - ETA: 0s - loss: 386322.0000
56/56 [==============================] - 0s 602us/step - loss: 364914.5000
Epoch 305/500

 1/56 [..............................] - ETA: 0s - loss: 401511.2812
56/56 [==============================] - 0s 637us/step - loss: 369933.5938
Epoch 306/500

 1/56 [..............................] - ETA: 0s - loss: 270189.2500
56/56 [==============================] - 0s 611us/step - loss: 363782.1875
Epoch 307/500

 1/56 [..............................] - ETA: 0s - loss: 364587.9375
56/56 [==============================] - 0s 617us/step - loss: 355662.6562
Epoch 308/500

 1/56 [..............................] - ETA: 0s - loss: 202706.2812
56/56 [==============================] - 0s 612us/step - loss: 386782.6250
Epoch 309/500

 1/56 [..............................] - ETA: 0s - loss: 155346.0469
56/56 [==============================] - 0s 600us/step - loss: 356157.4375
Epoch 310/500

 1/56 [..............................] - ETA: 0s - loss: 488932.4688
56/56 [==============================] - 0s 617us/step - loss: 410165.5312
Epoch 311/500

 1/56 [..............................] - ETA: 0s - loss: 463947.6875
56/56 [==============================] - 0s 623us/step - loss: 398861.5938
Epoch 312/500

 1/56 [..............................] - ETA: 0s - loss: 264687.1875
56/56 [==============================] - 0s 599us/step - loss: 355281.3750
Epoch 313/500

 1/56 [..............................] - ETA: 0s - loss: 303649.6875
56/56 [==============================] - 0s 596us/step - loss: 363282.0000
Epoch 314/500

 1/56 [..............................] - ETA: 0s - loss: 267877.4688
56/56 [==============================] - 0s 615us/step - loss: 390117.1250
Epoch 315/500

 1/56 [..............................] - ETA: 0s - loss: 224747.7812
56/56 [==============================] - 0s 605us/step - loss: 353700.4375
Epoch 316/500

 1/56 [..............................] - ETA: 0s - loss: 160812.2812
56/56 [==============================] - 0s 607us/step - loss: 353824.0625
Epoch 317/500

 1/56 [..............................] - ETA: 0s - loss: 150681.0625
56/56 [==============================] - 0s 648us/step - loss: 354671.4688
Epoch 318/500

 1/56 [..............................] - ETA: 0s - loss: 201426.0312
56/56 [==============================] - 0s 733us/step - loss: 348829.2188
Epoch 319/500

 1/56 [..............................] - ETA: 0s - loss: 175403.0000
56/56 [==============================] - 0s 656us/step - loss: 363970.8750
Epoch 320/500

 1/56 [..............................] - ETA: 0s - loss: 359994.4375
56/56 [==============================] - 0s 621us/step - loss: 352707.0000
Epoch 321/500

 1/56 [..............................] - ETA: 0s - loss: 4079985.5000
56/56 [==============================] - 0s 597us/step - loss: 391327.0000
Epoch 322/500

 1/56 [..............................] - ETA: 0s - loss: 354887.6250
56/56 [==============================] - 0s 591us/step - loss: 398391.1562
Epoch 323/500

 1/56 [..............................] - ETA: 0s - loss: 391052.5938
56/56 [==============================] - 0s 569us/step - loss: 464888.2500
Epoch 324/500

 1/56 [..............................] - ETA: 0s - loss: 349281.9688
56/56 [==============================] - 0s 585us/step - loss: 384305.6875
Epoch 325/500

 1/56 [..............................] - ETA: 0s - loss: 267394.8438
56/56 [==============================] - 0s 594us/step - loss: 356365.1875
Epoch 326/500

 1/56 [..............................] - ETA: 0s - loss: 107899.1719
56/56 [==============================] - 0s 591us/step - loss: 358909.8750
Epoch 327/500

 1/56 [..............................] - ETA: 0s - loss: 163683.6250
56/56 [==============================] - 0s 597us/step - loss: 413705.2500
Epoch 328/500

 1/56 [..............................] - ETA: 0s - loss: 242132.7500
56/56 [==============================] - 0s 611us/step - loss: 367518.0000
Epoch 329/500

 1/56 [..............................] - ETA: 0s - loss: 138306.5156
56/56 [==============================] - 0s 606us/step - loss: 354871.1875
Epoch 330/500

 1/56 [..............................] - ETA: 0s - loss: 345327.1250
56/56 [==============================] - 0s 605us/step - loss: 368589.1875
Epoch 331/500

 1/56 [..............................] - ETA: 0s - loss: 378933.0625
56/56 [==============================] - 0s 810us/step - loss: 350988.1562
Epoch 332/500

 1/56 [..............................] - ETA: 0s - loss: 277234.0312
53/56 [===========================&gt;..] - ETA: 0s - loss: 344401.0938
56/56 [==============================] - 0s 950us/step - loss: 350939.0938
Epoch 333/500

 1/56 [..............................] - ETA: 0s - loss: 172980.6875
56/56 [==============================] - 0s 723us/step - loss: 571946.0625
Epoch 334/500

 1/56 [..............................] - ETA: 0s - loss: 724647.5000
56/56 [==============================] - 0s 594us/step - loss: 3571470.5000
Epoch 335/500

 1/56 [..............................] - ETA: 0s - loss: 1404751.2500
56/56 [==============================] - 0s 606us/step - loss: 1430780.6250
Epoch 336/500

 1/56 [..............................] - ETA: 0s - loss: 658751.9375
56/56 [==============================] - 0s 590us/step - loss: 1481355.0000
Epoch 337/500

 1/56 [..............................] - ETA: 0s - loss: 881558.6250
56/56 [==============================] - 0s 587us/step - loss: 1034806.1875
Epoch 338/500

 1/56 [..............................] - ETA: 0s - loss: 292063.5000
56/56 [==============================] - 0s 586us/step - loss: 728023.7500
Epoch 339/500

 1/56 [..............................] - ETA: 0s - loss: 229173.8750
56/56 [==============================] - 0s 588us/step - loss: 1436744.5000
Epoch 340/500

 1/56 [..............................] - ETA: 0s - loss: 491437.3125
56/56 [==============================] - 0s 584us/step - loss: 1676884.6250
Epoch 341/500

 1/56 [..............................] - ETA: 0s - loss: 723023.8750
56/56 [==============================] - 0s 604us/step - loss: 1342309.8750
Epoch 342/500

 1/56 [..............................] - ETA: 0s - loss: 429678.5000
56/56 [==============================] - 0s 590us/step - loss: 910812.1250
Epoch 343/500

 1/56 [..............................] - ETA: 0s - loss: 542267.7500
56/56 [==============================] - 0s 584us/step - loss: 1809502.5000
Epoch 344/500

 1/56 [..............................] - ETA: 0s - loss: 797550.0000
56/56 [==============================] - 0s 555us/step - loss: 1098417.7500
Epoch 345/500

 1/56 [..............................] - ETA: 0s - loss: 220600.7344
56/56 [==============================] - 0s 620us/step - loss: 919234.5000
Epoch 346/500

 1/56 [..............................] - ETA: 0s - loss: 1058883.2500
56/56 [==============================] - 0s 619us/step - loss: 576922.5000
Epoch 347/500

 1/56 [..............................] - ETA: 0s - loss: 363502.7500
56/56 [==============================] - 0s 624us/step - loss: 588568.5625
Epoch 348/500

 1/56 [..............................] - ETA: 0s - loss: 291587.0938
56/56 [==============================] - 0s 607us/step - loss: 551187.7500
Epoch 349/500

 1/56 [..............................] - ETA: 0s - loss: 480448.1562
56/56 [==============================] - 0s 587us/step - loss: 494121.4375
Epoch 350/500

 1/56 [..............................] - ETA: 0s - loss: 374380.9375
56/56 [==============================] - 0s 555us/step - loss: 466268.5000
Epoch 351/500

 1/56 [..............................] - ETA: 0s - loss: 329584.3125
56/56 [==============================] - 0s 555us/step - loss: 478501.6250
Epoch 352/500

 1/56 [..............................] - ETA: 0s - loss: 191435.7656
56/56 [==============================] - 0s 549us/step - loss: 455896.9688
Epoch 353/500

 1/56 [..............................] - ETA: 0s - loss: 217823.7812
56/56 [==============================] - 0s 550us/step - loss: 466387.6562
Epoch 354/500

 1/56 [..............................] - ETA: 0s - loss: 370026.1250
56/56 [==============================] - 0s 551us/step - loss: 437632.2500
Epoch 355/500

 1/56 [..............................] - ETA: 0s - loss: 379347.8750
56/56 [==============================] - 0s 553us/step - loss: 437840.7500
Epoch 356/500

 1/56 [..............................] - ETA: 0s - loss: 224131.8906
56/56 [==============================] - 0s 555us/step - loss: 426922.3438
Epoch 357/500

 1/56 [..............................] - ETA: 0s - loss: 219643.3281
56/56 [==============================] - 0s 554us/step - loss: 451077.7500
Epoch 358/500

 1/56 [..............................] - ETA: 0s - loss: 340091.0625
56/56 [==============================] - 0s 553us/step - loss: 432764.6875
Epoch 359/500

 1/56 [..............................] - ETA: 0s - loss: 320376.1250
56/56 [==============================] - 0s 575us/step - loss: 430910.8438
Epoch 360/500

 1/56 [..............................] - ETA: 0s - loss: 322777.0625
56/56 [==============================] - 0s 556us/step - loss: 449849.6875
Epoch 361/500

 1/56 [..............................] - ETA: 0s - loss: 537679.8750
56/56 [==============================] - 0s 558us/step - loss: 459061.5938
Epoch 362/500

 1/56 [..............................] - ETA: 0s - loss: 634680.0000
56/56 [==============================] - 0s 555us/step - loss: 463385.5938
Epoch 363/500

 1/56 [..............................] - ETA: 0s - loss: 287950.6250
56/56 [==============================] - 0s 550us/step - loss: 419426.4062
Epoch 364/500

 1/56 [..............................] - ETA: 0s - loss: 125518.1250
56/56 [==============================] - 0s 558us/step - loss: 460920.2500
Epoch 365/500

 1/56 [..............................] - ETA: 0s - loss: 183093.7344
56/56 [==============================] - 0s 555us/step - loss: 483138.5000
Epoch 366/500

 1/56 [..............................] - ETA: 0s - loss: 336736.6562
56/56 [==============================] - 0s 593us/step - loss: 439422.9062
Epoch 367/500

 1/56 [..............................] - ETA: 0s - loss: 337322.8438
56/56 [==============================] - 0s 611us/step - loss: 451309.4688
Epoch 368/500

 1/56 [..............................] - ETA: 0s - loss: 475485.0312
56/56 [==============================] - 0s 621us/step - loss: 509160.1250
Epoch 369/500

 1/56 [..............................] - ETA: 0s - loss: 219672.7188
56/56 [==============================] - 0s 599us/step - loss: 566950.1250
Epoch 370/500

 1/56 [..............................] - ETA: 0s - loss: 439293.4688
56/56 [==============================] - 0s 596us/step - loss: 416188.2812
Epoch 371/500

 1/56 [..............................] - ETA: 0s - loss: 203913.1406
56/56 [==============================] - 0s 580us/step - loss: 453161.1875
Epoch 372/500

 1/56 [..............................] - ETA: 0s - loss: 639634.3750
56/56 [==============================] - 0s 572us/step - loss: 397336.1562
Epoch 373/500

 1/56 [..............................] - ETA: 0s - loss: 487503.6875
56/56 [==============================] - 0s 577us/step - loss: 395503.3750
Epoch 374/500

 1/56 [..............................] - ETA: 0s - loss: 125254.3125
56/56 [==============================] - 0s 586us/step - loss: 446071.0312
Epoch 375/500

 1/56 [..............................] - ETA: 0s - loss: 294640.6875
56/56 [==============================] - 0s 564us/step - loss: 388634.7188
Epoch 376/500

 1/56 [..............................] - ETA: 0s - loss: 318548.8125
56/56 [==============================] - 0s 597us/step - loss: 383100.6562
Epoch 377/500

 1/56 [..............................] - ETA: 0s - loss: 188563.2188
56/56 [==============================] - 0s 588us/step - loss: 381981.6875
Epoch 378/500

 1/56 [..............................] - ETA: 0s - loss: 417701.9688
56/56 [==============================] - 0s 572us/step - loss: 379030.7188
Epoch 379/500

 1/56 [..............................] - ETA: 0s - loss: 1059943.2500
56/56 [==============================] - 0s 566us/step - loss: 380447.2500
Epoch 380/500

 1/56 [..............................] - ETA: 0s - loss: 286873.9688
56/56 [==============================] - 0s 561us/step - loss: 399570.1250
Epoch 381/500

 1/56 [..............................] - ETA: 0s - loss: 320451.3438
56/56 [==============================] - 0s 558us/step - loss: 455988.5938
Epoch 382/500

 1/56 [..............................] - ETA: 0s - loss: 46142.7812
56/56 [==============================] - 0s 547us/step - loss: 375336.9688
Epoch 383/500

 1/56 [..............................] - ETA: 0s - loss: 622349.0625
56/56 [==============================] - 0s 550us/step - loss: 393235.9688
Epoch 384/500

 1/56 [..............................] - ETA: 0s - loss: 180917.1875
56/56 [==============================] - 0s 568us/step - loss: 373855.0938
Epoch 385/500

 1/56 [..............................] - ETA: 0s - loss: 115907.1875
56/56 [==============================] - 0s 571us/step - loss: 381171.0000
Epoch 386/500

 1/56 [..............................] - ETA: 0s - loss: 421601.0625
56/56 [==============================] - 0s 581us/step - loss: 371695.1562
Epoch 387/500

 1/56 [..............................] - ETA: 0s - loss: 189164.8281
56/56 [==============================] - 0s 566us/step - loss: 373228.0938
Epoch 388/500

 1/56 [..............................] - ETA: 0s - loss: 396586.0312
56/56 [==============================] - 0s 562us/step - loss: 373081.5625
Epoch 389/500

 1/56 [..............................] - ETA: 0s - loss: 684667.0000
56/56 [==============================] - 0s 557us/step - loss: 420351.9688
Epoch 390/500

 1/56 [..............................] - ETA: 0s - loss: 176898.7344
56/56 [==============================] - 0s 554us/step - loss: 373483.1250
Epoch 391/500

 1/56 [..............................] - ETA: 0s - loss: 102097.5703
56/56 [==============================] - 0s 564us/step - loss: 380491.0938
Epoch 392/500

 1/56 [..............................] - ETA: 0s - loss: 360411.5000
56/56 [==============================] - 0s 580us/step - loss: 369369.1250
Epoch 393/500

 1/56 [..............................] - ETA: 0s - loss: 215215.7500
56/56 [==============================] - 0s 563us/step - loss: 368702.7500
Epoch 394/500

 1/56 [..............................] - ETA: 0s - loss: 351848.5625
56/56 [==============================] - 0s 564us/step - loss: 368915.0312
Epoch 395/500

 1/56 [..............................] - ETA: 0s - loss: 156979.1719
56/56 [==============================] - 0s 612us/step - loss: 372239.9062
Epoch 396/500

 1/56 [..............................] - ETA: 0s - loss: 170359.3125
56/56 [==============================] - 0s 601us/step - loss: 388974.4375
Epoch 397/500

 1/56 [..............................] - ETA: 0s - loss: 194037.2188
56/56 [==============================] - 0s 594us/step - loss: 367643.7812
Epoch 398/500

 1/56 [..............................] - ETA: 0s - loss: 267098.6875
56/56 [==============================] - 0s 564us/step - loss: 367088.9375
Epoch 399/500

 1/56 [..............................] - ETA: 0s - loss: 441597.9062
56/56 [==============================] - 0s 568us/step - loss: 386436.4688
Epoch 400/500

 1/56 [..............................] - ETA: 0s - loss: 573352.1250
56/56 [==============================] - 0s 558us/step - loss: 364547.4062
Epoch 401/500

 1/56 [..............................] - ETA: 0s - loss: 315206.5625
56/56 [==============================] - 0s 560us/step - loss: 364328.5312
Epoch 402/500

 1/56 [..............................] - ETA: 0s - loss: 327021.3125
56/56 [==============================] - 0s 563us/step - loss: 457626.1250
Epoch 403/500

 1/56 [..............................] - ETA: 0s - loss: 1277952.0000
56/56 [==============================] - 0s 562us/step - loss: 365210.9375
Epoch 404/500

 1/56 [..............................] - ETA: 0s - loss: 339489.6250
56/56 [==============================] - 0s 567us/step - loss: 363301.4062
Epoch 405/500

 1/56 [..............................] - ETA: 0s - loss: 175130.1250
56/56 [==============================] - 0s 579us/step - loss: 365115.6562
Epoch 406/500

 1/56 [..............................] - ETA: 0s - loss: 456738.8750
56/56 [==============================] - 0s 571us/step - loss: 361143.6562
Epoch 407/500

 1/56 [..............................] - ETA: 0s - loss: 235170.3750
56/56 [==============================] - 0s 577us/step - loss: 376707.0938
Epoch 408/500

 1/56 [..............................] - ETA: 0s - loss: 208388.9375
56/56 [==============================] - 0s 565us/step - loss: 560246.5000
Epoch 409/500

 1/56 [..............................] - ETA: 0s - loss: 748758.4375
56/56 [==============================] - 0s 552us/step - loss: 461161.8750
Epoch 410/500

 1/56 [..............................] - ETA: 0s - loss: 160527.2500
56/56 [==============================] - 0s 555us/step - loss: 450528.6875
Epoch 411/500

 1/56 [..............................] - ETA: 0s - loss: 450134.6250
56/56 [==============================] - 0s 563us/step - loss: 390434.3438
Epoch 412/500

 1/56 [..............................] - ETA: 0s - loss: 664143.0000
56/56 [==============================] - 0s 554us/step - loss: 392503.5625
Epoch 413/500

 1/56 [..............................] - ETA: 0s - loss: 523660.1875
56/56 [==============================] - 0s 583us/step - loss: 362610.6875
Epoch 414/500

 1/56 [..............................] - ETA: 0s - loss: 220439.0781
56/56 [==============================] - 0s 567us/step - loss: 363471.1250
Epoch 415/500

 1/56 [..............................] - ETA: 0s - loss: 300042.6875
56/56 [==============================] - 0s 572us/step - loss: 368112.9375
Epoch 416/500

 1/56 [..............................] - ETA: 0s - loss: 295067.5000
56/56 [==============================] - 0s 569us/step - loss: 624936.6250
Epoch 417/500

 1/56 [..............................] - ETA: 0s - loss: 197508.6094
56/56 [==============================] - 0s 566us/step - loss: 745406.1875
Epoch 418/500

 1/56 [..............................] - ETA: 0s - loss: 219395.1094
56/56 [==============================] - 0s 563us/step - loss: 552254.6250
Epoch 419/500

 1/56 [..............................] - ETA: 0s - loss: 329275.9062
56/56 [==============================] - 0s 565us/step - loss: 570303.4375
Epoch 420/500

 1/56 [..............................] - ETA: 0s - loss: 148827.4062
56/56 [==============================] - 0s 565us/step - loss: 776425.3750
Epoch 421/500

 1/56 [..............................] - ETA: 0s - loss: 216193.1562
56/56 [==============================] - 0s 570us/step - loss: 439486.3125
Epoch 422/500

 1/56 [..............................] - ETA: 0s - loss: 616333.7500
56/56 [==============================] - 0s 580us/step - loss: 1666725.7500
Epoch 423/500

 1/56 [..............................] - ETA: 0s - loss: 629126.1875
56/56 [==============================] - 0s 599us/step - loss: 787267.6250
Epoch 424/500

 1/56 [..............................] - ETA: 0s - loss: 266047.1875
56/56 [==============================] - 0s 580us/step - loss: 752031.1250
Epoch 425/500

 1/56 [..............................] - ETA: 0s - loss: 1299873.7500
56/56 [==============================] - 0s 567us/step - loss: 749754.1250
Epoch 426/500

 1/56 [..............................] - ETA: 0s - loss: 834147.2500
56/56 [==============================] - 0s 567us/step - loss: 755119.1875
Epoch 427/500

 1/56 [..............................] - ETA: 0s - loss: 560394.8750
56/56 [==============================] - 0s 566us/step - loss: 616768.5000
Epoch 428/500

 1/56 [..............................] - ETA: 0s - loss: 821852.6875
56/56 [==============================] - 0s 567us/step - loss: 615000.1250
Epoch 429/500

 1/56 [..............................] - ETA: 0s - loss: 570113.6250
56/56 [==============================] - 0s 568us/step - loss: 622224.6875
Epoch 430/500

 1/56 [..............................] - ETA: 0s - loss: 239072.6250
56/56 [==============================] - 0s 571us/step - loss: 659863.2500
Epoch 431/500

 1/56 [..............................] - ETA: 0s - loss: 259186.8750
56/56 [==============================] - 0s 570us/step - loss: 823670.3125
Epoch 432/500

 1/56 [..............................] - ETA: 0s - loss: 281256.6875
56/56 [==============================] - 0s 598us/step - loss: 644256.7500
Epoch 433/500

 1/56 [..............................] - ETA: 0s - loss: 198218.1562
56/56 [==============================] - 0s 583us/step - loss: 415539.9062
Epoch 434/500

 1/56 [..............................] - ETA: 0s - loss: 81583.7969
56/56 [==============================] - 0s 569us/step - loss: 382841.7188
Epoch 435/500

 1/56 [..............................] - ETA: 0s - loss: 438989.8750
56/56 [==============================] - 0s 566us/step - loss: 371863.9375
Epoch 436/500

 1/56 [..............................] - ETA: 0s - loss: 395321.2500
56/56 [==============================] - 0s 560us/step - loss: 369982.9375
Epoch 437/500

 1/56 [..............................] - ETA: 0s - loss: 124806.2344
56/56 [==============================] - 0s 572us/step - loss: 370407.6562
Epoch 438/500

 1/56 [..............................] - ETA: 0s - loss: 345424.6562
56/56 [==============================] - 0s 571us/step - loss: 368481.1250
Epoch 439/500

 1/56 [..............................] - ETA: 0s - loss: 648203.5625
56/56 [==============================] - 0s 567us/step - loss: 367612.0312
Epoch 440/500

 1/56 [..............................] - ETA: 0s - loss: 199216.1094
56/56 [==============================] - 0s 565us/step - loss: 369767.9375
Epoch 441/500

 1/56 [..............................] - ETA: 0s - loss: 368821.1875
56/56 [==============================] - 0s 586us/step - loss: 363489.3750
Epoch 442/500

 1/56 [..............................] - ETA: 0s - loss: 324175.7812
56/56 [==============================] - 0s 580us/step - loss: 362478.1250
Epoch 443/500

 1/56 [..............................] - ETA: 0s - loss: 405975.2188
56/56 [==============================] - 0s 565us/step - loss: 360341.5000
Epoch 444/500

 1/56 [..............................] - ETA: 0s - loss: 216818.9375
56/56 [==============================] - 0s 565us/step - loss: 363438.0938
Epoch 445/500

 1/56 [..............................] - ETA: 0s - loss: 268257.5625
56/56 [==============================] - 0s 565us/step - loss: 359593.6875
Epoch 446/500

 1/56 [..............................] - ETA: 0s - loss: 158601.9062
56/56 [==============================] - 0s 569us/step - loss: 359518.4375
Epoch 447/500

 1/56 [..............................] - ETA: 0s - loss: 285616.5625
56/56 [==============================] - 0s 569us/step - loss: 360907.0312
Epoch 448/500

 1/56 [..............................] - ETA: 0s - loss: 176254.5156
56/56 [==============================] - 0s 570us/step - loss: 359059.6562
Epoch 449/500

 1/56 [..............................] - ETA: 0s - loss: 146007.4375
56/56 [==============================] - 0s 570us/step - loss: 356954.1875
Epoch 450/500

 1/56 [..............................] - ETA: 0s - loss: 262867.3438
56/56 [==============================] - 0s 589us/step - loss: 357007.3750
Epoch 451/500

 1/56 [..............................] - ETA: 0s - loss: 1178634.5000
56/56 [==============================] - 0s 586us/step - loss: 355162.9062
Epoch 452/500

 1/56 [..............................] - ETA: 0s - loss: 225047.5781
56/56 [==============================] - 0s 596us/step - loss: 353453.0000
Epoch 453/500

 1/56 [..............................] - ETA: 0s - loss: 142584.4062
56/56 [==============================] - 0s 563us/step - loss: 352323.6875
Epoch 454/500

 1/56 [..............................] - ETA: 0s - loss: 125904.7188
56/56 [==============================] - 0s 560us/step - loss: 348907.5000
Epoch 455/500

 1/56 [..............................] - ETA: 0s - loss: 149663.2969
56/56 [==============================] - 0s 561us/step - loss: 350494.8438
Epoch 456/500

 1/56 [..............................] - ETA: 0s - loss: 192344.3906
56/56 [==============================] - 0s 612us/step - loss: 353752.9688
Epoch 457/500

 1/56 [..............................] - ETA: 0s - loss: 142610.2812
56/56 [==============================] - 0s 595us/step - loss: 348306.5312
Epoch 458/500

 1/56 [..............................] - ETA: 0s - loss: 152173.8438
56/56 [==============================] - 0s 616us/step - loss: 347069.0625
Epoch 459/500

 1/56 [..............................] - ETA: 0s - loss: 182753.9375
56/56 [==============================] - 0s 666us/step - loss: 347234.1250
Epoch 460/500

 1/56 [..............................] - ETA: 0s - loss: 488326.3438
56/56 [==============================] - 0s 619us/step - loss: 350646.8750
Epoch 461/500

 1/56 [..............................] - ETA: 0s - loss: 198105.9375
56/56 [==============================] - 0s 573us/step - loss: 350245.5938
Epoch 462/500

 1/56 [..............................] - ETA: 0s - loss: 159480.7031
56/56 [==============================] - 0s 577us/step - loss: 347744.0312
Epoch 463/500

 1/56 [..............................] - ETA: 0s - loss: 379937.6875
56/56 [==============================] - 0s 568us/step - loss: 398191.7812
Epoch 464/500

 1/56 [..............................] - ETA: 0s - loss: 268689.4688
56/56 [==============================] - 0s 575us/step - loss: 347447.4375
Epoch 465/500

 1/56 [..............................] - ETA: 0s - loss: 365401.4375
56/56 [==============================] - 0s 581us/step - loss: 345795.0000
Epoch 466/500

 1/56 [..............................] - ETA: 0s - loss: 222574.3125
56/56 [==============================] - 0s 581us/step - loss: 349332.5938
Epoch 467/500

 1/56 [..............................] - ETA: 0s - loss: 216265.1875
56/56 [==============================] - 0s 597us/step - loss: 345362.8125
Epoch 468/500

 1/56 [..............................] - ETA: 0s - loss: 309537.8125
56/56 [==============================] - 0s 596us/step - loss: 352426.0312
Epoch 469/500

 1/56 [..............................] - ETA: 0s - loss: 405202.2812
56/56 [==============================] - 0s 573us/step - loss: 348765.0000
Epoch 470/500

 1/56 [..............................] - ETA: 0s - loss: 819131.8125
56/56 [==============================] - 0s 571us/step - loss: 347332.6562
Epoch 471/500

 1/56 [..............................] - ETA: 0s - loss: 162626.4531
56/56 [==============================] - 0s 568us/step - loss: 350933.9688
Epoch 472/500

 1/56 [..............................] - ETA: 0s - loss: 863868.5000
56/56 [==============================] - 0s 568us/step - loss: 353851.6875
Epoch 473/500

 1/56 [..............................] - ETA: 0s - loss: 310002.8750
56/56 [==============================] - 0s 571us/step - loss: 346881.5312
Epoch 474/500

 1/56 [..............................] - ETA: 0s - loss: 95871.2812
56/56 [==============================] - 0s 568us/step - loss: 345503.6250
Epoch 475/500

 1/56 [..............................] - ETA: 0s - loss: 197174.5625
56/56 [==============================] - 0s 570us/step - loss: 344124.6875
Epoch 476/500

 1/56 [..............................] - ETA: 0s - loss: 446515.5625
56/56 [==============================] - 0s 579us/step - loss: 354124.0938
Epoch 477/500

 1/56 [..............................] - ETA: 0s - loss: 248134.6250
56/56 [==============================] - 0s 596us/step - loss: 344715.8750
Epoch 478/500

 1/56 [..............................] - ETA: 0s - loss: 241894.1719
56/56 [==============================] - 0s 593us/step - loss: 354608.2812
Epoch 479/500

 1/56 [..............................] - ETA: 0s - loss: 412811.7812
56/56 [==============================] - 0s 632us/step - loss: 347861.5938
Epoch 480/500

 1/56 [..............................] - ETA: 0s - loss: 96195.0547
56/56 [==============================] - 0s 870us/step - loss: 343396.1562
Epoch 481/500

 1/56 [..............................] - ETA: 0s - loss: 143530.8594
56/56 [==============================] - 0s 854us/step - loss: 348315.5000
Epoch 482/500

 1/56 [..............................] - ETA: 0s - loss: 200921.0938
56/56 [==============================] - 0s 642us/step - loss: 353728.2188
Epoch 483/500

 1/56 [..............................] - ETA: 0s - loss: 287221.0312
56/56 [==============================] - 0s 584us/step - loss: 362034.8750
Epoch 484/500

 1/56 [..............................] - ETA: 0s - loss: 387841.0625
56/56 [==============================] - 0s 617us/step - loss: 531690.2500
Epoch 485/500

 1/56 [..............................] - ETA: 0s - loss: 290104.4375
56/56 [==============================] - 0s 604us/step - loss: 379085.0312
Epoch 486/500

 1/56 [..............................] - ETA: 0s - loss: 167653.6250
56/56 [==============================] - 0s 584us/step - loss: 351281.8750
Epoch 487/500

 1/56 [..............................] - ETA: 0s - loss: 270166.1875
56/56 [==============================] - 0s 591us/step - loss: 351198.6250
Epoch 488/500

 1/56 [..............................] - ETA: 0s - loss: 233485.8906
56/56 [==============================] - 0s 594us/step - loss: 345678.6250
Epoch 489/500

 1/56 [..............................] - ETA: 0s - loss: 213426.9688
56/56 [==============================] - 0s 587us/step - loss: 345801.1250
Epoch 490/500

 1/56 [..............................] - ETA: 0s - loss: 3799957.5000
56/56 [==============================] - 0s 587us/step - loss: 344744.6562
Epoch 491/500

 1/56 [..............................] - ETA: 0s - loss: 137330.1094
56/56 [==============================] - 0s 590us/step - loss: 344295.8750
Epoch 492/500

 1/56 [..............................] - ETA: 0s - loss: 210264.8750
56/56 [==============================] - 0s 580us/step - loss: 344646.8750
Epoch 493/500

 1/56 [..............................] - ETA: 0s - loss: 724233.1250
56/56 [==============================] - 0s 562us/step - loss: 386915.3125
Epoch 494/500

 1/56 [..............................] - ETA: 0s - loss: 248162.2344
56/56 [==============================] - 0s 601us/step - loss: 355857.9062
Epoch 495/500

 1/56 [..............................] - ETA: 0s - loss: 1255122.3750
56/56 [==============================] - 0s 614us/step - loss: 356257.2500
Epoch 496/500

 1/56 [..............................] - ETA: 0s - loss: 252195.3281
56/56 [==============================] - 0s 582us/step - loss: 348878.6875
Epoch 497/500

 1/56 [..............................] - ETA: 0s - loss: 400723.8125
56/56 [==============================] - 0s 548us/step - loss: 350565.5938
Epoch 498/500

 1/56 [..............................] - ETA: 0s - loss: 189847.1250
56/56 [==============================] - 0s 554us/step - loss: 341556.8750
Epoch 499/500

 1/56 [..............................] - ETA: 0s - loss: 405092.8438
56/56 [==============================] - 0s 554us/step - loss: 411065.9062
Epoch 500/500

 1/56 [..............................] - ETA: 0s - loss: 329094.5625
56/56 [==============================] - 0s 552us/step - loss: 353472.9062</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(test)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#8. Model Evaluation</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ผู้วิเคราะห์ยังสามารถเรียกดู performance metric ของโมเดลได้โดยใช้ method `evaluate()` ดังตัวอย่างต่อไปนี้</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> model.evaluate(test, test_out)</span></code></pre></div>
<pre><code>
 1/14 [=&gt;............................] - ETA: 0s - loss: 417766.7500
14/14 [==============================] - 0s 555us/step - loss: 331417.9062</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>math.sqrt(mse) <span class="co">#RMSE</span></span></code></pre></div>
<pre><code>575.6890708099295</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(pred, test_out)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="DL2_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;loss&#39;</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;model loss&#39;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;loss&#39;</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;epoch&#39;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="DL2_files/figure-html/unnamed-chunk-9-2.png" width="768" /></p>
</div>
</div>
<div id="classification-example" class="section level2">
<h2>Classification example</h2>
<p>```</p>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2013.44.05.png" style="width:40.0%" /></left></p>
</div>
</div>

   
   
           </section>
  </div>
  </div>
  </div>
  </div>
      
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
