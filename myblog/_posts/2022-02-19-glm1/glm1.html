<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>GLM1</title>

  <meta property="description" itemprop="description" content="General Linear Modeling"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-02-19"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-02-19"/>
  <meta name="article:author" content="Siwachoat Srisuttiyakorn"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="GLM1"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="General Linear Modeling"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="GLM1"/>
  <meta property="twitter:description" content="General Linear Modeling"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","categories","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["GLM1"]},{"type":"character","attributes":{},"value":["Bayesian Statistics","BGLM"]},{"type":"character","attributes":{},"value":["General Linear Modeling\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Siwachoat Srisuttiyakorn"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2022-02-19"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["ancova.sav","bnova.png","glm1_files/anchor-4.2.2/anchor.min.js","glm1_files/bowser-1.9.3/bowser.min.js","glm1_files/distill-2.2.21/template.v2.js","glm1_files/figure-html5/unnamed-chunk-10-1.png","glm1_files/figure-html5/unnamed-chunk-10-2.png","glm1_files/figure-html5/unnamed-chunk-11-1.png","glm1_files/figure-html5/unnamed-chunk-12-1.png","glm1_files/figure-html5/unnamed-chunk-13-1.png","glm1_files/figure-html5/unnamed-chunk-15-1.png","glm1_files/figure-html5/unnamed-chunk-15-10.png","glm1_files/figure-html5/unnamed-chunk-15-2.png","glm1_files/figure-html5/unnamed-chunk-15-3.png","glm1_files/figure-html5/unnamed-chunk-15-4.png","glm1_files/figure-html5/unnamed-chunk-15-5.png","glm1_files/figure-html5/unnamed-chunk-15-6.png","glm1_files/figure-html5/unnamed-chunk-15-7.png","glm1_files/figure-html5/unnamed-chunk-15-8.png","glm1_files/figure-html5/unnamed-chunk-15-9.png","glm1_files/figure-html5/unnamed-chunk-16-1.png","glm1_files/figure-html5/unnamed-chunk-16-2.png","glm1_files/figure-html5/unnamed-chunk-17-1.png","glm1_files/figure-html5/unnamed-chunk-17-2.png","glm1_files/figure-html5/unnamed-chunk-18-1.png","glm1_files/figure-html5/unnamed-chunk-18-2.png","glm1_files/figure-html5/unnamed-chunk-19-1.png","glm1_files/figure-html5/unnamed-chunk-2-1.png","glm1_files/figure-html5/unnamed-chunk-20-1.png","glm1_files/figure-html5/unnamed-chunk-21-1.png","glm1_files/figure-html5/unnamed-chunk-24-1.png","glm1_files/figure-html5/unnamed-chunk-25-1.png","glm1_files/figure-html5/unnamed-chunk-27-1.png","glm1_files/figure-html5/unnamed-chunk-27-2.png","glm1_files/figure-html5/unnamed-chunk-28-1.png","glm1_files/figure-html5/unnamed-chunk-29-1.png","glm1_files/figure-html5/unnamed-chunk-30-1.png","glm1_files/figure-html5/unnamed-chunk-31-1.png","glm1_files/figure-html5/unnamed-chunk-31-2.png","glm1_files/figure-html5/unnamed-chunk-32-1.png","glm1_files/figure-html5/unnamed-chunk-34-1.png","glm1_files/figure-html5/unnamed-chunk-35-1.png","glm1_files/figure-html5/unnamed-chunk-36-1.png","glm1_files/figure-html5/unnamed-chunk-37-1.png","glm1_files/figure-html5/unnamed-chunk-38-1.png","glm1_files/figure-html5/unnamed-chunk-39-1.png","glm1_files/figure-html5/unnamed-chunk-4-1.png","glm1_files/figure-html5/unnamed-chunk-40-1.png","glm1_files/figure-html5/unnamed-chunk-41-1.png","glm1_files/figure-html5/unnamed-chunk-42-1.png","glm1_files/figure-html5/unnamed-chunk-44-1.png","glm1_files/figure-html5/unnamed-chunk-45-1.png","glm1_files/figure-html5/unnamed-chunk-48-1.png","glm1_files/figure-html5/unnamed-chunk-49-1.png","glm1_files/figure-html5/unnamed-chunk-5-1.png","glm1_files/figure-html5/unnamed-chunk-53-1.png","glm1_files/figure-html5/unnamed-chunk-57-1.png","glm1_files/figure-html5/unnamed-chunk-57-2.png","glm1_files/figure-html5/unnamed-chunk-57-3.png","glm1_files/figure-html5/unnamed-chunk-57-4.png","glm1_files/figure-html5/unnamed-chunk-58-1.png","glm1_files/figure-html5/unnamed-chunk-58-2.png","glm1_files/figure-html5/unnamed-chunk-58-3.png","glm1_files/figure-html5/unnamed-chunk-58-4.png","glm1_files/figure-html5/unnamed-chunk-6-1.png","glm1_files/figure-html5/unnamed-chunk-9-1.png","glm1_files/figure-html5/unnamed-chunk-9-2.png","glm1_files/figure-html5/unnamed-chunk-9-3.png","glm1_files/figure-html5/unnamed-chunk-9-4.png","glm1_files/figure-html5/unnamed-chunk-9-5.png","glm1_files/header-attrs-2.11/header-attrs.js","glm1_files/jquery-3.6.0/jquery-3.6.0.js","glm1_files/jquery-3.6.0/jquery-3.6.0.min.js","glm1_files/jquery-3.6.0/jquery-3.6.0.min.map","glm1_files/kePrint-0.0.1/kePrint.js","glm1_files/lightable-0.0.1/lightable.css","glm1_files/popper-2.6.0/popper.min.js","glm1_files/tippy-6.2.7/tippy-bundle.umd.min.js","glm1_files/tippy-6.2.7/tippy-light-border.css","glm1_files/tippy-6.2.7/tippy.css","glm1_files/tippy-6.2.7/tippy.umd.min.js","glm1_files/webcomponents-2.0.0/webcomponents.js","manova.sav","MCMCtrace.pdf","model1.png","model2.png","onesample_conflic.txt","regression_dat1.csv","Screen Shot 2565-02-26 at 06.59.01.png","Screen Shot 2565-02-26 at 09.37.07.png","Screen Shot 2565-03-04 at 07.31.45.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="glm1_files/header-attrs-2.11/header-attrs.js"></script>
  <script src="glm1_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="glm1_files/popper-2.6.0/popper.min.js"></script>
  <link href="glm1_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="glm1_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="glm1_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="glm1_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="glm1_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="glm1_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="glm1_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"GLM1","description":"General Linear Modeling","authors":[{"author":"Siwachoat Srisuttiyakorn","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-02-19T00:00:00.000+07:00","citationText":"Srisuttiyakorn, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>GLM1</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Bayesian Statistics</div>
<div class="dt=tag">BGLM</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>General Linear Modeling</p></p>
</div>

<div class="d-byline">
  Siwachoat Srisuttiyakorn true 
  
<br/>2022-02-19
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#bayesian-alternative-to-t-test">Bayesian alternative to t-test</a>
<ul>
<li><a href="#traditional-t-test">Traditional t-test</a></li>
<li><a href="#bayesian-approach-1-normal-model">Bayesian approach 1: normal model</a></li>
<li><a href="#bayesian-approach-2-generalized-students-t-model">Bayesian approach 2: generalized student’s t model</a></li>
<li><a href="#bayesian-approach-3-log-normal-model">Bayesian approach 3: log-normal model</a></li>
<li><a href="#สรป">สรุป</a></li>
</ul></li>
<li><a href="#bayesian-alternative-to-anova-banova">Bayesian alternative to ANOVA (BANOVA)</a>
<ul>
<li><a href="#one-way-banova">One-Way BANOVA</a></li>
<li><a href="#multiple-comparison">Multiple Comparison</a></li>
<li><a href="#two-way-banova">Two-Way BANOVA</a></li>
<li><a href="#banova-package">BANOVA package</a></li>
</ul></li>
<li><a href="#bayesian-regression">Bayesian Regression</a>
<ul>
<li><a href="#exploring-data">Exploring data</a></li>
</ul></li>
<li><a href="#model-checking-and-comparison">Model Checking and Comparison</a>
<ul>
<li><a href="#residuals">Residuals</a></li>
<li><a href="#posterior-predictive-check">Posterior Predictive Check</a></li>
<li><a href="#posterior-predictive-p-value-ppp">Posterior Predictive P-value (PPP)</a></li>
<li><a href="#deviance">Deviance</a></li>
<li><a href="#deviance-information-criterion-dic">Deviance Information Criterion (DIC)</a></li>
<li><a href="#waic-and-loo">WAIC and LOO</a></li>
<li><a href="#สรป-1">สรุป</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="bayesian-alternative-to-t-test">Bayesian alternative to t-test</h1>
<p>กิจกรรมนี้จะกล่าวถึงการใช้สถิติแบบเบส์สำหรับการวิเคราะห์เพื่อเปรียบเทียบค่าเฉลี่ยสองกลุ่ม ผู้อ่านจะเห็นว่าการวิเคราะห์แบบเบส์เป็นวิธีการที่ให้สารสนเทศเกี่ยวกับความแตกต่างของค่าเฉลี่ยระหว่างตัวอย่างสองกลุ่มที่มากกว่าการทดสอบ t-test แบบดั้งเดิม</p>
<p>การเปรียบเทียบด้วยวิธีการแบบเบส์ทำให้ผู้วิเคราะห์สามารถประมาณการแจกแจงความน่าจะเป็นภายหลัง ซึ่งเป็นข้อมูลสำคัญสำหรับการคำนวณช่วงความน่าเชื่อถือ (credible intervals) ของพารามิเตอร์ต่าง ๆ ได้แก่ ค่าเฉลี่ย ส่วนเบี่ยงเบนมาตรฐาน รวมทั้งความแตกต่างระหว่างค่าเฉลี่ย ส่วนเบี่ยงเบนมาตรฐาน และขนาดอิทธิพล</p>
<p>ผลการทดสอบเพื่อเปรียบเทียบความแตกต่างของค่าเฉลี่ยสามารถตัดสินใจได้ทั้ง การยอมรับสมมุติฐานหลัก (accept null hypothesis) และยอมรับสมมุติฐานทางเลือก (accept alternative hypothesis) ซึ่งแตกต่างและมีความยืดหยุ่นมากกว่าการทดสอบเพื่อเปรียบเทียบค่าเฉลี่ยแบบดั้งเดิมอย่างมาก</p>
<h2 id="traditional-t-test">Traditional t-test</h2>
<p>สมมุติว่านักวิจัยต้องการเปรียบเทียบความแตกต่างของผลสัมฤทธิ์ทางการเรียนวิชาคณิตศาสตร์ และทักษะการแก้ปัญหา ระหว่างนักเรียนที่ได้รับการสอนแบบบรรยาย และแบบใช้ปัญหาเป็นฐาน ข้อมูลค่าสังเกตเป็นดังนี้</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1253</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Ach<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>48</span>,<span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,
                Solve<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>rt</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>5</span><span class='op'>+</span><span class='fl'>50</span>,<span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>rt</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10</span><span class='op'>+</span><span class='fl'>70</span><span class='op'>)</span>,
                Method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>50</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       Ach    Solve Method
1 57.88928 50.01438      1
2 51.20072 49.48460      1
3 43.34361 43.94092      1
4 55.12593 48.40898      1
5 45.35700 50.11348      1
6 53.47266 56.45850      1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         Ach    Solve Method
95  57.27558 59.71888      2
96  55.89447 71.65605      2
97  54.42124 66.07296      2
98  50.62769 70.03023      2
99  44.82859 79.04969      2
100 46.05098 99.74767      2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>      Ach            Solve            Method   
 Min.   :20.93   Min.   : 28.48   Min.   :1.0  
 1st Qu.:43.60   1st Qu.: 49.28   1st Qu.:1.0  
 Median :49.68   Median : 57.62   Median :1.5  
 Mean   :49.06   Mean   : 60.96   Mean   :1.5  
 3rd Qu.:55.05   3rd Qu.: 70.84   3rd Qu.:2.0  
 Max.   :80.01   Max.   :117.62   Max.   :2.0  </code></pre>
</div>
<p>โดยที่ <code>Ach</code> และ <code>Solve</code> คือผลสัมฤทธ์และทักษะการแก้ปัญหาตามลำดับ ส่วน <code>TMethod = 1</code> คือกลุ่มนักเรียนที่ได้รับการสอนแบบบรรยาย และ <code>TMethod = 2</code> คือกลุ่มนักเรียนที่ได้รับการสอนแบบใช้ปัญหาเป็นฐาน</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span><span class='op'>]</span><span class='op'>)</span>,type<span class='op'>=</span><span class='st'>"l"</span>, main<span class='op'>=</span><span class='st'>"Ach"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>100</span><span class='op'>)</span>, lty<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span><span class='op'>[</span><span class='fl'>51</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>]</span><span class='op'>)</span>,type<span class='op'>=</span><span class='st'>"l"</span>, main<span class='op'>=</span><span class='st'>""</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.06</span>, legend<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LEC"</span>,<span class='st'>"PBL"</span><span class='op'>)</span>,lty<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, bty<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Solve</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span><span class='op'>]</span><span class='op'>)</span>,type<span class='op'>=</span><span class='st'>"l"</span>, main<span class='op'>=</span><span class='st'>"Solve"</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>100</span><span class='op'>)</span>, lty<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Solve</span><span class='op'>[</span><span class='fl'>51</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>]</span><span class='op'>)</span>,type<span class='op'>=</span><span class='st'>"l"</span>, main<span class='op'>=</span><span class='st'>""</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.04</span>, legend<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LEC"</span>,<span class='st'>"PBL"</span><span class='op'>)</span>,lty<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, bty<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-2-1.png" width="864" /></p>
</div>
<p>หากทำการวิเคราะห์ด้วยสถิติทดสอบ t-test แบบดั้งเดิม พบว่าได้ผลการวิเคราะห์ดังนี้</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
    Welch Two Sample t-test

data:  Ach by Method
t = 1.9067, df = 66.984, p-value = 0.06085
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -0.179778  7.852900
sample estimates:
mean in group 1 mean in group 2 
       50.97567        47.13911 </code></pre>
<pre><code>
    Welch Two Sample t-test

data:  Solve by Method
t = -9.0266, df = 70.811, p-value = 2.144e-13
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -27.47607 -17.53326
sample estimates:
mean in group 1 mean in group 2 
       49.70763        72.21230 </code></pre>
</div>
<p>ผลการวิเคราะห์ที่ได้จาก t-test ข้างต้นให้สารสนเทศใดแก่ผู้วิเคราะห์บ้าง?</p>
<h2 id="bayesian-approach-1-normal-model">Bayesian approach 1: normal model</h2>
<p>การเปรียบเทียบค่าเฉลี่ยด้วยวิธีการแบบเบส์สามารถทำได้หลายวิธีการ วิธีการหนึ่งที่สามารถทำได้อาจกำหนดโมเดลดังรูปด้านล่าง</p>
<p><img src="model1.png" /></p>
<p>จากรูปจะเห็นว่ามีการกำหนดโมเดลให้กับค่าสังเกตในแต่ละกลุ่มเป็นการแจกแจงแบบปกติที่มีค่าเฉลี่ยเท่ากับ <span class="math inline">\(\mu_1\)</span> และ <span class="math inline">\(\mu2\)</span> และพารามิเตอร์ความเที่ยงตรงเท่ากับ <span class="math inline">\(\tau_1\)</span> และ <span class="math inline">\(\tau_2\)</span> ตามลำดับ และ</p>
<h3 id="prior-distributions">Prior Distributions</h3>
<p>การกำหนดการแจกแจงความน่าจะเป็นเบื้องต้นให้กับพารามิเตอร์ต่าง ๆ ของโมเดลค่าสังเกต โดยพารามิเตอร์ค่าเฉลี่ยมีการแจกแจงความน่าจะเป็นเบื้องต้นเป็นการแจกแจงแบบปกติ ส่วนพารามิเตอร์ความเที่ยงตรงมีการแจกแจงความน่าจะเป็นเบื้องต้นเป็นแบบแกมมา (Gamma distribution)</p>
<p>การแจกแจงแบบแกมมา มีพารามิเตอร์กำกับการแจกแจง 2 ตัวได้แก่ shape และ rate parameters ซึ่งเขียนแทนด้วยสัญลักษณ์ <span class="math inline">\(\alpha&gt;0\)</span> และ <span class="math inline">\(\beta &gt;0\)</span> และมีฟังก์ชันความน่าจะเป็นดังนี้</p>
<p><span class="math inline">\(p(\theta)=\frac{\beta^{\alpha}}{\Gamma(\alpha)}\theta^{\alpha-1}exp\{-\beta \theta \}\)</span> โดยที่ <span class="math inline">\(\theta&gt;0\)</span></p>
<p>รูปต่อไปนี้แสดงตัวอย่างการแจกแจงความน่าจะเป็นแบบแกมมา เมื่อกำหนดพารามิเตอร์เป็นค่าต่าง ๆ</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>theta</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>5</span>,<span class='fl'>0.01</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>2</span>, ylab<span class='op'>=</span><span class='st'>"Density"</span>, xlab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>tau</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>5</span>,<span class='fl'>1</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>2</span>, ylab<span class='op'>=</span><span class='st'>"Density"</span>, xlab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>tau</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>1</span>,<span class='fl'>10</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-4-1.png" width="864" /></p>
</div>
<p>แนวทางการกำหนดค่าพารามิเตอร์ในการแจกแจงความน่าจะเป็นก่อนหน้าของพารามิเตอร์ความเที่ยงตรง (<span class="math inline">\(\tau\)</span>) การทำได้สองลักษณะ ลักษณะแรกคือ noninformative prior อาจกำหนดให้พารามิเตอร์ <span class="math inline">\(\alpha\)</span> และ <span class="math inline">\(\beta\)</span> มีค่าน้อย ๆ เช่น <code>dgamma(0.01,0.01)</code> หรือ <code>dgamma(0.001,0.001)</code> รูปด้านล่างแสดงตัวอย่างของการแจกแจงดังกล่าว</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>theta</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>5</span>,<span class='fl'>0.01</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>theta</span>, <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>theta</span>,<span class='fl'>0.01</span>,<span class='fl'>0.01</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='fl'>2</span>, ylab<span class='op'>=</span><span class='st'>"Density"</span>, xlab<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>tau</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>อีกลักษณะหนึ่งคือการกำหนดให้มีสารสนเทศในการแจกแจงความน่าจะเป็นก่อนหน้า โดยอาจมองว่าพารามิเตอร์ <span class="math inline">\(\alpha\)</span> มีค่าเท่ากับฐานนิยมของ <span class="math inline">\(\tau\)</span> และ <span class="math inline">\(\beta\)</span> มีค่าเท่ากับส่วนเบี่ยงเบนมาตรฐานของ <span class="math inline">\(\tau\)</span> (Kruschke, 2012)</p>
<h3 id="กจกรรม-1">กิจกรรม 1</h3>
<p>ดำเนินการวิเคราะห์ข้อมูลเพื่อเปรียบเทียบค่าเฉลี่ยผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ ระหว่างกลุ่มนักเรียนที่ได้รับการสอนแบบบรรยายและใช้ปัญหาเป็นฐาน ด้วยวิธีการแบบเบส์ โดยใช้การกำหนดโมเดลข้างต้น แล้วตอบคำถามต่อไปนี้</p>
<ul>
<li><p>ตัวอย่างพารามิเตอร์ที่จำลองจากอัลกอริทึม MCMC มีคุณสมบัติที่เหมาะสมสำหรับนำไปวิเคราะห์เพื่อตอบคำถามข้างต้นหรือไม่ เพราะเหตุใด</p></li>
<li><p>ผลการวิเคราะห์เพื่อเปรียบเทียบความแตกต่างของผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ระหว่างกลุ่มนักเรียนทั้งสองกลุ่มเป็นอย่างไร?</p></li>
<li><p>สารสนเทศที่ได้จากการวิเคราะห์ด้วยสถิติแบบเบส์ กับสถิติแบบดั้งเดิมมีความแตกต่างกันอย่างไร</p></li>
</ul>
<h2 id="bayesian-approach-2-generalized-students-t-model">Bayesian approach 2: generalized student’s t model</h2>
<p>การกำหนดโมเดลสำหรับวิเคราะห์ข้อมูลด้วยสถิติแบบเบส์สามารถกำหนดได้อย่างหลากหลาย กล่าวคือในปัญหาเดียวกันหากผู้วิเคราะห์มีมุมมองหรือกรอบแนวคิดที่แตกต่างกันก็สามารถกำหนดโมเดลการวิเคราะห์ที่แตกต่างกันได้ รูปด้านล่างแสดงการกำหนดโมเดลสำหรับเปรียบเทียบค่าเฉลี่ยสองกลุ่มในอีกลักษณะหนึ่ง</p>
<p><img src="model2.png" /> เมื่อเปรียบเทียบกับโมเดลที่ 1 ที่ได้ดำเนินการวิเคราะห์ไปแล้ว นิสิตคิดว่าโมเดลนี้มีความเหมือนและแตกต่างไปจากเดิมอย่างไรบ้าง?</p>
<p>ทั้งนี้การแจกแจงความน่าจะเป็นแบบทีดังกล่าวเป็นอีก version หนึ่งเรียกว่า Generalized student’s t distribution ซึ่งมีพารามิเตอร์กำกับการแจกแจง 3 ตัวได้แก่ ค่าเฉลี่ย ส่วนเบี่ยงเบนมาตรฐาน และองศาความเป็นอิสระ (<span class="math inline">\(\nu&gt;0\)</span>) และมีฟังก์ชันความน่าจะเป็นดังนี้</p>
<p><span class="math inline">\(p(y|\mu, \sigma, \nu)=\frac{\Gamma(\frac{\nu+1}{2})}{\Gamma(\frac{\nu}{2})\sqrt{\pi\nu}\sigma}(1+\frac{1}{\nu}(\frac{y-\mu}{\sigma})^2)^{-\frac{\nu+1}{2}}\)</span></p>
<p>การเลือกใช้การแจกแจงแบบทีเป็นโมเดลค่าสังเกตมีข้อดีกว่าการแจกแจงแบบปกติคือ การแจกแจงแบบทีเป็นการแจกแจงที่มีส่วนปลาย (หาง) ของการแจกแจงที่หนากว่าการแจกแจงแบบปกติ ซึ่งทำให้โมเดลของค่าสังเกตมีความแกร่งต่อการเกิดค่าผิดปกติ (outlier) มากกว่าโมเดลที่ใช้การแจกแจงแบบปกติ ความหนา ณ ส่วนปลายของการแจกแจงแบบทีสามารถกำหนดผ่านค่าพารามิเตอร์องศาความเป็นอิสระ (<span class="math inline">\(\nu\)</span>) โดยถ้า <span class="math inline">\(\nu\)</span> ยิ่งมีค่าน้อย การแจกแจงทีจะยิ่งมีส่วนปลายที่หนาขึ้น ในทางกลับกันหาก <span class="math inline">\(\nu\)</span> มีค่ามาก การแจกแจงทีดังกล่าวจะลู่เข้าหาการแจกแจงแบบปกติ กล่าวได้ว่าโมเดลนี้เป็นกรณีทั่วไปของ model 1 ที่ได้กล่าวไว้ก่อนหน้านี้นั่นเอง รูปต่อไปนี้แสดงฟังก์ชันความหนาแน่นของการแจกแจงความน่าจะเป็นแบบที เมื่อมีองศาความเป็นอิสระต่าง ๆ กัน</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>6</span>,<span class='fl'>6</span>,<span class='fl'>0.01</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, lty<span class='op'>=</span><span class='fl'>1</span>, ylab<span class='op'>=</span><span class='st'>"Density"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>dt</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>1</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>,lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>dt</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>2</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>,lty<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>dt</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>3</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>,lty<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>dt</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>5</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>,lty<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>dt</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fl'>10</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>,lty<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.1</span>, <span class='st'>"t-Distribution"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>0.38</span>, <span class='st'>"Normal Distriibution"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<h3 id="กจกรรม-2">กิจกรรม 2</h3>
<p>ดำเนินการวิเคราะห์ข้อมูลเพื่อเปรียบเทียบค่าเฉลี่ยผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ ระหว่างกลุ่มนักเรียนที่ได้รับการสอนแบบบรรยายและใช้ปัญหาเป็นฐาน ด้วยวิธีการแบบเบส์ โดยใช้การกำหนดโมเดลข้างต้น แล้วตอบคำถามต่อไปนี้</p>
<ul>
<li><p>ตัวอย่างพารามิเตอร์ที่จำลองจากอัลกอริทึม MCMC มีคุณสมบัติที่เหมาะสมสำหรับนำไปวิเคราะห์เพื่อตอบคำถามข้างต้นหรือไม่ เพราะเหตุใด</p></li>
<li><p>ผลการวิเคราะห์เพื่อเปรียบเทียบความแตกต่างของผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ระหว่างกลุ่มนักเรียนทั้งสองกลุ่มเป็นอย่างไร?</p></li>
<li><p>ระหว่างโมเดล 1 กับโมเดล 2 โมเดลใดเป็นโมเดลที่เหมาะสมมากกว่า เพราะเหตุใด</p></li>
</ul>
<h2 id="bayesian-approach-3-log-normal-model">Bayesian approach 3: log-normal model</h2>
<p>นอกจากการกำหนดโมเดลการวิเคราะห์ทั้งสอง ผู้วิเคราะห์ยังสามารถกำหนดโมเดลการวิเคราะห์อื่น ๆ ได้อย่างหลากหลาย ทั้งนี้ต้องคำนึงถึงธรรมชาติของข้อมูลและพารามิเตอร์ภายในโมเดลการวิเคราะห์ เช่น หากผู้วิเคราะห์สำรวจข้อมูลแล้วพบว่าข้อมูลคะแนนค่าสังเกตที่ต้องการนำมาวิเคราะห์มีการแจกแจงที่เบ้ขวา (positively skewed) ผู้วิเคราะห์อาจกำหนดโมเดลของค่าสังเกตเป็นการแจกแจงแบบ log-normal โดยอาจเขียนคำสั่งดังนี้</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='st'>"model{
  
  for(i in 1:n)
  {
    #log-normal likelihood
    y[i]~dlnorm(mu[x[i]],tau[x[i]])
  }
  
  for(j in 1:2)
  {
    # prior distributions
    mu[j]~dnorm(0,0.01)
    tau[j]~dgamma(0.01,0.01)
    sigma2[j]&lt;-1/tau[j]
    
    # calculate mean and sd of the distribution
    mean[j]&lt;-exp(mu[1]+sigma2[j]/2)
    sd[j]&lt;- sqrt((exp(sigma2[j])-1)*exp(2*mu[j]+sigma2[j]))
  }

}"</span>
</code></pre>
</div>
</div>
<p>จากชุดคำสั่งระบุโมเดลในข้างต้นจะเห็นว่า การแจกแจง log-normal พารามิเตอร์ <span class="math inline">\(\mu\)</span> และ <span class="math inline">\(\sigma^2\)</span> ไม่ใช่พารามิเตอร์ค่าเฉลี่ยและความแปรปรวนของการแจกแจง การคำนวณค่าเฉลี่ย และความแปรปรวนของ log-normal distribution สามารถคำนวณได้ดังนี้ (<a href="https://en.wikipedia.org/wiki/Log-normal_distribution" class="uri">https://en.wikipedia.org/wiki/Log-normal_distribution</a>)</p>
<p><span class="math inline">\(Mean = exp(\mu+\frac{\sigma^2}{2})\)</span></p>
<p><span class="math inline">\(Variance = [exp(\sigma^2)-1]exp(2\mu+\sigma^2)\)</span></p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>รูปต่อไปนี้แสดงการตรวจสอบคุณภาพของตัวอย่างข้อมูลจำลองที่สร้างขึ้นจากลูกโซ่มาร์คอฟ จากรูปพบว่าตัวอย่างที่สร้างขึ้นมีลักษณะที่แสดงถึงการลู่เข้าสู่สถานะคงตัว (stationary distribution) เมื่อพิจารณาอัตสหสัมพันธ์ภายในแต่ละลูกโซ่ของพารามิเตอร์พบว่ามีค่าต่ำตั้งแต่ lag ที่ 1 เป็นต้นไป และเมื่อพิจารณาผลจากค่าสถิติ PSRF พบว่ามีค่าเท่ากับ 1 ในทุกพารามิเตอร์ นั่นหมายความว่า ลูกโซ่ของพารามิเตอร์ภายในโมเดลที่สร้างขึ้นพารามิเตอร์ละ 3 ชุดนั้น มีการลู่เข้าหาการแจกแจงสถานะคงตัวเดียวกัน ผลการวิเคราะห์ทั้งหมดนี้บ่งชี้ว่าตัวอย่างลูกโซ่ที่จำลองขึ้นจากกระบวนการสุ่มนี้มีคุณภาพที่ดี และน่าจะเป็นตัวอย่างของพารามิเตอร์ที่สุ่มจากการแจกแจงความน่าจะเป็นภายหลังที่ต้องการ</p>
<div class="layout-chunk" data-layout="l-body-outset">
<p><img src="glm1_files/figure-html5/unnamed-chunk-9-1.png" width="864" /><img src="glm1_files/figure-html5/unnamed-chunk-9-2.png" width="864" /></p>
<pre><code>             mean[1]      mean[2]        sd[1]       sd[2]
Lag 0    1.000000000  1.000000000  1.000000000 1.000000000
Lag 10   0.002117818 -0.001586005 -0.004173995 0.001063236
Lag 50  -0.006628564 -0.007791238 -0.002182255 0.005589014
Lag 100  0.010180744  0.008790487  0.005640398 0.005188884
Lag 500 -0.002266881 -0.008254212 -0.002178094 0.001552742
                 diff    effectsize
Lag 0    1.0000000000  1.0000000000
Lag 10   0.0000929066  0.0008682332
Lag 50  -0.0029025030 -0.0068767664
Lag 100  0.0033541139  0.0056011177
Lag 500 -0.0076327141 -0.0127589617</code></pre>
<p><img src="glm1_files/figure-html5/unnamed-chunk-9-3.png" width="864" /></p>
</div>
<p>เมื่อพิจารณาผลการวิเคราะห์สำหรับเปรียบเทียบค่าเฉลี่ยพบว่า ค่าเฉลี่ยภายหลังของพารามิเตอร์ค่าเฉลี่ยผลสัมฤทธิ์ในกลุ่มบรรยายและใช้ปัญหาเป็นฐาน มีค่าเท่ากับ 51.02 และ 52.99 คะแนน และมีค่าเฉลี่ยภายหลังของพารามิเตอร์ส่วนเบี่ยงเบนมาตรฐานของผลสัมฤทธิ์เป็น 6.23 และ 14.54 คะแนน ตามลำดับ นอกจากนี้ยังพบว่าส่วนเบี่ยงเบนมาตรฐานภายหลังของพารามิเตอร์ทั้ง 4 ภายในโมเดล มีค่าอยู่ในช่วง 0.66 - 1.85 ตามลำดับ คิดเป็นสัมประสิทธิ์การแปรผันภายหลังของพารามิเตอร์อยู่ในช่วงร้อยละ 1.72 - 12.72 แสดงให้เห็นว่าการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์มีความน่าเชื่อถืออยู่ในระดับที่รับได้</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>                  mean          sd    95%_HPDL    95%_HPDU Rhat n.eff
mean[1]    51.02448835 0.885342263 49.25368528 52.72227133    1 15000
mean[2]    52.98708630 1.041930856 50.93246816 54.98998247    1 15000
sd[1]       6.22197429 0.666306969  4.99772705  7.56166670    1 15000
sd[2]      14.53318175 1.845666077 11.23820707 18.27661074    1 15000
diff       -1.96259795 0.513099955 -2.97031454 -1.04145854    1 15000
effectsize -0.04676912 0.008715738 -0.06439884 -0.03034028    1 14778</code></pre>
</div>
<p>เมื่อพิจารณาความแตกต่างของค่าเฉลี่ยผลสัมฤทธิ์ระหว่างวิธีการสอนทั้งสองพบว่า มีค่าเฉลี่ยภายหลังของผลต่างเท่ากับ -1.96 คะแนน เมื่อพิจารณาการแจกแจงความน่าจะเป็นภายหลังของขนาดอิทธิพลประกอบพบว่า ขนาดอิทธิพลที่คำนวณจากสูตรของ Cohen มีการแจกแจงความน่าจะเป็นภายหลังอยู่บนช่วงประมาณ -0.08 ถึง -0.02 ซึ่งถือว่าเป็นขนาดอิทธิพลในระดับที่ต่ำมาก</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="glm1_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h2 id="สรป">สรุป</h2>
<p>จากตัวอย่างทั้ง 3 จะเห็นว่า การวิเคราะห์แบบเบส์นี้ผู้วิเคราะห์สามารถเลือกกำหนดโมเดลได้ค่อนข้างหลากหลาย ขึ้นอยู่กับความเหมาะสมและวิจารณญาณของผู้วิเคราะห์ ปัญหาที่ตามมาคือหากในปัญหาเดียวกันผู้วิเคราะห์สมมุติฐานหรือโมเดลการวิเคราะห์ที่มากกว่า 1 โมเดลแล้ว จะทราบได้อย่างไรมากโมเดลใดเป็นโมเดลที่มีความเหมาะสมมากที่สุด ??</p>
<h1 id="bayesian-alternative-to-anova-banova">Bayesian alternative to ANOVA (BANOVA)</h1>
<p>หัวข้อนี้จะกล่าวถึงการวิเคราะห์ความแปรปรวนแบบเบส์ รายละเอียดมีดังนี้</p>
<h2 id="one-way-banova">One-Way BANOVA</h2>
<p>นักวิจัยทดลองใช้วิธีการสอน 4 วิธี กับนักเรียนจำนวน 4 กลุ่มที่มีการวิเคราะห์แล้วว่ามีพื้นฐานใกล้เคียงกัน เมื่อสอนจบตามแผนแล้วมีการวัดผลการเรียนรู้ภายหลัง ได้ผลดังนี้</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr>
<th style="text-align:right;">
lec
</th>
<th style="text-align:right;">
pbl
</th>
<th style="text-align:right;">
cop
</th>
<th style="text-align:right;">
dem
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
</div>
<p>โมเดลการวิเคราะห์ความแปรปรวนทางเดียวสามารถเขียนได้สองลักษณะ ลักษณะแรกเรียกว่า mean model เขียนได้ดังนี้</p>
<p><span class="math inline">\(y_{ij}=\mu_j+\epsilon_{ij}\)</span></p>
<p>อีกลักษณะหนึ่งคือ effect model</p>
<p><span class="math inline">\(y_{ij}=\alpha+\beta_j+\epsilon_{ij}\)</span> เมื่อ <span class="math inline">\(\sum_{j=1}^J\beta_j=0\)</span> และ <span class="math inline">\(\alpha\)</span> คือ grand mean ดังนั้น <span class="math inline">\(alpha+beta_j=\mu_j\)</span> ก็คือ group mean</p>
<p>รูปด้านล่างแสดงโมเดลค่าสังเกตแบบ effect model</p>
<p><img src="bnova.png" style="width:40.0%" /> #### กิจกรรม 3</p>
<ul>
<li><p>วิเคราะห์ ANOVA เพื่อเปรียบเทียบค่าเฉลี่ยของชุดข้อมูลข้างต้น</p></li>
<li><p>วิเคราะห์ BANOVA เพื่อเปรียบเทียบค่าเฉลี่ยของชุดข้อมูลข้างต้น</p></li>
<li><p>ผลการวิเคราะห์จากทั้งสองวิธีให้สารสนเทศที่เหมือนหรือแตกต่างกันอย่างไร?</p></li>
</ul>
<h3 id="ผลการวเคราะหแบบ-traditional">ผลการวิเคราะห์แบบ Traditional</h3>
<p>เป็นแบบฝึกหัดให้ผู้อ่าน</p>
<h3 id="ผลการวเคราะหแบบ-bayesian">ผลการวิเคราะห์แบบ Bayesian</h3>
<p>ส่วนจัดการข้อมูลนำเข้า</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># dataset</span>
<span class='va'>method</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/gl.html'>gl</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>8</span><span class='op'>)</span> <span class='co'>#teaching method</span>
<span class='va'>J</span><span class='op'>&lt;-</span><span class='fl'>4</span> <span class='co'>#number of groups</span>
<span class='va'>n</span><span class='op'>&lt;-</span><span class='fl'>32</span> <span class='co'>#number of individual per group</span>
<span class='va'>ach</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>lec</span>, <span class='va'>pbl</span>, <span class='va'>cop</span>, <span class='va'>dem</span><span class='op'>)</span>
<span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>ach</span>, x<span class='op'>=</span><span class='va'>method</span>, J<span class='op'>=</span><span class='va'>J</span>, n<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>คำสั่งระบุโมเดลข้างล่างเขียนในลักษณะ effect model จะเห็นว่าการประมาณค่า treatment effect (<code>beta</code>) ในโมเดล ไม่ได้ประมาณอย่างอิสระทั้ง 4 กลุ่ม แต่จะประมาณเพียง 3 กลุ่ม แล้วใช้ผลการประมาณดังกล่าวมาเป็นค่าประมาณของกลุ่มที่เหลือ ที่ต้องเขียนในลักษณะนี้เป็นเพราะเงื่อนไขของ effect model ที่มีการ constraint พารามิเตอร์ treatment effect ดังกล่าว (<span class="math inline">\(\sum_{j=1}^J\beta_j=0\)</span>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='st'>"model{

#likelihood function
for(i in 1:n)
{
y[i]~dnorm(mu[i], tau) #homogeneity of variance model
mu[i]&lt;-alpha+beta[x[i]] #effects model
}


#prior distribution
tau ~ dgamma(0.01,0.01)
sigma&lt;-1/sqrt(tau) #root mean square of the ANOVA model (RMSE)
alpha~dnorm(0,0.01) #grand mean

for (j in 2:J)
{
beta[j]~dnorm(0,0.01)
}

beta[1]&lt;- -(sum(beta[2:J]))

}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit.banova</span><span class='op'>&lt;-</span><span class='fu'>run.jags</span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>banova</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mean"</span>,<span class='st'>"sigma"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='va'>samples</span><span class='op'>&lt;-</span><span class='fu'>as.mcmc.list</span><span class='op'>(</span><span class='va'>fit.banova</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>ผลการตรวจสอบคุณภาพของลูกโซ่ใน output ด้านขวาแสดงให้เห็นว่า ตัวอย่างลูกโซ่มีคุณภาพที่ดี และสามารถใช้เพื่อประมาณการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ภายในโมเดลได้</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>MCMCtrace</span><span class='op'>(</span><span class='va'>samples</span>, pdf<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
<img src="glm1_files/figure-html5/unnamed-chunk-17-1.png" width="624" /><img src="glm1_files/figure-html5/unnamed-chunk-17-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>autocorr.diag</span><span class='op'>(</span><span class='va'>samples</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>             mean[1]      mean[2]      mean[3]       mean[4]
Lag 0    1.000000000  1.000000000  1.000000000  1.0000000000
Lag 3   -0.010322228  0.009402559  0.003240864  0.0007744016
Lag 15   0.004295750 -0.007530674 -0.001217727  0.0036276692
Lag 30   0.005091883  0.002204231 -0.012416509  0.0026950145
Lag 150 -0.006132002  0.000456659 -0.006595624 -0.0038344416
                sigma
Lag 0    1.000000e+00
Lag 3   -1.638865e-04
Lag 15   1.030252e-02
Lag 30   5.322524e-06
Lag 150  9.192150e-03</code></pre>
</div>
<p>เมื่อพิจารณาผลการวิเคราะห์การแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ที่สำคัญภายในโมเดลพบว่า กลุ่มที่ได้รับการสอนแบบโครงงาน เป็นกลุ่มที่มีแนวโน้มที่จะมีคะแนนสอบสูงสุด โดยมีค่าเฉลี่ยคะแนนสอบที่คิดจากค่าเฉลี่ยภายหลังเท่ากับ 8.35 คะแนน (SD = 0.607) รองลงมาคือกลุ่มที่ได้รับวิธีการสอนแบบร่วมมือ มีค่าเฉลี่ยภายหลังเท่ากับ 6.12 คะแนน (SD = 0.605) และพบว่ากลุ่มที่ได้รับการสอนแบบสาธิตเป็นกลุ่มที่มีค่าเฉลี่ยภายหลังต่ำที่สุด โดยมีค่าเท่ากับ 2.89 คะแนน (SD = 0.605)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>MCMCsummary</span><span class='op'>(</span><span class='va'>samples</span>, HPD<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>            mean        sd 95%_HPDL 95%_HPDU Rhat n.eff
mean[1] 4.869796 0.6035584  3.67108  6.04177    1 30916
mean[2] 8.359963 0.6063316  7.12061  9.51072    1 29456
mean[3] 6.116177 0.6087424  4.94823  7.33789    1 30000
mean[4] 2.879811 0.6107672  1.67712  4.08693    1 30000
sigma   1.700276 0.2378854  1.28503  2.18564    1 29595</code></pre>
</div>
<h2 id="multiple-comparison">Multiple Comparison</h2>
<p>การวิเคราะห์ BANOVA ไม่จำเป็นต้องทำการทดสอบภาพรวมแบบการทดสอบ F-test ใน ANOVA ทั้งนี้เป็นเพราะ BANOVA ใช้การแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์เป็นเครื่องมือในการอนุมานเชิงสถิติ ซึ่งเป็นการแจกแจงที่อยู่ในปริภูมิของพารามิเตอร์โดยตรง และไม่ได้มีการเปลี่ยนแปลงแม้ว่าจำนวนคู่ของการเปรียบเทียบจะมีมากหรือน้อยก็ตาม ขอบเขตและความหนาแน่นของพารามิเตอร์ก็ยังเหมือนเดิม ดังนั้น BANOVA จึงสามารถทำการเปรียบเทียบรายคู่ (multiple comparison) ได้โดยที่ไม่จำเป็นต้องผ่านการทดสอบภาพรวมก่อน</p>
<p>นอกจากการเปรียบเทียบแบบรายคู่แล้ว BANOVA ยังสามารถทำการวิเคราะห์เปรียบเทียบแบบไม่ใช่รายคู่ (non-pairwise comparison) ได้อีกด้วย ตัวอย่างด้านล่างแสดงการเขียนคำสั่งเพื่อสร้าง contrast สำหรับการเปรียบเทียบค่าเฉลี่ยผลสัมฤทธิ์ระหว่างคู่ของวิธีการสอนที่สนใจ ประกอบด้วย</p>
<p>c1: PBL vs PBL</p>
<p>c2: LEC vs DEM</p>
<p>c3: LEC vs COP</p>
<p>c4: PBL vs average of (LEC, DEM and COP)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#banova with constrast</span>
<span class='va'>banova</span><span class='op'>&lt;-</span><span class='st'>"model{
#likelihood function

for(i in 1:n)
{
y[i]~dnorm(mu[i], tau) #homogeneity of variance model
mu[i]&lt;-alpha+beta[x[i]] #effects model
}

#prior distribution
tau ~ dgamma(0.01,0.01)
sigma&lt;-1/sqrt(tau) #root mean square of the ANOVA model (RMSE)
alpha~dnorm(0,0.01) #grand mean

for (j in 2:J)
{
beta[j]~dnorm(0,0.01)
}
beta[1]&lt;- -sum(beta[2:J])

#define contrast
c1&lt;-beta[2]-beta[1] #pbl vs lec
c2&lt;-beta[1]-beta[4] #lec vs dem
c3&lt;-beta[1]-beta[3] #lec vs cop
c4&lt;-beta[2]-mean(beta[c(1,3,4)]) #pbl vs average of lec dem and cop
}"</span>

<span class='va'>fit.banova</span><span class='op'>&lt;-</span><span class='fu'>run.jags</span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>banova</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"alpha"</span>,<span class='st'>"beta"</span>,<span class='st'>"sigma"</span>,<span class='st'>"c1"</span>,<span class='st'>"c2"</span>,<span class='st'>"c3"</span>,<span class='st'>"c4"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Calling 3 simulations using the parallel method...
All chains have finished
Simulation complete.  Reading coda files...
Coda files loaded successfully
Finished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>samples</span><span class='op'>&lt;-</span><span class='fu'>as.mcmc.list</span><span class='op'>(</span><span class='va'>fit.banova</span><span class='op'>)</span>
<span class='va'>samples.dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>ผลการวิเคราะห์ด้านล่างแสดงให้เห็นว่า มีเพียงการเปรียบเทียบเชิงเส้นที่ใช้เปรียบเทียบค่าเฉลี่ยคะแนนสอบของนักเรียนระหว่างกลุ่มที่ได้รับการจัดการเรียนการสอนด้วยวิธีบรรยายกับร่วมมือ ที่พบว่าช่วงความน่าเชื่อถือที่มีความหนาแน่นสูงสุด 95% มีค่าศูนย์อยู่บนช่วง ซึ่งบ่งชี้ว่าค่าเฉลี่ยคะแนนสอบระหว่างสองกลุ่มดังกล่าวมีค่าไม่แตกต่างกัน</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>MCMCsummary</span><span class='op'>(</span><span class='va'>samples</span>, params<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"c1"</span>,<span class='st'>"c2"</span>,<span class='st'>"c3"</span>,<span class='st'>"c4"</span><span class='op'>)</span>, HPD <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        mean        sd  95%_HPDL 95%_HPDU Rhat n.eff
c1  3.497851 0.8534245  1.783160 5.149180    1 29639
c2  1.990585 0.8580990  0.313451 3.685220    1 30307
c3 -1.239713 0.8559952 -2.951090 0.417758    1 31201
c4  3.748142 0.6972171  2.366640 5.117360    1 28800</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>summary</span><span class='op'>&lt;-</span><span class='fu'>MCMCsummary</span><span class='op'>(</span><span class='va'>samples</span>, params<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"c1"</span>,<span class='st'>"c2"</span>,<span class='st'>"c3"</span>,<span class='st'>"c4"</span><span class='op'>)</span>, HPD <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c1</span>, col<span class='op'>=</span><span class='st'>"orange"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, main<span class='op'>=</span><span class='st'>""</span>, xlab<span class='op'>=</span><span class='st'>"c1: pbl vs lec"</span>, freq<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fl'>0</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>summary</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>]</span>,<span class='va'>summary</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>,<span class='fl'>0.01</span><span class='op'>)</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c1</span><span class='op'>)</span>,<span class='fl'>0.05</span>, <span class='st'>"95% HDI"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c2</span>, col<span class='op'>=</span><span class='st'>"orange"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, main<span class='op'>=</span><span class='st'>""</span>, xlab<span class='op'>=</span><span class='st'>"c1: lec vs dem"</span>, freq<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fl'>0</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>summary</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>]</span>,<span class='va'>summary</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>,<span class='fl'>0.01</span><span class='op'>)</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c2</span><span class='op'>)</span>,<span class='fl'>0.05</span>, <span class='st'>"95% HDI"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c3</span>, col<span class='op'>=</span><span class='st'>"orange"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, main<span class='op'>=</span><span class='st'>""</span>, xlab<span class='op'>=</span><span class='st'>"c1: lec vs cop"</span>, freq<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fl'>0</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>summary</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>]</span>,<span class='va'>summary</span><span class='op'>[</span><span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>,<span class='fl'>0.01</span><span class='op'>)</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c3</span><span class='op'>)</span>,<span class='fl'>0.05</span>, <span class='st'>"95% HDI"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c4</span>, col<span class='op'>=</span><span class='st'>"orange"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, main<span class='op'>=</span><span class='st'>""</span>, xlab<span class='op'>=</span><span class='st'>"c1: pbl vs average"</span>, freq<span class='op'>=</span><span class='cn'>F</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fl'>0</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>summary</span><span class='op'>[</span><span class='fl'>4</span>,<span class='fl'>3</span><span class='op'>]</span>,<span class='va'>summary</span><span class='op'>[</span><span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>,<span class='fl'>0.01</span><span class='op'>)</span>, lwd<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>samples.dat</span><span class='op'>$</span><span class='va'>c4</span><span class='op'>)</span>,<span class='fl'>0.05</span>, <span class='st'>"95% HDI"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-21-1.png" width="864" /></p>
</div>
<h2 id="two-way-banova">Two-Way BANOVA</h2>
<p>การวิเคราะห์ความแปรปรวนสองทางทั้งที่มีและไม่มีอิทธิพลปฏิสัมพันธ์สามารถทำได้โดยขยายแนวคิดของ One-Way ANOVA</p>
<p><a href="https://drive.google.com/file/d/1DH3L9Hh6gvobtTjCuzMa9HzO9QlWYpUQ/view?usp=sharing">ชุดข้อมูลตัวอย่าง</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://svn.r-project.org/R-packages/trunk/foreign/'>foreign</a></span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/foreign/man/read.spss.html'>read.spss</a></span><span class='op'>(</span><span class='st'>"/Users/siwachoat/Documents/myblog/myblog/_posts/2022-02-19-glm1/manova.sav"</span>, to.data.frame<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  id gender     schsize location cognitiveE EmotionalE BehavioralE
1  1  woman       small  นอกเมือง   3.666667   4.857143         4.0
2  2  woman       small  นอกเมือง   3.666667   4.428571         3.2
3  3  woman       large  นอกเมือง   2.916667   3.000000         3.6
4  4    man       large  นอกเมือง   3.083333   3.000000         3.6
5  5    man extra large  นอกเมือง   3.000000   3.142857         2.8
6  6    man       large  นอกเมือง   3.833333   4.000000         4.0</code></pre>
</div>
<h2 id="banova-package">BANOVA package</h2>
<p>การวิเคราะห์ด้วย JAGs ถึงแม้จะมีความยืดหยุ่นสูงแต่ก็อาจมีความลำบากในการเขียน syntax ทั้งในส่วนของโมเดล และส่วนของการวิเคราะห์ ปัจจุบันโปรแกรม R มี package จำนวนมากที่ถูกพัฒนาขึ้นสำหรับการวิเคราะห์เพื่ออนุมานเชิงสถิติแบบเบส์ในโมเดลต่าง ๆ</p>
<p>BANOVA เป็น pacakge หนึ่งที่มีประโยชน์สำหรับการอนุมานเชิงสถิติแบบเบส์โดยเฉพาะในการวิจัยเชิงทดลองที่มักมีการใช้การวิเคราะหืความแปรปรวนเป็นเครื่องมือหลักในการวิเคราะห์อิทธิพลของปัจจัยในการทดลองที่มีต่อตัวแปรตามที่สนใจ รายละเอียดต่าง ๆ ของ package สามารถอ่านเพิ่มเติมได้จาก <a href="https://www.jstatsoft.org/article/view/v081i09" class="uri">https://www.jstatsoft.org/article/view/v081i09</a></p>
<h1 id="bayesian-regression">Bayesian Regression</h1>
<p><a href="https://drive.google.com/file/d/1sLZq4RZ2IywV2O9UEG-ffmcxc0k7-QEu/view?usp=sharing">ชุดข้อมูลตัวอย่าง</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"/Users/siwachoat/Documents/myblog/myblog/_posts/2022-02-19-glm1/regression_dat1.csv"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  X Hour Class.Behav Home.Status Teach.Qua Score
1 1    6         3.3        poor       bad  39.8
2 2   11         3.7        poor       bad  59.6
3 3    6         4.8        poor      good  50.8
4 4   11         3.7      normal       bad  50.9
5 5   10         1.3        poor      good  67.9
6 6    2         3.1      normal       bad  26.0</code></pre>
</div>
<h2 id="exploring-data">Exploring data</h2>
<p>การวิเคราะห์เบื้องต้นด้วยทัศนภาพข้อมูลจะเห็นว่าตัวแปรอิสระเกือบทุกตัว ยกเว้น Teach.Qua มีแนวโน้มที่จะมีความสัมพันธ์เชิงเส้นกับตัวแปรตาม Score</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='va'>dat</span><span class='op'><a href='https://tidyr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Home.Status<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Home.Status</span><span class='op'>==</span><span class='st'>"poor"</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
              Teach.Qua<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Teach.Qua</span><span class='op'>==</span><span class='st'>"bad"</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'><a href='https://tidyr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Hour"</span>,<span class='st'>"Class.Behav"</span>,<span class='st'>"Home.Status"</span>,<span class='st'>"Teach.Qua"</span><span class='op'>)</span>, 
                   names_to<span class='op'>=</span><span class='st'>"predictors"</span>,
                   values_to <span class='op'>=</span> <span class='st'>"predictor.value"</span><span class='op'>)</span><span class='op'><a href='https://tidyr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>predictor.value</span>, y<span class='op'>=</span><span class='va'>Score</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>~</span><span class='va'>predictors</span>, scale<span class='op'>=</span><span class='st'>"free"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<p>จากผลการวิเคราะห์ข้างต้นผู้วิเคราะห์ลอง fit regression model โดยใส่ตัวแปรอิสระทุกตัวเข้าสู่โมเดล</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#model syntax</span>

<span class='st'>"model{

for(i in 1:n)
{
y[i]~dnorm(mu[i],tau)
mu[i]&lt;-b0+b1*x1+b2*x2+b3*x3+b4*x4
}

b0~dnorm(0,0.01)
b1~dnorm(0,0.01)
b2~dnorm(0,0.01)
b3~dnorm(0,0.01)
b4~dnorm(0,0.01)

tau~dunif(0,100)
sigma&lt;-1/sqrt(tau)
}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Score</span>, x1<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Hour</span>, x2<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Class.Behav</span>, 
               x3<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Home.Status</span><span class='op'>==</span><span class='st'>"poor"</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
               x4<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Teach.Qua</span><span class='op'>==</span><span class='st'>"bad"</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
               n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>

<span class='va'>fit.reg</span><span class='op'>&lt;-</span><span class='fu'>run.jags</span><span class='op'>(</span>model<span class='op'>=</span><span class='va'>reg.model</span>,
                  data<span class='op'>=</span><span class='va'>dataList</span>,
                  monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"b0"</span>,<span class='st'>"b1"</span>,<span class='st'>"b2"</span>,<span class='st'>"b3"</span>,<span class='st'>"b4"</span>,<span class='st'>"sigma"</span><span class='op'>)</span>,
                  n.chains<span class='op'>=</span><span class='fl'>3</span>,
                  sample <span class='op'>=</span> <span class='fl'>10000</span>,
                  thin<span class='op'>=</span><span class='fl'>3</span>,
                  summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                  plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                  keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Compiling rjags model...
Calling the simulation using the rjags method...
Adapting the model for 1000 iterations...
Burning in the model for 4000 iterations...
Running the model for 30000 iterations...
Simulation complete
Calculating summary statistics...
Calculating the Gelman-Rubin statistic for 6 variables....
Finished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sample</span><span class='op'>&lt;-</span><span class='fu'>as.mcmc.list</span><span class='op'>(</span><span class='va'>fit.reg</span><span class='op'>)</span>
<span class='fu'>MCMCtrace</span><span class='op'>(</span><span class='va'>sample</span>, pdf<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
<img src="glm1_files/figure-html5/unnamed-chunk-27-1.png" width="624" /><img src="glm1_files/figure-html5/unnamed-chunk-27-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>MCMCsummary</span><span class='op'>(</span><span class='va'>sample</span>, HPD<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>           mean        sd   95%_HPDL  95%_HPDU Rhat n.eff
b0    -5.306458 0.9835980 -7.2365907 -3.401244    1  7388
b1     3.768245 0.1014221  3.5650456  3.962646    1 10708
b2     4.677324 0.2335245  4.2163536  5.140814    1 12132
b3     1.895899 0.6888546  0.5633311  3.255703    1 27373
b4    19.646335 0.6754420 18.3315031 20.973072    1 25622
sigma  6.659164 0.2374420  6.2071374  7.130879    1 30000</code></pre>
</div>
<h1 id="model-checking-and-comparison">Model Checking and Comparison</h1>
<p>อย่างที่กล่าวไปบ้างแล้ว การตรวจสอบความเหมาะสมของโมเดลนั้นเป็นกระบวนการที่ผู้วิเคราะห์ใช้เพื่อพิจารณาว่าโมเดลการวิเคราะห์ (หรือสมมุติฐานของผู้วิเคราะห์) ที่กำหนดขึ้นนั้นมีความสอดคล้องกับปรากฏการณ์จริงที่ทำการศึกษาหรือไม่</p>
<p>โมเดลที่มีความเหมาะสมนั้น หมายถึงโมเดลที่สามารถใช้เป็นตัวแทนหรือประมาณปรากฏการณ์จริงที่ต้องการศึกษาได้อยู่ในระดับที่ดี อย่างไรก็ตามในความเป็นจริงเป็นไปได้ยากมากที่โมเดลดังกล่าวจะเป็นโมเดลจริงในประชากรที่ทำการศึกษา</p>
<p>การตรวจสอบความสอดคล้องของโมเดลที่ประมาณค่าด้วยวิธีการแบบเบส์นั้นมีความแตกต่างไปจากวิธีการแบบดั้งเดิม ทั้งนี้เป็นเพราะสถิติแบบเบส์ใช้การแจกแจงความน่าจะเป็นภายหลัง (posterior distributions) เป็นเครื่องมือประมาณค่าพารามิเตอร์ต่าง ๆ ภายในโมเดล ดังนั้นดัชนีต่าง ๆ หรือการตรวจสอบความเหมาะสมของโมเดลดังกล่าว จึงจะอิงจากการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ภายในโมเดลทั้งหมด อีกปัจจัยหนึ่งที่มีผลต่อประสิทธิภาพของโมเดลวิเคราะห์คือ การแจกแจงความน่าจะเป็นเบื้องต้น (prior distributions) การตรวจสอบความไวที่ไม่ได้ตั้งใจให้เกิดขึ้นจากการกำหนดการแจกแจงความน่าจะเป็นเบื้องต้น รวมทั้งความไม่เข้ากันระหว่างการแจกแจงความน่าจะเป็นเบื้องต้นกับข้อมูลเชิงประจักษ์จึงเป็นสิ่งที่ผู้วิเคราะห์อาจจำเป็นต้องตรวจสอบด้วย</p>
<p>การตรวจสอบความเหมาะสมของโมเดลแบบเบส์ด้วยวิธีการเชิงคณิตศาตร์ทำได้ยากมาก แต่สามารถทำได้ง่ายด้วยเทคนิค MCMC หัวข้อนี้จะกล่าวถึงดัชนี และวิธีการสำคัญหลายตัวที่สามารถใช้ประเมินความเหมาะสมของโมเดล</p>
<h2 id="residuals">Residuals</h2>
<p>เศษเหลือ (residuals) เป็นค่าที่ใช้วัดความเบี่ยงเบนระหว่างค่าสังเกต (<span class="math inline">\(y_i\)</span>) กับค่าทำนาย/ค่าประมาณที่ได้จากโมเดลวิเคราะห์ ในอุดมคติแล้วค่าเศษเหลือนี้ควรคำนวณโดยใช้ค่าสังเกตคนละชุดกับค่าสังเกตที่ใช้ประมาณพารามิเตอร์ในโมเดลวิเคราะห์ เรียกว่า out-sample residuals (ในทางกลับกันเศษเหลือที่คำนวณจากค่าสังเกตชุดเดียวกับที่ใช้ประมาณค่าพารามิเตอร์ในโมเดลจะเรียกว่า in-sample residuals)</p>
<p>ในทำนองเดียวกับการวิเคราะห์แบบดั้งเดิม ในการวิเคราะห์แบบเบส์สามารถใช้การวิเคราะห์เศษเหลือ (residuals analysis) เพื่อตรวจสอบความเหมาะสมของโมเดลได้เหมือนกัน เช่น การวิเคราะห์ residual plot ระหว่างเศษเหลือกับค่าทำนาย หรือ residual plot ระหว่างเศษเหลือกับตัวแปรอิสระ หรือการตรวจสอบการแจกแจงของเศษเหลือว่าเป็นไปตามข้อสมมุติของโมเดลหรือไม่ รายละเอียดมีดังนี้</p>
<h3 id="standardized-pearson-residuals">Standardized Pearson Residuals</h3>
<p>คะแนนเศษเหลือมาตรฐานสามารถคำนวณได้ดังนี้</p>
<p><span class="math inline">\(r_i(\theta)=\frac{y_i-E(y_i|\theta)}{\sqrt{Var(y_i|\theta)}}\)</span></p>
<p>จะเห็นว่าเศษเหลือดังกล่าวก็เป็นฟังก์ชันที่ขึ้นกับค่าพารามิเตอร์ของโมเดล ดังนั้นเศษเหลือของแต่ละค่าสังเกตที่ <span class="math inline">\(i\)</span> จึงมีการแจกแจง posterior เช่นเดียวกับพารามิเตอร์และค่าทำนายของโมเดล</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gridExtra</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"/Users/siwachoat/Documents/myblog/myblog/_posts/2022-02-19-glm1/regression_dat1.csv"</span><span class='op'>)</span>

<span class='va'>p1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Class.Behav</span>, y<span class='op'>=</span><span class='va'>Score</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Class Behavior"</span><span class='op'>)</span>
<span class='va'>p2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Teach.Qua</span><span class='op'>)</span>, y<span class='op'>=</span><span class='va'>Score</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Teaching Quality"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html'>grid.arrange</a></span><span class='op'>(</span><span class='va'>p1</span>,<span class='va'>p2</span>, ncol<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>reg.mod1</span><span class='op'>&lt;-</span><span class='st'>"model{

for(i in 1:n)
{
y[i]~dnorm(mu[i],tau)
mu[i]&lt;-b0+b1*x1[i]+b2*x2[i]

#calculate residual
resid[i]&lt;-(y[i]-mu[i])/sigma
}

## x1 = Class.Behav
## x2 = Teach.Qua

# priors
b0~dnorm(0,0.01)
b1~dnorm(0,0.01)
b2~dnorm(0,0.01)
tau~dgamma(0.01,0.01)

sigma&lt;-sqrt(1/tau)
}"</span>

<span class='va'>x2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Teach.Qua</span><span class='op'>==</span><span class='st'>"good"</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Score</span>, x1<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Class.Behav</span>, x2<span class='op'>=</span><span class='va'>x2</span>, n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>fit.reg</span><span class='op'>&lt;-</span><span class='fu'>run.jags</span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>reg.mod1</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"b0"</span>,<span class='st'>"b1"</span>,<span class='st'>"b2"</span>,<span class='st'>"sigma"</span>,<span class='st'>"resid"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Calling 3 simulations using the parallel method...
All chains have finished
Simulation complete.  Reading coda files...
Coda files loaded successfully
Note: Summary statistics were not produced as there are &gt;50
monitored variables
[To override this behaviour see ?add.summary and
?runjags.options] FALSEFinished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>samples</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'>as.mcmc.list</span><span class='op'>(</span><span class='va'>fit.reg</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>รูปต่อไปนีแสดงการแจกแจงภายหลังของเศษเหลือของค่าสังเกตทั้งหมด</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='va'>samples</span><span class='op'><a href='https://tidyr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"resid"</span><span class='op'>)</span>,names_to<span class='op'>=</span><span class='st'>"resid"</span>, values_to<span class='op'>=</span><span class='st'>"resid.val"</span><span class='op'>)</span><span class='op'><a href='https://tidyr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_boxplot.html'>geom_boxplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>resid</span><span class='op'>)</span>, y<span class='op'>=</span><span class='va'>resid.val</span><span class='op'>)</span>,
               outlier.alpha<span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-30-1.png" width="624" /></p>
</div>
<p>จะเห็นว่าข้อมูลของเศษเหลือในโมเดลที่ได้จากอัลกอริทึม MCMC มีปริมาณมาก และทำให้มีความลำบากในการวิเคราะห์ อีกวิธีการหนึ่งคือผู้วิเคราะห์อาจใช้ค่าเฉลี่ยภายหลังของพารามิเตอร์เพื่อคำนวณค่าเศษเหลือ หรือใช้ค่าเฉลี่ยภายหลังของเศษเหลือเองในการวิเคราะห์เศษเหลือ ดังตัวอย่างต่อไปนี้</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># posterior mean of intercept</span>
<span class='va'>b0</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>b0</span>
</code></pre>
</div>
<pre><code>      b0 
18.70508 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># posterior mean of slope b1</span>
<span class='va'>b1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>b1</span>
</code></pre>
</div>
<pre><code>      b1 
4.509844 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># posterior mean of slope b2</span>
<span class='va'>b2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colMeans</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>]</span>
<span class='va'>b2</span>
</code></pre>
</div>
<pre><code>      b2 
20.32643 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#calculate predictive value from posterior mean of parameters</span>
<span class='va'>y.hat</span><span class='op'>&lt;-</span><span class='va'>b0</span><span class='op'>+</span><span class='va'>b1</span><span class='op'>*</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Class.Behav</span><span class='op'>+</span><span class='va'>b2</span><span class='op'>*</span><span class='va'>x2</span>
<span class='co'>#calculate standardized residuals</span>
<span class='va'>resid</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Score</span><span class='op'>-</span><span class='va'>y.hat</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>sigma</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>y.hat</span>, <span class='va'>resid</span>, pch<span class='op'>=</span><span class='fl'>16</span>, xlab<span class='op'>=</span><span class='st'>"Fitted values"</span>,ylab<span class='op'>=</span><span class='st'>"Standardized Residuals"</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>h<span class='op'>=</span><span class='fl'>0</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>resid</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span>, main<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span><span class='op'>(</span><span class='va'>resid</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqline</a></span><span class='op'>(</span><span class='va'>resid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>y.hat</span>, <span class='va'>resid</span><span class='op'>^</span><span class='fl'>2</span>, pch<span class='op'>=</span><span class='fl'>16</span>, xlab<span class='op'>=</span><span class='st'>"Fitted values"</span>,ylab<span class='op'>=</span><span class='st'>"Standardized Residuals^2"</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>resid</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>~</span><span class='va'>y.hat</span><span class='op'>)</span>, lty<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<p>ผลการวิเคราะห์เศษเหลือข้างต้นจะเห็นว่า โมเดล <code>reg.mod1</code> มีปัญหาความไม่เหมาะสมของโมเดล กล่าวคือมีหลักฐานว่าอาจเกิดปัญหา heteroscedasticity ซึ่งสาเหตุของปัญหาดังกล่าวเป็นไปได้ว่าผู้วิเคราะห์อาจยังระบุโมเดลวิเคราะห์ไม่เหมาะสม เช่น อาจลืมตัวแปรอิสระที่สำคัญ หรืออาจละเลยการวิเคราะห์อิทธิพลปฏิสัมพันธ์ เป็นต้น</p>
<h3 id="กจกรรม">กิจกรรม</h3>
<p>จงใช้การวิเคราะห์เศษเหลือตรวจสอบความเหมาะสมของการวิเคราะห์ได้แก่</p>
<ul>
<li><p>การเปรียบเทียบค่าเฉลี่ยสองกลุ่ม</p></li>
<li><p>BANOVA</p></li>
</ul>
<h2 id="posterior-predictive-check">Posterior Predictive Check</h2>
<p>posteior predictve check เป็นการตรวจสอบความสอดคล้องเชิงประจักษ์ของโมเดลการวิเคราะห์ ด้วยการเปรียบเทียบกันระหว่างค่าทำนายของตัวแปรตามที่ได้จากโมเดลกับค่าสังเกตจริงจากข้อมูลตัวอย่าง</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1253</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Ach<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>48</span>,<span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,
                Solve<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>rt</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>5</span><span class='op'>+</span><span class='fl'>50</span>,<span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>rt</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10</span><span class='op'>+</span><span class='fl'>70</span><span class='op'>)</span>,
                Method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>50</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>twosamples</span><span class='op'>&lt;-</span><span class='st'>"model{
  #likelihood function
  for(i in 1:n)
  {
    y[i]~dnorm(mu[x[i]],tau[x[i]])
  }
  
  for (j in 1:2)
  {
  #prior distribution
  mu[j]~dnorm(0,0.01)
  tau[j]~dgamma(0.01,0.01)
  
  #deterministic nodes
  sigma[j]&lt;-sqrt(1/tau[j])
  }
  
}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mcmc-jags.sourceforge.io'>rjags</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ku-awdc/runjags'>runjags</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>coda</span><span class='op'>)</span>
<span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span>, x<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Method</span>, n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>fit</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/run.jags.html'>run.jags</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"rjparallel"</span>,
                        model<span class='op'>=</span><span class='va'>twosamples</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>,<span class='st'>"sigma"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Compiling rjags model...
Note: the model did not require adaptation
Starting 3 rjags simulations using a Fork cluster with 3 nodes
on host &#39;localhost&#39;
Simulation complete
Calculating summary statistics...
Calculating the Gelman-Rubin statistic for 4 variables....
Finished running the simulation</code></pre>
</div>
<p>ขั้นตอนต่อไปนี้แสดงการสร้าง predictive value จาก posterior distribution โดยสุ่มเลือกค่าพารามิเตอร์ขึ้นมา 1000 ชุด เพื่อสร้าง posterior predictive distribution จำนวน 1000 ชุด โดยที่แต่ละชุดมีค่าสังเกตผลสัมฤทธิ์ทางการเรียนจำนวน 100 ค่า เหมือนกับข้อมูลตัวอย่างตั้งต้น</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sample</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>as.mcmc.list</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
<span class='va'>sample</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>sample</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>sample</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 30000     4</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>param.id</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>30000</span>,<span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>sample</span><span class='op'>&lt;-</span><span class='va'>sample</span><span class='op'>[</span><span class='va'>param.id</span>,<span class='op'>]</span>

<span class='va'>y.rep</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>nrow<span class='op'>=</span><span class='fl'>100</span>,ncol<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>1000</span><span class='op'>)</span>
<span class='op'>{</span>
<span class='va'>y1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='va'>sample</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>sample</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>y2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='va'>sample</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>sample</span><span class='op'>[</span>,<span class='fl'>4</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>y.rep</span><span class='op'>[</span>,<span class='va'>i</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>y1</span>,<span class='va'>y2</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>### example of posterior predictive distribution</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>4</span><span class='op'>)</span>, mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>16</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>y.rep</span><span class='op'>[</span>,<span class='va'>i</span><span class='op'>]</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, main<span class='op'>=</span><span class='st'>"Posterior Predictive Distribution"</span>, nclass<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-36-1.png" width="864" /></p>
</div>
<p>การใช้งาน posterior predictive distribution คือการพิจารณาว่าการแจกแจง predictive ดังกล่าวมีความลำเอียงไปจากการแจกแจงของข้อมูลค่าสังเกตอย่างมีนัยสำคัญหรือไม่ รูปต่อไปนี้แสดงการเปรียบเทียบระหว่าง posterior predictive ที่สร้างขึ้นกับข้อมูลจริง</p>
<div class="layout-chunk" data-layout="l-body-outset">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, main<span class='op'>=</span><span class='st'>""</span>, nclass<span class='op'>=</span><span class='fl'>30</span>, xlab<span class='op'>=</span><span class='st'>"Ach"</span>, freq<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span><span class='op'>)</span>
<span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>y.rep</span><span class='op'>[</span>,<span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, lty<span class='op'>=</span><span class='fl'>2</span>, cex<span class='op'>=</span><span class='fl'>0.5</span>, col<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
<p><img src="glm1_files/figure-html5/unnamed-chunk-37-1.png" width="864" /></p>
</div>
<p>นอกจากการตรวจสอบด้วย visualization ในข้างต้นแล้ว ยังสามารถเปรียบเทียบ posterior predictve กับข้อมูลจริงด้วยค่าสถิติ เช่นการใช้ posterior predictive p-value ดังรายละเอียดในหัวข้อต่อไป</p>
<h2 id="posterior-predictive-p-value-ppp">Posterior Predictive P-value (PPP)</h2>
<p>bayesian p-value เป็นวิธีการหนึ่งที่ใช้นำเสนอความแตกต่างระหว่างค่าสังเกตจริงกับค่าทำนายของโมเดล การคำนวณค่า bayesian p-value สามารถทำได้หลายลักษณะขึ้นอยู่กับค่าสถิติที่เลือกใช้ นิยามของค่า PPP เป็นดังนี้</p>
<p><span class="math inline">\(PPP = P(T(y^{rep}) \geq T(y))\)</span></p>
<p>เมื่อ <span class="math inline">\(T(.)\)</span> คือ discrepancy measures หรือ test quantiles ที่จะใช้เป็นตัวเปรียบเทียบระหว่างการแจกแจงของ posterior predictive กับ observed value การกำหนด test quantile ดังกล่าวสามารถทำได้หลายลักษณะและไม่ได้มีกฎเกณฑ์ตายตัว ขึ้นอยู่กับว่าผู้วิเคราะห์ต้องการสารสนเทศในเชิงการเปรียบเทียบแบบใด ค่า test quantile ที่มักใช้ได้แก่ ค่าต่ำสุด ค่าสูงสุด ค่าเฉลี่ย และส่วนเบี่ยงเบนมาตรฐาน ตัวอย่างต่อไปนี้แสดงการคำนวณค่า PPP ข้างต้น</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='va'>Tmax.y</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span><span class='op'>)</span>
<span class='va'>Tmax.yrep</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>y.rep</span>,<span class='fl'>2</span>,<span class='va'>max</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>Tmax.yrep</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span>, xlab<span class='op'>=</span><span class='st'>"max Y.rep"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, nclass<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>Tmax.y</span>, col<span class='op'>=</span><span class='st'>"red"</span>, lty<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<img src="glm1_files/figure-html5/unnamed-chunk-38-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ppp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>Tmax.yrep</span><span class='op'>&gt;</span><span class='va'>Tmax.y</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://rdrr.io/r/base/proportions.html'>prop.table</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ppp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='co'>#PPP value</span>
</code></pre>
</div>
<pre><code> TRUE 
0.235 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Tmin.y</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span><span class='op'>)</span>
<span class='va'>Tmin.yrep</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>y.rep</span>,<span class='fl'>2</span>,<span class='va'>min</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>Tmin.yrep</span>, col<span class='op'>=</span><span class='st'>"skyblue"</span>, xlab<span class='op'>=</span><span class='st'>"max Y.rep"</span>, border<span class='op'>=</span><span class='st'>"white"</span>, nclass<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='va'>Tmin.y</span>, col<span class='op'>=</span><span class='st'>"red"</span>, lty<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<img src="glm1_files/figure-html5/unnamed-chunk-39-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ppp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>Tmin.yrep</span><span class='op'>&gt;</span><span class='va'>Tmin.y</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://rdrr.io/r/base/proportions.html'>prop.table</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>ppp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='co'>#PPP value</span>
</code></pre>
</div>
<pre><code> TRUE 
0.161 </code></pre>
</div>
<p>จากนิยามของ PPP ข้างต้นจะเห็นว่าหาก PPP มีค่าเข้าใกล้ 0 หรือ 1 นั่นหมายความว่าโมเดลการวิเคราะห์สร้าง predictive value ที่มีความแตกต่าง/ลำเอียง ไปจากข้อมูลจริงอย่างมาก ดังนั้น PPP = 0.5 จึงหมายความว่าโมเดลมีความสอดคล้องกับข้อมูลจริงอย่างสมบูรณ์ ในทางปฏิบัติไม่ได้มีการกำหนด cut-off ไว้แน่นอน แต่ค่า cut-off ที่มักใช้กันคือ PPP&lt;0.05,0.1 หรือ PPP&gt;0.90,0.95</p>
<h2 id="deviance">Deviance</h2>
<p>สถิติ deviance เขียนแทนด้วย <span class="math inline">\(D(\theta)\)</span> เป็นฟังก์ชันของพารามิเตอร์ <span class="math inline">\(\theta\)</span> ดังสมการ</p>
<p><span class="math inline">\(D(\theta)=-2log\ p(y|\theta)\)</span></p>
<p>เนื่องจากพารามิิเตอร์ <span class="math inline">\(\theta\)</span> มีการแจกแจง posterior ดังนั้น deviance ก็จะมีการแจกแจง posterior ด้วยเช่นกัน จากสูตรของ deviance ข้างต้นจะเห็นว่ามีความหมายในลักษณะของความไม่สอดคล้องระหว่างโมเดลกับข้อมูลค่าสังเกต ดังนั้นโมเดลที่มีความเหมาะสมจึงควรมีค่า deviance ต่ำ ๆ อย่างไรก็ตามสถิติ deviance ไม่ได้มีหน่วยตายคัว (ไม่มี absolute unit) ทำให้การแปลความหมายขนาดของค่า deviance ทำได้ยาก การใช้งาน deviance จึงเป็นการใช้งานในลักษณะของการเปรียบเทียบกันระหว่างโมเดลคู่แข่งขัน</p>
<p>สมมุติว่า ผู้วิเคราะห์ต้องการเปรียบเทียบค่าเฉลี่ยผลสัมฤทธิ์ทางการเรียนระหว่างกลุ่มนักเรียนที่ได้ับการสอนแบบบรรยาย กับใช้ปัญหาเป็นฐาน ผู้วิเคราะห์มีสมมุติฐานว่าโมเดลที่ยอมให้ความแปรปรวนระหว่างกลุ่มมีความแตกต่างกัน (heterogeneity of variances model) น่าจะเป็นโมเดลที่เหมาะสำหรับการเปรียบเทียบค่าเฉลี่ยในกรณีนี้มากกว่าโมเดลที่กำหนดให้ความแปรปรวนระหว่างกลุ่มเท่าเทียมกัน (homogeneity of variances model)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1253</span><span class='op'>)</span>
<span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Ach<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>50</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>48</span>,<span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,
                Solve<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>rt</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>5</span><span class='op'>+</span><span class='fl'>50</span>,<span class='fu'><a href='https://rdrr.io/r/stats/TDist.html'>rt</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10</span><span class='op'>+</span><span class='fl'>70</span><span class='op'>)</span>,
                Method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>50</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       Ach    Solve Method
1 57.88928 50.01438      1
2 51.20072 49.48460      1
3 43.34361 43.94092      1
4 55.12593 48.40898      1
5 45.35700 50.11348      1
6 53.47266 56.45850      1</code></pre>
</div>
<p>เพื่อตรวจสอบสมมุติฐานดังกล่าว ผู้วิเคราะห์จึงรันโมเดลทั้งสองเปรียบเทียบกันดังนี้</p>
<h3 id="homogeneity-of-variances-model">Homogeneity of Variances Model</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='st'>"model{
  #likelihood function
  for(i in 1:n)
  {
    y[i]~dnorm(mu[x[i]],tau)
    
    # calculate log-lik
    loglik[i]&lt;- -0.5*log(2*pi)-0.5*log(sigma^2)-(1/(2*sigma^2))*(y[i]-mu[x[i]])^2
  }
  
  for (j in 1:2)
  {
  #prior distribution
  mu[j]~dnorm(0,0.01)
  

  }
  
  tau~dgamma(0.01,0.01)
  sigma&lt;-sqrt(1/tau)
  
  #calculate deviance value
  deviance&lt;- -2*sum(loglik)
}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="heterogeneity-of-variances-model">Heterogeneity of Variances Model</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='st'>"model{
  #likelihood function
  for(i in 1:n)
  {
    y[i]~dnorm(mu[x[i]],tau[x[i]])
    
    # calculate log-lik
    loglik[i]&lt;- -0.5*log(2*pi)-0.5*log(sigma[x[i]]^2)-(1/(2*sigma[x[i]]^2))*(y[i]-mu[x[i]])^2
  }
  
  for (j in 1:2)
  {
  #prior distribution
  mu[j]~dnorm(0,0.01)
  tau[j]~dgamma(0.01,0.01)
  
  #deterministic nodes
  sigma[j]&lt;-sqrt(1/tau[j])
  }
  
  #calculate deviance value
  deviance&lt;- -2*sum(loglik)
}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mcmc-jags.sourceforge.io'>rjags</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ku-awdc/runjags'>runjags</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>coda</span><span class='op'>)</span>

<span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span>, x<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Method</span>, n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, pi<span class='op'>=</span><span class='va'>pi</span><span class='op'>)</span>

<span class='va'>fit.homo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/run.jags.html'>run.jags</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>homo</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>,<span class='st'>"sigma"</span>,<span class='st'>"deviance"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Calling 3 simulations using the parallel method...
All chains have finished
Simulation complete.  Reading coda files...
Coda files loaded successfully
Finished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit.hetero</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/run.jags.html'>run.jags</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>hetero</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>,<span class='st'>"sigma"</span>,<span class='st'>"deviance"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Calling 3 simulations using the parallel method...
All chains have finished
Simulation complete.  Reading coda files...
Coda files loaded successfully
Finished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sample.homo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>as.mcmc.list</a></span><span class='op'>(</span><span class='va'>fit.homo</span><span class='op'>)</span>
<span class='va'>sample.hetero</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>as.mcmc.list</a></span><span class='op'>(</span><span class='va'>fit.hetero</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>สถิติสรุป posterior ของ homogeneity of variances model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sample.homo</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Iterations = 5001:34998
Thinning interval = 3 
Number of chains = 3 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

           Mean     SD Naive SE Time-series SE
mu[1]     49.94 1.4407 0.008318       0.008309
mu[2]     46.16 1.4231 0.008217       0.008340
sigma     10.19 0.7391 0.004267       0.004262
deviance 747.49 3.1995 0.018472       0.018722

2. Quantiles for each variable:

            2.5%     25%    50%    75%  97.5%
mu[1]     47.055  48.992  49.95  50.91  52.71
mu[2]     43.339  45.219  46.17  47.13  48.89
sigma      8.877   9.677  10.14  10.66  11.77
deviance 743.803 745.149 746.70 748.98 755.86</code></pre>
</div>
<p>สถิติสรุป posterior ของ heterogeneity of variances model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sample.hetero</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Iterations = 5001:34998
Thinning interval = 3 
Number of chains = 3 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

            Mean     SD Naive SE Time-series SE
mu[1]     50.627 0.8220 0.004746       0.004746
mu[2]     45.507 1.8797 0.010852       0.010801
sigma[1]   5.783 0.5993 0.003460       0.003460
sigma[2]  13.340 1.3977 0.008070       0.007963
deviance 717.405 3.4576 0.019962       0.020210

2. Quantiles for each variable:

            2.5%     25%     50%     75%   97.5%
mu[1]     49.001  50.082  50.625  51.182  52.236
mu[2]     41.779  44.264  45.526  46.768  49.147
sigma[1]   4.752   5.365   5.729   6.149   7.101
sigma[2]  10.925  12.355  13.216  14.199  16.401
deviance 713.043 714.855 716.642 719.109 726.097</code></pre>
</div>
<p>ผลการวิเคราะห์ posterior distribution ของ โมเดลทั้งสองจะพบว่า โมเดลที่ยอมให้ความแปรปรวนระหว่างกลุ่มมีความแตกต่างกัน มีแนวโน้มที่จะให้ค่า deviance ต่ำกว่าโมเดลที่กำหนดให้ความแปรปรวนระหว่างกลุ่มเท่าเทียมกัน</p>
<p>รูปต่อไปนี้แสดงการเปรียบเทียบการแจกแจง posterior ของค่าสถิติ deviance ระหว่างโมเดลทั้งสอง ผลการวิเคราะห์เห็นชัดเจนว่า การแจกแจง posterior ของสถิติ deviance ของโมเดล heterogeneity of variances มีแนวโน้มที่จะมีค่าต่ำกว่าโมเดล homogeneity of variance</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dev.homo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>sample.homo</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>4</span><span class='op'>]</span>
<span class='va'>dev.het</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>sample.hetero</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>5</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>dev.homo</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, 
    xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>700</span>,<span class='fl'>780</span><span class='op'>)</span>, main<span class='op'>=</span><span class='st'>" "</span>, 
    xlab<span class='op'>=</span><span class='st'>"deviance"</span>,
    col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='va'>dev.het</span><span class='op'>)</span>, type<span class='op'>=</span><span class='st'>"l"</span>, col<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="glm1_files/figure-html5/unnamed-chunk-48-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>### Pr(Dev.het &lt; Dev.homo)</span>
<span class='va'>p</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>dev.het</span> <span class='op'>&lt;</span> <span class='va'>dev.homo</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://rdrr.io/r/base/proportions.html'>prop.table</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>p</span>
</code></pre>
</div>
<pre><code>
TRUE 
   1 </code></pre>
</div>
<p>นอกจากนี้ยังพบว่า <span class="math inline">\(P(deviance_{hetero}&lt;deviance_{homo})=1\)</span> สรุปได้ว่าโมเดล heteogeneity of variances มีความเหมาะสมมากกว่า</p>
<p>นอกจากการเปรียบเทียบ posterior distribution ของ deviance โดยตรงแล้ว ผู้วิเคราะห์ยังสามารถใช้ค่าสถิติที่คำนวณจาก posterior ของ deviance มาเปรียบเทียบกันได้ด้วย เช่น ค่า posterior mean ของ deviance (เขียนแทนด้วย <span class="math inline">\(\overline{D(\theta)}\)</span>)</p>
<p>สถิติ deviance มีข้อจำกัดสำคัญคือ เป็นสถิติที่มักจะเข้าข้างโมเดลที่มีความซับซ้อนมากกว่าเสมอ ซึ่งเพิ่มโอกาสที่จะเลือกโมเดลระบุเกินพอดี (overfitting model) เป็นโมเดลที่เหมาะสม และส่งผลความเป็นนัยทั่วไปของข้อสรุปมีขอบเขตที่ลดลง หัวข้อถัดไปจะกล่าวถึงการแก้ปัญหานี้</p>
<h2 id="deviance-information-criterion-dic">Deviance Information Criterion (DIC)</h2>
<p>การเปรียบเทียบโมเดลแบบดั้งเดิมมีหลายวิธีการ ทั้งการใช้ดัชนีเพื่อเปรียบเทียบ และการทดสอบเพื่อเปรียบเทียบ โดยส่วนใหญ่แล้ววิธีการดังกล่าวเหมาะสำหรับการเปรียบเทียบโมเดลคู่แข่งขันที่เป็น nested model ในกรณีที่ต้องการเปรียบเทียบโมเดลแบบ non-nested อาจใช้ดัชนี AIC (Akaike Information Criterion) มีสูตรดังนี้</p>
<p><span class="math inline">\(AIC = -2\ log(y|\hat{\theta})+2p = D(\hat{\theta})+2p\)</span></p>
<p>โดยที่ <span class="math inline">\(\hat{\theta}\)</span> คือค่าประมาณ maximum likelhood (minimum deviance) ของพารามิเตอร์ <span class="math inline">\(\theta\)</span> ส่วน <span class="math inline">\(p\)</span> คือจำนวนพารามิเตอร์ภายในโมเดล การแปลความหมาย AIC ทำได้ในทำนองเดียวกับ deviance คือโมเดลที่มีค่า AIC ต่ำจะเป็นโมเดลที่เหมาะสมกว่า ดัชนี AIC มีจุดเด่นเหนือ deviance คือมีการปรับสูตรชดเชยค่าดัชนีด้วยเทอม <span class="math inline">\(2p\)</span> ทำให้ดัชนีมีความแกร่งต่อโมเดลระบุเกินพอดีมากกว่าการใช้ log-likelihood โดยตรง</p>
<p>ดัชนีอีกตัวที่อยู่ในกลุ่มเดียวกับ AIC คือ ดัชนี Bayesian Information Criterion (BIC) ดัชนีดังกล่าวมีการชดเชยความซับซ้อนของโมเดลแตกต่างไปจาก AIC ดังนี้</p>
<p><span class="math inline">\(BIC = -2log\ p(y|\hat{\theta})+p\ log\ n\)</span></p>
<p>โดยที่ <span class="math inline">\(\hat{\theta}\)</span> คือค่าประมาณ maximum likelihood และการแปลผล BIC ทำในทำนองเดียวกับ AIC กล่าวคือ โมเดลที่มีค่า BIC ต่ำกว่ามีแนวโน้มที่จะเป็นโมเดลที่เหมาะสมกว่า</p>
<p>แนวคิดการชดเชยความซับซ้อนของโมเดลที่ใช่้ในสูตรดัชนี AIC และ BIC สามารถนำมาใช้กับดัชนี DIC ได้เช่นเดียวกัน อย่างไรก็ตามการวิเคราะห์แบบเบส์ยอมให้มีการกำหนดการแจกแจงความน่าจะเป็นเบื้องต้นให้กับพารามิเตอร์ภายในโมเดล ซึ่งในกรณีที่ผู้วิเคราะห์กำหนดให้การแจกแจงดังกล่าวมีสารสนเทศ (informative priors) การแจกแจงดังกล่าวจะมีอิทธิพลต่อการประมาณค่าพารามิเตอร์ภายในโมเดล กล่าวคือจะทำให้ความเป็นอิสระของค่าประมาณที่ได้ลดลง จำนวนพารามิเตอร์ภายในโมเดลที่มีการกำหนดการแจกแจงเบื้องต้นแบบมีสารสนเทศจึงไม่เท่ากับ <span class="math inline">\(p\)</span> เหมือนในสูตรดัชนี AIC และ BIC</p>
<p>Spiegelhalter และคณะ (2002) ได้เสนอค่าสถิติจำนวนพารามิเตอร์ที่มีประสิทธิภาพของโมเดล (the effective number of parameter) เขียนแทนด้วย <span class="math inline">\(p_D\)</span> ซึ่งมีค่าเท่ากับ</p>
<p><span class="math inline">\(p_D = \overline{D(\theta)}-D(\hat{\theta})\)</span></p>
<p>โดยที่ <span class="math inline">\(\hat{\theta}\)</span> เป็นค่าประมาณที่เหมาะสมของ <span class="math inline">\(\theta\)</span> จาก posterior distribution</p>
<p><strong>Note</strong></p>
<ul>
<li><p>จากสูตรข้างต้นอาจเขียนได้ว่า <span class="math inline">\(p_D=posterior\ mean\ deviance - deviance \ of\ posterior \ mean\)</span></p></li>
<li><p>ในกรณีที่โมเดลการวิเคราะห์เลือกใช้การแจกแจงความน่าจะเป็นเบื้องต้นแบบไม่มีสารสนเทศ <span class="math inline">\(p_D \approx p\)</span></p></li>
<li><p><span class="math inline">\(p_D\)</span> ไม่สามารถใช้ได้ในกรณีที่ปริภูมิของพารามิเตอร์ <span class="math inline">\(\theta\)</span> เป็นค่าไม่ต่อเนื่อง ทั้งนี้เป็นเพราะ posterior mean ของพารามิเตอร์ <span class="math inline">\(\theta\)</span> จะไม่มีความหมาย นอกจากนี้ยังไม่เหมาะในกรณีที่ posteior distribution ของพารามิเตอร์ <span class="math inline">\(\theta\)</span> มีการแจกแจงที่ไม่สมมาตร หรือมีหลายฐานนิยมอีกด้วย</p></li>
</ul>
<p>จาก <span class="math inline">\(p_D\)</span> ในข้างต้นทำให้สามารถนิยามดัชนีวัดความสอดคล้องของโมเดลวิเคราะห์แบบเบส์เรียกว่า deviance information criterion (DIC) ได้ดังนี้</p>
<p><span class="math inline">\(DIC = \overline{D}+p_D = D(\overline{\theta})+2p_D\)</span></p>
<p>ดัชนี DIC เป็นกรณีทั่วไปของดัชนี AIC กล่าวคือในกรณีที่โมเดลกำหนดการแจกแจงความน่าจะเป็นเบื้องต้นของพารามิเตอร์เป็นแบบไม่มีสารสนเทศ ค่า <span class="math inline">\(p_D \approx p\)</span> ซึ่งทำให้ <span class="math inline">\(DIC \approx AIC\)</span></p>
<p>การคำนวณค่า DIC และค่าสถิติที่เกี่ยวข้องจากโมเดลสามารถทำได้ดังนี้</p>
<p>จากตัวอย่าง homogeneity และ heterogeneity of variances models</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/extract.runjags.html'>extract.runjags</a></span><span class='op'>(</span><span class='va'>fit.homo</span>, what<span class='op'>=</span><span class='st'>"dic"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Compiling rjags model and adapting for 1000 iterations...
Obtaining DIC samples from 10000 iterations...</code></pre>
<pre><code>Mean deviance:  747.4 
penalty 3.028 
Penalized deviance: 750.5 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/extract.runjags.html'>extract.runjags</a></span><span class='op'>(</span><span class='va'>fit.hetero</span>, what<span class='op'>=</span><span class='st'>"dic"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Compiling rjags model and adapting for 1000 iterations...
Obtaining DIC samples from 10000 iterations...</code></pre>
<pre><code>Mean deviance:  717.4 
penalty 4.2 
Penalized deviance: 721.6 </code></pre>
</div>
<h2 id="waic-and-loo">WAIC and LOO</h2>
<p>Watanabe-Akaike information criterion (WAIC) และ leave-one-out cross validation (LOO) เป็นดัชนีที่ถูกพัฒนาขึ้นภายหลังสำหรับใช้เปรียบเทียบโมเดลแบบเบส์ ซึ่งมีอำนาจการทดสอบที่สูงกว่าการทดสอบอัตราส่วนภาวะความควรจะเป็น, AIC, BIC และ DIC (Luo, and Al-Harbi, 2017)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#install.packages("loo")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mc-stan.org/loo/'>loo</a></span><span class='op'>)</span>
<span class='st'>"model{
  #likelihood function
  for(i in 1:n)
  {
    y[i]~dnorm(mu[x[i]],tau)
    
    # calculate log-lik
    loglik[i]&lt;- logdensity.norm(y[i],mu[x[i]],tau)
  }
  
  for (j in 1:2)
  {
  #prior distribution
  mu[j]~dnorm(0,0.01)
  

  }
  
  tau~dgamma(0.01,0.01)
  sigma&lt;-sqrt(1/tau)
  
  #calculate deviance value
  deviance&lt;- -2*sum(loglik)
}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Ach</span>, x<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Method</span>, n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>fit.homo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/run.jags.html'>run.jags</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>homo</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>,<span class='st'>"sigma"</span>,<span class='st'>"loglik"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Calling 3 simulations using the parallel method...
All chains have finished
Simulation complete.  Reading coda files...
Coda files loaded successfully
Note: Summary statistics were not produced as there are &gt;50
monitored variables
[To override this behaviour see ?add.summary and
?runjags.options] FALSEFinished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit.hetero</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/run.jags.html'>run.jags</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"parallel"</span>,
                        model<span class='op'>=</span><span class='va'>hetero</span>,
                        monitor<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>,<span class='st'>"sigma"</span>,<span class='st'>"loglik"</span><span class='op'>)</span>,
                        data<span class='op'>=</span><span class='va'>dataList</span>,
                        n.chains<span class='op'>=</span><span class='fl'>3</span>,
                        sample <span class='op'>=</span> <span class='fl'>10000</span>,
                        thin<span class='op'>=</span><span class='fl'>3</span>,
                        summarise<span class='op'>=</span><span class='cn'>TRUE</span>,
                        plots<span class='op'>=</span><span class='cn'>FALSE</span>,
                        keep.jags.files <span class='op'>=</span> <span class='cn'>FALSE</span>,
                        silent.jags <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Calling 3 simulations using the parallel method...
All chains have finished
Simulation complete.  Reading coda files...
Coda files loaded successfully
Note: Summary statistics were not produced as there are &gt;50
monitored variables
[To override this behaviour see ?add.summary and
?runjags.options] FALSEFinished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sample1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>as.mcmc.list</a></span><span class='op'>(</span><span class='va'>fit.homo</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sample2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>as.mcmc.list</a></span><span class='op'>(</span><span class='va'>fit.hetero</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='va'>loglik1</span><span class='op'>&lt;-</span><span class='va'>sample1</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"loglik"</span><span class='op'>)</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>loglik2</span><span class='op'>&lt;-</span><span class='va'>sample2</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"loglik"</span><span class='op'>)</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://mc-stan.org/loo/reference/waic.html'>waic</a></span><span class='op'>(</span><span class='va'>loglik1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Computed from 30000 by 100 log-likelihood matrix

          Estimate   SE
elpd_waic   -375.7  9.8
p_waic         3.7  0.9
waic         751.4 19.6

2 (2.0%) p_waic estimates greater than 0.4. We recommend trying loo instead. </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://mc-stan.org/loo/reference/loo.html'>loo</a></span><span class='op'>(</span><span class='va'>loglik1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Computed from 30000 by 100 log-likelihood matrix

         Estimate   SE
elpd_loo   -375.7  9.8
p_loo         3.7  0.9
looic       751.4 19.6
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://mc-stan.org/loo/reference/waic.html'>waic</a></span><span class='op'>(</span><span class='va'>loglik2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Computed from 30000 by 100 log-likelihood matrix

          Estimate   SE
elpd_waic   -360.9  8.6
p_waic         4.0  0.8
waic         721.7 17.3

2 (2.0%) p_waic estimates greater than 0.4. We recommend trying loo instead. </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://mc-stan.org/loo/reference/loo.html'>loo</a></span><span class='op'>(</span><span class='va'>loglik2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Computed from 30000 by 100 log-likelihood matrix

         Estimate   SE
elpd_loo   -360.9  8.6
p_loo         4.1  0.8
looic       721.8 17.3
------
Monte Carlo SE of elpd_loo is 0.0.

All Pareto k estimates are good (k &lt; 0.5).
See help(&#39;pareto-k-diagnostic&#39;) for details.</code></pre>
</div>
<p>ฝากไปดู</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xS4jDHQfP2o" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<h3 id="bayes-factor">Bayes Factor</h3>
<p>ในกรณีที่ผู้วิเคราะห์ไม่ได้สนใจที่จะอธิบายค่าอิทธิพลต่าง ๆ ผ่านการประมาณค่าพารามิเตอร์ แต่ต้องการดำเนินการทดสอบเพื่อตัดสินใจเกี่ยวกับนัยสำคัญของอิทธิพลต่าง ๆ หรือเปรียบเทียบโมเดลการวิเคราะห์หลาย ๆ โมเดล ในกรณีนี้จำเป็นต้องใช้การเปรียบเทียบโมเดลแบบเบส์ ซึ่งเครื่องมือหนึ่งที่สามารถนำมาใช้ได้คือ ตัวประกอบเบส์ (Bayes Factor: BF)</p>
<p>จากตัวอย่างการเปรียบเทียบค่าเฉลี่ยสองกลุ่ม สมมุติว่าต้องการทดสอบว่า</p>
<p><span class="math inline">\(H_0: \mu_1 =\mu_2\)</span> vs <span class="math inline">\(H_1: \mu_1 \neq \mu_2\)</span></p>
<p>ในการวิเคราะห์แบบเบส์ผู้วิเคราะห์จำเป็นต้องกำหนดโมเดล 2 โมเดลที่เป็นคู่แข่งขันกัน คือโมเดลตามสมมุติฐาน <span class="math inline">\(H_0\)</span> ที่กำหนดการแจกแจงความน่าจะเป็นเบื้องต้นของผลต่างระหว่างค่าเฉลี่ยทั้งสองกลุ่มมีค่าเป็น 0 ด้วยความน่าเชื่อถือที่สูงมาก และโมเดลตามสมมุติฐาน <span class="math inline">\(H_1\)</span> ที่กำหนดการแจกแจงความน่าจะเป็นเบื้องต้นของพารามิเตอร์ผลต่างดังกล่าวเป็นค่าใด ๆ จากนั้นทำการประมาณการแจกแจงความน่าจะเป็นภายหลังของโมเดลทั้งสองเพื่อประมาณค่า bayes factor</p>
<p>กำหนดให้ M1 และ M2 แทนโมเดลตามสมมุติฐาน <span class="math inline">\(H_0\)</span> และ <span class="math inline">\(H_1\)</span> ตามลำดับ หากมองว่าโมเดลก็มีความไม่แน่นอน ดังนั้นโมเดลจึงมีความเป็นไปได้ได้มากกว่า 1 โมเดล ตามแนวคิดของเบส์ผู้วิเคราะห์ก็สามารถประมาณการแจกแจง posterior ของแต่ละโมเดลที่ based on ข้อมูลเชิงประจักษ์ได้เหมือนกับการแจกแจง posterior ของพารามิเตอร์ในแต่ละโมเดล ดังนี้</p>
<p><span class="math inline">\(p(M_1|D)=\frac{p(D|M_1)p(M_1)}{\sum_{m=1}^2 p(D|M_m)p(M_m)}\)</span></p>
<p><span class="math inline">\(p(M_2|D)=\frac{p(D|M_2)p(M_2)}{\sum_{m=1}^2 p(D|M_m)p(M_m)}\)</span></p>
<p>จาก posterior ของโมเดลข้างต้นจะได้ว่า posterior odd ของโมเดล มีค่าเท่ากับ</p>
<p><img src="Screen%20Shot%202565-02-26%20at%2009.37.07.png" style="width:30.0%" /></p>
<p>นิยามของ bayes factor ข้างต้นอาจเขียนสัญลักษณ์แทนด้วย <span class="math inline">\(BF_{12}\)</span> ซึ่งหมายถึงน้ำหนักการเกิดค่าสังเกต <span class="math inline">\(D\)</span> ในโมเดล <span class="math inline">\(M_1\)</span> เมื่อเปรียบเทียบกับน้ำหนักการเกิดค่าสังเกต <span class="math inline">\(D\)</span> ในโมเดล <span class="math inline">\(M_2\)</span> ถ้าอัตราส่วนดังกล่าวมีค่ามากกว่า 1 แสดงว่ามีแนวโน้มที่โมเดล <span class="math inline">\(M_1\)</span> จะสอดคล้องกับข้อมูลจริงมากกว่า <span class="math inline">\(M_2\)</span></p>
<p>bayes factor มีจุดเด่นคล้ายกับ AIC คือสามารถใช้เพื่อเปรียบเทียบโมเดลคู่แข่งขันแบบ non-nested ได้ แต่มีความแตกต่างจาก AIC คือ bayes factor ให้สารสนเทศที่มีความเป็นปรนัยมากกว่า AIC ตารางด้านล่างแสดงการแปลความหมายขนาดของ bayes factor</p>
<p><img src="Screen%20Shot%202565-03-04%20at%2007.31.45.png" style="width:80.0%" /></p>
<p>การหา bayes factor ด้วย JAGs สามารถทำได้ดังนี้</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Calling 3 simulations using the parallel method...
Following the progress of chain 1 (the program will wait for
all chains to finish before continuing):
Welcome to JAGS 4.3.0 on Sat Mar  5 00:00:15 2022
JAGS is free software and comes with ABSOLUTELY NO WARRANTY
Loading module: basemod: ok
Loading module: bugs: ok
. . Reading data file data.txt
. Compiling model graph
   Resolving undeclared variables
   Allocating nodes
Graph information:
   Observed stochastic nodes: 100
   Unobserved stochastic nodes: 5
   Total graph size: 223
. Reading parameter file inits1.txt
. Initializing model
. Adaptation skipped: model is not in adaptive mode.
. Updating 4000
-------------------------------------------------| 4000
************************************************** 100%
. . . . . Updating 30000
-------------------------------------------------| 30000
************************************************** 100%
. . . . Updating 0
. Deleting model
. 
All chains have finished
Note: the model did not require adaptation
Simulation complete.  Reading coda files...
Coda files loaded successfully
Calculating summary statistics...
Calculating the Gelman-Rubin statistic for 5 variables....
Finished running the simulation</code></pre>
<pre><code>
Iterations = 5001:34998
Thinning interval = 3 
Number of chains = 3 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

            Mean     SD Naive SE Time-series SE
b0       50.3202 0.8379 0.004838       0.005096
b1       -1.4407 7.7151 0.044543       0.045706
sigma[1]  5.8127 0.6063 0.003500       0.003543
sigma[2] 13.3630 1.3766 0.007948       0.007962
mod       0.5451 0.4980 0.002875       0.003446

2. Quantiles for each variable:

            2.5%    25%    50%    75%  97.5%
b0        48.641 49.768 50.327 50.879 51.957
b1       -16.755 -5.107 -2.658  1.433 16.907
sigma[1]   4.775  5.388  5.760  6.183  7.167
sigma[2]  10.969 12.398 13.247 14.219 16.365
mod        0.000  0.000  1.000  1.000  1.000</code></pre>
<p><img src="glm1_files/figure-html5/unnamed-chunk-53-1.png" width="624" /></p>
</div>
<p>Node <code>mod</code> ในโมเดลข้างต้นมีการแจกแจงความน่าจะเป็นภายหลังคือ <span class="math inline">\(p(M|D)\)</span> ดังนั้นค่าเฉลี่ยภายหลังของ node ดังกล่าวจึงมีค่าเท่ากับ <span class="math inline">\(P(M=1|D)=P(Model_1|D)=0.5518\)</span> และ <span class="math inline">\(P(M=0|D)=P(Model_2)=1-0.5518=0.4482\)</span></p>
<p>posterior odd ระหว่างโมเดลสองค่าเฉลี่ยต่อโมเดลหนึ่งค่าเฉลี่ยจึงมีค่าเท่ากับ</p>
<p><span class="math inline">\(\frac{P(M=1|D)}{P(M=0|D)}=\frac{0.5518}{0.4482}=1.2311\)</span></p>
<p>เนื่องจาก prior odd ของโมเดลทั้งสองมีค่าเท่ากับ 1 ดังนั้น Bayes factor ของโมเดลสองค่าเฉลี่ยเทียบกับโมเดลหนึ่งค่าเฉลี่ย จึงมีค่าเท่ากับ</p>
<p><span class="math inline">\(BF_{10}=\frac{P(M=1|D)}{P(M=0|D)} \times \frac{P(M=0)}{P(M=1)}=1.2311\)</span></p>
<p>bayes factor มีความสัมพันธ์กับดัชนี BIC กล่าวคือในกรณีที่โมเดลวิเคราะห์มีการกำหนดการแจกแจงความน่าจะเป็นเบื้องต้นของพารามิเตอร์เป็นแบบไม่ให้สารสนเทศ และ <span class="math inline">\(BIC_0\)</span> กับ <span class="math inline">\(BIC_1\)</span> คือค่า BIC ของโมเดลคู่แข่งขันตามสมมุติฐาน <span class="math inline">\(H_0\)</span> กับ <span class="math inline">\(H_1\)</span> จะได้ว่า</p>
<p><span class="math inline">\(BIC_0-BIC_1 \approx -2log\ B_{01}\)</span></p>
<p>ตัวอย่างต่อไปนี้แสดงการใช้ bayes factor เปรียบเทียบใน regression model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"/Users/siwachoat/Documents/myblog/myblog/_posts/2022-02-19-glm1/regression_dat1.csv"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  X Hour Class.Behav Home.Status Teach.Qua Score
1 1    6         3.3        poor       bad  39.8
2 2   11         3.7        poor       bad  59.6
3 3    6         4.8        poor      good  50.8
4 4   11         3.7      normal       bad  50.9
5 5   10         1.3        poor      good  67.9
6 6    2         3.1      normal       bad  26.0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x1</span><span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Hour</span>
<span class='va'>x3</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Home.Status</span><span class='op'>==</span><span class='st'>"poor"</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='va'>x4</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Teach.Qua</span><span class='op'>==</span><span class='st'>"bad"</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>
<span class='va'>dataList</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Score</span>, x1<span class='op'>=</span><span class='va'>x1</span>, x2<span class='op'>=</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>Class.Behav</span>,
               x3<span class='op'>=</span><span class='va'>x3</span>,
               x4<span class='op'>=</span><span class='va'>x4</span>,
               x13<span class='op'>=</span><span class='va'>x1</span><span class='op'>*</span><span class='va'>x3</span>, x14<span class='op'>=</span><span class='va'>x1</span><span class='op'>*</span><span class='va'>x4</span>, n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='st'>"model{
M~dcat(p[])
p[1]&lt;-0.5
p[2]&lt;-0.5

for (i in 1:n)
{
y[i]~dnorm(mu[i,M],tau)
mu[i,1]&lt;-b[1]+b[2]*x1[i]+b[3]*x2[i]+b[4]*x3[i]+b[5]*x4[i]
mu[i,2]&lt;-b[1]+b[2]*x1[i]+b[3]*x2[i]+b[4]*x3[i]+b[5]*x4[i]+b[6]*x13[i]+b[7]*x14[i]

loglik[i,1]&lt;-logdensity.norm(y[i],mu[i,1],tau)
loglik[i,2]&lt;-logdensity.norm(y[i],mu[i,2],tau)
}

for(j in 1:7)
{
b[j]~dnorm(0,0.01)
}
tau~dunif(0,100)
sigma&lt;-1/sqrt(tau)
deviance[1]&lt;- -2*sum(loglik[,1])
deviance[2]&lt;- -2*sum(loglik[,2])
mod&lt;-M-1
}"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>fit.reg</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/runjags/man/run.jags.html'>run.jags</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"rjparallel"</span>,
                  model<span class='op'>=</span><span class='va'>reg</span>,
                  data<span class='op'>=</span><span class='va'>dataList</span>,
                  monitor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"b"</span>,<span class='st'>"sigma"</span>,<span class='st'>"deviance1"</span>,<span class='st'>"deviance2"</span>,<span class='st'>"mod"</span><span class='op'>)</span>,
                  n.chains<span class='op'>=</span><span class='fl'>3</span>,
                  sample<span class='op'>=</span><span class='fl'>10000</span>,
                  thin<span class='op'>=</span><span class='fl'>10</span>,
                  silent.jags <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Starting 3 rjags simulations using a Fork cluster with 3 nodes
on host &#39;localhost&#39;
Note: The monitored variable &#39;mod&#39; appears to be
non-stochastic; it will not be included in the convergence
diagnostic
Finished running the simulation</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sample</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/mcmc.list.html'>as.mcmc.list</a></span><span class='op'>(</span><span class='va'>fit.reg</span><span class='op'>)</span>
<span class='fu'>MCMCtrace</span><span class='op'>(</span><span class='va'>sample</span>, pdf<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
<img src="glm1_files/figure-html5/unnamed-chunk-57-1.png" width="624" /><img src="glm1_files/figure-html5/unnamed-chunk-57-2.png" width="624" /><img src="glm1_files/figure-html5/unnamed-chunk-57-3.png" width="624" /><img src="glm1_files/figure-html5/unnamed-chunk-57-4.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/coda/man/autocorr.diag.html'>autocorr.diag</a></span><span class='op'>(</span><span class='va'>sample</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                b[1]         b[2]        b[3]         b[4]
Lag 0    1.000000000  1.000000000 1.000000000 1.0000000000
Lag 10   0.478741831  0.478030041 0.045576428 0.2972476729
Lag 50   0.031756941  0.033047259 0.008957884 0.0034219372
Lag 100  0.002119377  0.001547937 0.001961193 0.0065605508
Lag 500 -0.003658869 -0.002361700 0.008864129 0.0007987568
                b[5]         b[6]          b[7]        sigma
Lag 0    1.000000000  1.000000000  1.0000000000  1.000000000
Lag 10   0.346574005  0.297304349  0.3439219783  0.005877118
Lag 50   0.017539222  0.013688928  0.0158047066 -0.006979039
Lag 100 -0.001839661  0.004583672 -0.0062815703  0.005027590
Lag 500 -0.002497264 -0.003953694 -0.0005292672 -0.004922956
           deviance1     deviance2 mod
Lag 0    1.000000000  1.0000000000 NaN
Lag 10   0.365950164  0.0617608001 NaN
Lag 50   0.022391005  0.0001485375 NaN
Lag 100  0.008272329 -0.0071807816 NaN
Lag 500 -0.005184251 -0.0057359607 NaN</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>MCMCsummary</span><span class='op'>(</span><span class='va'>sample</span>, HPD<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                   mean          sd     95%_HPDL     95%_HPDU Rhat
b[1]        -0.19501978   1.0770284   -2.3255289    1.8976548    1
b[2]         2.92804772   0.1352189    2.6700161    3.1990427    1
b[3]         4.70771123   0.2050836    4.2973840    5.0999076    1
b[4]         1.56875824   1.2534138   -0.8988280    4.0227520    1
b[5]         7.11517476   1.2580737    4.6870549    9.6098821    1
b[6]         0.01101063   0.1790583   -0.3522547    0.3502642    1
b[7]         2.02212721   0.1790835    1.6626798    2.3640088    1
sigma        5.81279244   0.2069761    5.4220694    6.2227881    1
deviance1 3585.53673547 197.6093589 3216.7338393 3982.7709518    1
deviance2 2544.57454131   4.0094290 2537.9501585 2552.5464849    1
mod          1.00000000   0.0000000    1.0000000    1.0000000  NaN
          n.eff
b[1]      10405
b[2]      10294
b[3]      26803
b[4]      15246
b[5]      13809
b[6]      15473
b[7]      14126
sigma     30000
deviance1 12636
deviance2 26513
mod           0</code></pre>
</div>
<h2 id="สรป-1">สรุป</h2>
<p>การตรวจสอบเศษเหลือของโมเดลสามารถใช้ได้ในการวิเคราะห์แบบเบส์ แต่มีขอบเขตการใช้อยู่ภายใต้โมเดลการวิเคราะห์แบบเชิงเส้นแบบพาราเมทริกที่มีการกำหนดข้อตกลงเบื้องต้นเกี่ยวกับค่าคลาดเคลื่อนสุ่มของโมเดล ส่วนในกรณีอื่น ๆ เศษเหลือสามารถใช้เพื่อพิจารณาความแม่นยำ/ความถูกต้องของค่าทำนายที่ได้จากโมเดล โดยปกติค่าเศษเหลือที่นำมาประเมินโมเดลนั้นควรเป็น out-sample residual ทั้งนี้เพื่อไม่ให้มีความลำเอียงในการประเมินความคลาดเคลื่อนในการทำนายของโมเดล ส่วน in-sample residual มักใช้สำหรับตรวจสอบข้อตกลงเบื้องต้นของโมเดลมากกว่า</p>
<p>จาก concept ที่กล่าวไว้ในข้างต้นสรุปได้ว่า bayes factor เป็นสถิติที่ใช้สำหรับระบุโมเดลที่ถูกต้องที่สุดภายใต้ปริภูมิของโมเดลคู่แข่งขัน ทั้งนี้เป็นเพราะ bayes factor คำนวณจากค่าน้ำหนักซึ่งเป็นความน่าจะเป็นของการเกิดชุดข้อมูลตัวอย่างภายใต้แต่ละโมเดล ในขณะที่ DIC และ AIC เป็นดัชนีสำหรับเปรียบเทียบโมเดลด้วย concept ที่แตกต่างออกไป ทั้งนี้เป็นเพราะดัชนีดังกล่าวใช้บ่งชี้ความถูกต้องของค่าทำนายที่ได้จากแต่ละโมเดลมากกว่าที่จะใช้เฟ้นหา/ระบุโมเดลที่ถูกต้อง</p>
<hr />
<p>Distill is a publication format for scientific and technical writing, native to the web.</p>
<p>Learn more about using Distill at <a href="https://rstudio.github.io/distill" class="uri">https://rstudio.github.io/distill</a>.</p>
<style>
html {
  scroll-behavior: smooth;
}
d-article {
    contain: none;
  }
#TOC {
  position: responsive;
  z-index: 50;
  background: "white";     /* or   background: white; */
  top: 4;
  padding: -5px;           /* optional */
  border-radius: 5px;      /* optional */
  color: "grey";
  }

/* Hide the ToC when resized to mobile or tablet:  480px, 768px, 900px */
@media screen and (max-width: 900px) {
#TOC {
    position: relative;
  }
}
</style>
<div class="sourceCode" id="cb46"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
