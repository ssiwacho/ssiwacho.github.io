<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>หน่วยที่ 4 การเตรียมข้อมูล - ตอนที่ 4.1 การนำเข้าและเขียนชุดข้อมูล (importing and writing data)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tidy.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">ตอนที่ 4.1 การนำเข้าและเขียนชุดข้อมูล (importing and writing data)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">หน่วยที่ 4 การเตรียมข้อมูล</a> 
        <div class="sidebar-tools-main">
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./หน่วยที่-4-การเตรียมข้อมูล.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./หน่วยที่-4-การเตรียมข้อมูล.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">แผนการสอนประจำหน่วย</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import.html" class="sidebar-item-text sidebar-link active">ตอนที่ 4.1 การนำเข้าและเขียนชุดข้อมูล (importing and writing data)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy.html" class="sidebar-item-text sidebar-link">ตอนที่ 4.2 การจัดระเบียบข้อมูล (tidying data)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">หัวข้อ</h2>
   
  <ul>
  <li><a href="#เรองท-4.1.1-การกำหนด-working-directory" id="toc-เรองท-4.1.1-การกำหนด-working-directory" class="nav-link active" data-scroll-target="#เรองท-4.1.1-การกำหนด-working-directory">เรื่องที่ 4.1.1 การกำหนด working directory</a>
  <ul>
  <li><a href="#ภาษา-r" id="toc-ภาษา-r" class="nav-link" data-scroll-target="#ภาษา-r">ภาษา R</a></li>
  <li><a href="#ภาษา-python" id="toc-ภาษา-python" class="nav-link" data-scroll-target="#ภาษา-python">ภาษา Python</a></li>
  </ul></li>
  <li><a href="#เรองท-4.1.2-การนำเขาและเขยนขอมลประเภท-flat-file" id="toc-เรองท-4.1.2-การนำเขาและเขยนขอมลประเภท-flat-file" class="nav-link" data-scroll-target="#เรองท-4.1.2-การนำเขาและเขยนขอมลประเภท-flat-file">เรื่องที่ 4.1.2 การนำเข้าและเขียนข้อมูลประเภท flat file</a>
  <ul>
  <li><a href="#การนำเขาและเขยนไฟลแบบ-csv" id="toc-การนำเขาและเขยนไฟลแบบ-csv" class="nav-link" data-scroll-target="#การนำเขาและเขยนไฟลแบบ-csv">การนำเข้าและเขียนไฟล์แบบ CSV</a>
  <ul class="collapse">
  <li><a href="#ภาษา-r-1" id="toc-ภาษา-r-1" class="nav-link" data-scroll-target="#ภาษา-r-1">ภาษา R</a></li>
  <li><a href="#ภาษา-python-1" id="toc-ภาษา-python-1" class="nav-link" data-scroll-target="#ภาษา-python-1">ภาษา Python</a></li>
  </ul></li>
  <li><a href="#การนำเขาและเขยนไฟลแบบ-tsv" id="toc-การนำเขาและเขยนไฟลแบบ-tsv" class="nav-link" data-scroll-target="#การนำเขาและเขยนไฟลแบบ-tsv"><strong>การนำเข้าและเขียนไฟล์แบบ TSV</strong></a>
  <ul class="collapse">
  <li><a href="#ภาษา-r-2" id="toc-ภาษา-r-2" class="nav-link" data-scroll-target="#ภาษา-r-2">ภาษา R</a></li>
  <li><a href="#ภาษา-python-2" id="toc-ภาษา-python-2" class="nav-link" data-scroll-target="#ภาษา-python-2">ภาษา Python</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#เรองท-4.1.3-การนำเขาและเขยนขอมลประเภท-spreadsheet" id="toc-เรองท-4.1.3-การนำเขาและเขยนขอมลประเภท-spreadsheet" class="nav-link" data-scroll-target="#เรองท-4.1.3-การนำเขาและเขยนขอมลประเภท-spreadsheet">เรื่องที่ 4.1.3 การนำเข้าและเขียนข้อมูลประเภท spreadsheet</a>
  <ul>
  <li><a href="#การนำเขาและเขยนไฟลขอมล-.xlsx" id="toc-การนำเขาและเขยนไฟลขอมล-.xlsx" class="nav-link" data-scroll-target="#การนำเขาและเขยนไฟลขอมล-.xlsx">การนำเข้าและเขียนไฟล์ข้อมูล .xlsx</a>
  <ul class="collapse">
  <li><a href="#ภาษา-r-3" id="toc-ภาษา-r-3" class="nav-link" data-scroll-target="#ภาษา-r-3">ภาษา R</a></li>
  <li><a href="#ภาษา-python-3" id="toc-ภาษา-python-3" class="nav-link" data-scroll-target="#ภาษา-python-3">ภาษา Python</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">ตอนที่ 4.1 การนำเข้าและเขียนชุดข้อมูล (importing and writing data)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>การนำเข้าข้อมูลถือได้ว่าเป็นขั้นตอนแรกของการดำเนินงานวิเคราะห์ข้อมูล ในบทเรียนนี้จะกล่าวถึงการนำเข้าข้อมูลลักษณะต่าง ๆ ในภาษา R และ Python รวมทั้งการเขียนชุดข้อมูลเป็นไฟล์ข้อมูลเพื่อนำไปใช้ตามวัตถุประสงค์ต่าง ๆ บทเรียนนี้จะกล่าวถึงการนำเข้าไฟล์ข้อมูลที่มักใช้ในการทำงานทางด้านสถิติและวิทยาการข้อมูล ได้แก่ ไฟล์ข้อมูลประเภท flat file และไฟล์ข้อมูลประเภท spreadsheet รายละเอียดมีดังนี้</p>
<section id="เรองท-4.1.1-การกำหนด-working-directory" class="level2">
<h2 class="anchored" data-anchor-id="เรองท-4.1.1-การกำหนด-working-directory">เรื่องที่ 4.1.1 การกำหนด working directory</h2>
<p>สิ่งสำคัญอย่างแรกที่ผู้ใช้ภาษา R และ Python จำเป็นต้องทราบก่อนที่จะนำเข้าหรือเขียนชุดข้อมูลคือการเรียกดูและกำหนด working directory ของโปรแกรม working directory คือ folder ที่ R หรือ Python ใช้สำหรับเรียกไฟล์ข้อมูลหรือบันทึกไฟล์ข้อมูล รวมทั้งไฟล์อื่น ๆ ที่เกี่ยวข้อง</p>
<section id="ภาษา-r" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-r">ภาษา R</h4>
<p>ใน R ผู้วิเคราะห์สามารถเรียกดู working directory ของโปรแกรมได้โดยใช้ฟังก์ชัน <code>getwd()</code> ดังตัวอย่างต่อไปนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/siwachoat/Desktop"</code></pre>
</div>
</div>
<p>ผลลัพธ์ในข้างต้นแสดงว่า working directory ที่กำหนดมีที่อยู่คือ “/Users/siwachoat/Desktop” ในกรณีที่ต้องการเปลี่ยนที่อยู่ของ working directory สามารถทำได้ด้วยฟังก์ชัน <code>setwd()</code> โดยกำหนดที่อยู่ของ working directory ที่ต้องการเอาไว้ภายใต้เครื่องหมาย quotation ยกตัวอย่างเช่นต้องการเปลี่ยน working directory จากเดิม “/Users/siwachoat/Desktop” เป็น “/Users/siwachoat/Documents” สามารถเขียนคำสั่งได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/Users/siwachoat/Documents"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/siwachoat/Documents"</code></pre>
</div>
</div>
<p>จากคำสั่งข้างต้นจะเห็นว่า working directory เปลี่ยนจาก “/Users/siwachoat/Desktop” ไปเป็น “/Users/siwachoat/Documents” ตามที่ต้องการ</p>
<p><strong>หมายเหตุ :</strong> เนื่องจากที่อยู่ของ working directory อาจเป็น subfolder ภายใต้ folder ใด ๆ บนเครื่องคอมพิวเตอร์ การกำหนดที่อยู่ของ working directory ที่ต้องการจึงจะกำหนดโดยเขียนเรียงเป็นลำดับชั้นจาก directory ที่อยู่บนสุดลงไปจาก subdirectory ที่อยู่ภายใต้ directory นั้น และจะมีการใช้สัญลักษณ์ <code>\</code> หรือ <code>//</code> อย่างใดอย่างหนึ่งเป็นตัวคั่นระหว่าง directory กับ subdirectory ดังกล่าว</p>
</section>
<section id="ภาษา-python" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-python">ภาษา Python</h4>
<p>สำหรับภาษา Python การเรียกดูและกำหนด working directory สามารถทำได้ด้วย library os โดยใช้ฟังก์ชัน <code>os.getcwd()</code> และ <code>os.chdir()</code> ตามลำดับ ตัวอย่างต่อไปนี้แสดงการเรียกดู working directory ในภาษา Python</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>os.getcwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'/Users/siwachoat/Library/CloudStorage/OneDrive-ChulalongkornUniversity/Documents/บริการวิชาการ/chapterbook มสธ./chapter/chapter'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">"/Users/siwachoat/Desktop"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>os.getcwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'/Users/siwachoat/Desktop'</code></pre>
</div>
</div>
<p>ในทำนองเดียวกับตัวอย่างในภาษา R ผลลัพธ์ข้างต้นแสดงให้เห็นว่า working directory ที่กำหนดไว้คือ “/Users/siwachoat/Desktop” ในกรณีที่ต้องการเปลี่ยน working directory ดังกล่าวสามารถได้โดยเขียนคำสั่งในทำนองเดียวกับโปรแกรม R ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">"/Users/siwachoat/Documents"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>os.getcwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'/Users/siwachoat/Documents'</code></pre>
</div>
</div>
</section>
</section>
<section id="เรองท-4.1.2-การนำเขาและเขยนขอมลประเภท-flat-file" class="level2">
<h2 class="anchored" data-anchor-id="เรองท-4.1.2-การนำเขาและเขยนขอมลประเภท-flat-file">เรื่องที่ 4.1.2 การนำเข้าและเขียนข้อมูลประเภท flat file</h2>
<p>flat files เป็นไฟล์ข้อมูลที่อยู่ในรูปแบบข้อความ (plain text) และชุดข้อมูลไม่ได้มีโครงสร้างการจัดเก็บในรูปแบบตารางหรือ spreadsheet แต่ flat file จะมีการใช้ตัวอักษรพิเศษ เช่น comma (,), slash (/) หรือ underscore (_) เป็นตัวคั่น (separator or delimiter) เพื่อจำแนกข้อมูลที่แตกต่างกันออกจากกัน รูป 4.1 แสดงลักษณะของชุดข้อมูลแบบ flat file ที่มีการใช้ตัวคั่นแบบ comma (,) และแบบเว้นวรรค (tab) จากรูปจะเห็นว่าตัวอย่างของไฟล์ข้อมูลทั้งสองมีโครงสร้างการจัดเก็บข้อมูลที่เหมือนกันกล่าวคือ ในแถวแรกของไฟล์ข้อมูลเป็นที่จัดเก็บชื่อของตัวแปรภายในชุดข้อมูล และตั้งแต่แถวที่สองเป็นต้นไปเป็นที่จัดเก็บข้อมูลของตัวแปรต่าง ๆ ของแต่ละหน่วยข้อมูล อย่างไรก็ตามในทางปฏิบัติแถวแรกของไฟล์ข้อมูลไม่จำเป็นจะต้องเป็นชื่อของตัวแปรเสมอไป</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="flatfile.png" class="img-fluid figure-img" style="width:60.0%"></p>
<p></p><figcaption class="figure-caption">รูป 4.1 ตัวอย่างโครงสร้างของ flat file แบบ CSV และ TSV</figcaption><p></p>
</figure>
</div>
<p>ที่มา : สิวะโชติ ศรีสุทธิยากร (2564)</p>
<p>flat file ยังมีการเรียกชื่อที่เฉพาะตามลักษณะของตัวคั่นที่ใช้ในชุดข้อมูล จากรูปจะเห็นว่าชุดข้อมูลด้านบนมีการใช้ comma (,) เป็นตัวคั่น จะเรียกไฟล์ข้อมูลประเภทนี้ว่า comma separated values (CSV) หรืออาจเรียกว่า comma-delimited ก็ได้ ส่วนชุดข้อมูลด้านล่างของรูปมีการใช้ตัวคั่นเป็นการเว้นวรรค (tab) จะเรียกชุดข้อมูลประเภทนี้ว่า tab separated values (TSV) หรือ tab-delimited</p>
<section id="การนำเขาและเขยนไฟลแบบ-csv" class="level3">
<h3 class="anchored" data-anchor-id="การนำเขาและเขยนไฟลแบบ-csv">การนำเข้าและเขียนไฟล์แบบ CSV</h3>
<p>หัวข้อนี้จะกล่าวถึงวิธีการนำเข้าและเขียนไฟล์ข้อมูลแบบ CSV โดยจำแนกเนื้อหาออกเป็นสองส่วนได้แก่ ส่วนของภาษา R และ ภาษา Python รายละเอียดมีดังนี้</p>
<section id="ภาษา-r-1" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-r-1">ภาษา R</h4>
<p>ภาษา R สามารถนำเข้าและเขียนไฟล์ CSV ได้หลายวิธี วิธีการแรกเป็นการนำเข้าด้วยฟังก์ชันจาก package-utils ที่เป็น package พื้นฐานของ R ได้แก่ฟังก์ชัน <code>read.csv()</code> ที่มีอาร์กิวเมนท์สำคัญได้แก่ <code>file</code> ใช้ระบุที่อยู่และชื่อของไฟล์ข้อมูลแบบ CSV ที่ต้องการนำเข้าอาร์กิวเมนท์นี้ผู้วิเคราะห์จำเป็นต้องกำหนดแบบตัวแปรตัวอักษร (กล่าวคือต้องระบุไว้ภายใต้เครื่องหมาย quotation) อาร์กิวเมนท์ <code>header</code> ใช้ระบุว่าไฟล์ข้อมูลที่นำเข้ามีแถวแรกของไฟล์เป็นชื่อของตัวแปรหรือไม่ การกำหนดอาร์กิวเมนท์นี้กำหนดเป็นค่าความจริงได้แก่ <code>TRUE</code> หรือ <code>FALSE</code> โดยหากกำหนดเป็น <code>TRUE</code> (ค่าเริ่มต้น) จะหมายถึงการระบุว่าใช้แถวแรกของไฟล์ข้อมูลเป็นชื่อของตัวแปรในแต่ละคอลัมน์ ในกรณีที่กำหนดเป็น <code>FALSE</code> ฟังก์ชัน CSV จะกำหนดชื่อของคอลัมน์ให้โดยอัตโนมัติ ตัวอย่างด้านล่างแสดงการนำเข้าชุดข้อมูล <a href="https://github.com/ssiwacho/dataset/blob/main/gapminder_mini.csv"><code>gapminder_mini.csv</code></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R syntax</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"gapminder_mini.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   142 obs. of  4 variables:
 $ X        : int  1 2 3 4 5 6 7 8 9 10 ...
 $ country  : chr  "Afghanistan" "Albania" "Algeria" "Angola" ...
 $ gdpPercap: num  975 5937 6223 4797 12779 ...
 $ lifeExp  : num  43.8 76.4 72.3 42.7 75.3 ...</code></pre>
</div>
</div>
<p>อาร์กิวเมนท์อีกตัวที่สำคัญของฟังก์ชัน <code>read.csv()</code> คืออาร์กิวเมนท์ <code>na.strings</code> ใช้ในกรณีที่ชุดข้อมูลที่ต้องการนำเข้ามีค่าสูญหาย การระบุอาร์กิวเมนท์ดังกล่าวให้ระบุเป็นสัญลักษณ์ที่ใช้แทนค่าสูญหายของชุดข้อมูลที่ต้องการนำเข้า เช่น หากชุดข้อมูลที่นำเข้าใช้สัญลักษณ์ <code>-999</code> แทนค่าสูญหายให้กำหนด <code>na.strings = -999</code> เป็นต้น นอกจากนี้ฟังก์ชัน <code>read.csv()</code> ยังมีอาร์กิวเมนท์ <code>stringsAsFactors</code> ที่กำหนดค่าเป็น <code>TRUE</code> หรือ <code>FALSE</code> เพื่อแปลงคอลัมน์ตัวอักษรในชุดข้อมูลให้เป็นตัวแปรแบบ factor ซึ่งเป็นตัวแปรแบบจัดประเภทของ R ผู้อ่านสามารถศึกษารายละเอียดเพิ่มเติมได้จาก สิวะโชติ ศรีสุทธิยากร (2564) หน้า 40</p>
<p>ตัวอย่างข้างต้นมีการใช้ฟังก์ชัน <code>str()</code> เพื่อเรียกดูข้อมูลเบื้องต้นของชุดข้อมูล <code>gapminder_mini.csv</code> ที่นำเข้ามาด้วยฟังก์ชัน <code>read.csv()</code> ในข้างต้น ฟังก์ชันดังกล่าวจะรายงานมิติหรือขนาดของชุดข้อมูล ชื่อของตัวแปรในแต่ละคอลัมนท์ รวมทั้งคุณลักษณะของตัวแปรภายในแต่ละคอลัมน์ สำหรับผู้ที่เคยใช้ SPSS จะพอเทียบเคียงได้ว่าผลลัพธ์จากฟังก์ชัน <code>str()</code> นี้จะให้สารสนเทศในทำนองเดียวกับหน้าต่าง variable view ของโปรแกรม SPSS รายละเอียดของฟังก์ชันนี้จะกล่าวอีกครั้งหนึ่งในหัวข้อ 4.2</p>
<p>ภาษา R ยังมีความสามารถในการเขียนไฟล์ชุดข้อมูลเพื่อส่งออกไปบันทึกในคอมพิวเตอร์สำหรับนำไปใช้ในวัตถุประสงค์ต่าง ๆ การเขียนไฟล์แบบ CSV สามารถทำได้หลายวิธีการเช่นกัน วิธีการพื้นฐานคือการใช้ฟังก์ชัน <code>write.csv()</code> ที่มีอาร์กิวเมนท์สำคัญ 2 ตัวได้แก่ <code>x</code> คือชุดข้อมูลแบบ Dataframe ที่ต้องการเขียนออกไปเป็นไฟล์แบบ CSV และ <code>file</code> ใช้ระบุที่อยู่และชื่อของไฟล์ปลายทางที่จะให้ R เขียนออกไปบันทึกในคอมพิวเตอร์ ทั้งนี้รูปแบบของชื่อไฟล์ต้องเขียนในลักษณะตัวอักษรกล่าวคืออยู่ภายใต้เครื่องหมาย quotation และมีนามสกุลของไฟล์เป็นแบบ `*.csv` ดังตัวอย่างด้านล่าง</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R syntax</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dat, <span class="at">file=</span><span class="st">"Desktop/mydata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>คำสั่งด้านบนจะเขียนไฟล์ <code>my.data.csv</code> ไว้บน Desktop ของเครื่องคอมพิวเตอร์ ในกรณีที่ผู้วิเคราะห์กำหนดแค่ชื่อไฟล์ปลายทางแต่ไม่ได้กำหนดที่อยู่ของไฟล์ เช่น <code>write.csv(dat, file="mydata.csv")</code> ไฟล์ที่สร้างขึ้นจะบันทึกไว้ใน folder เป็นค่าเริ่มต้นหรือ folder ที่กำหนดเป็น working directory เอาไว้ การกำหนด working directory สามารถทำได้โดยใช้ฟังก์ชัน <code>setwd()</code> โดยภายในฟังก์ชันให้ใส่ที่อยู่ของ folder ที่ต้องการกำหนดให้เป็น working directory ในลักษณะตัวอักษร เช่น <code>setwd("/Desktop/myjob")</code> หมายถึงกำหนดให้ working directory เป็น folder myjob ที่อยู่บน Desktop ของเครื่องคอมพิวเตอร์ รายละเอียดอื่น ๆ เกี่ยวกับการกำหนด working directory ใน R สามารถศึกษาเพิ่มเติมได้จาก สิวะโชติ ศรีสุทธิยากร (2564)</p>
<p>รูปด้านล่างแสดงลักษณะของไฟล์ข้อมูล <code>mydata.csv</code> ที่เขียนออกจากโปรแกรม R ด้วยคำสั่งในข้างต้น จากรูปใช้โปรแกรม text editor เพื่อเปิดไฟล์ดังกล่าว</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/paste-8BAEF8C0.png" class="img-fluid figure-img" width="300"></p>
<p></p><figcaption class="figure-caption">ไฟล์ข้อมูล myCSV.csv</figcaption><p></p>
</figure>
</div>
<p>โดยปกติแล้ว MS Excel หรือ Number หรือ googlesheet มีตัวอ่านไฟล์ข้อมูลประเภท flatfile อยู่แล้วผู้อ่านสามารถใช้โปรแกรมดังกล่าวเพื่อเปิดไฟล์ข้อมูลประเภท CSV หรือ flatfile ประเภทอื่น ๆ ได้โดยง่าย</p>
</section>
<section id="ภาษา-python-1" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-python-1">ภาษา Python</h4>
<p>สำหรับการนำเข้าและเขียนไฟล์ข้อมูลแบบ CSV ด้วยภาษา Python สามารถทำได้โดยใช้ฟังก์ชัน <code>pd.read_csv()</code> ของ pandas library ฟังก์ชันนี้มีพารามิเตอร์ได้แก่ <code>filepath</code> ใช้กำหนดที่อยู่และชื่อของไฟล์ที่ต้องการนำเข้า พารามิเตอร์ <code>sep</code> สำหรับระบุตัวอักษรที่ใช้เป็นตัวคั่นในชุดข้อมูล ซึ่งในกรณีนี้จะกำหนดให้ <code>sep=","</code> เพื่อนำเข้าชุดข้อมูลแบบ CSV พารามิเตอร์ <code>header</code> สำหรับระบุว่าแถวที่เท่าไหร่ในตารางข้อมูลจะใช้เป็นชื่อของตัวแปร (เริ่มจาก 0) พารามิเตอร์ <code>skiprows</code> ใช้กำหนดให้ Python อ่านไฟล์ข้อมูลโดยข้ามแถวไปจำนวนเท่ากับที่กำหนด พารามิเตอร์นี้มีประโยชน์มากสำหรับการนำเข้าไฟล์ข้อมูลจากองค์กร หรือ logfile ที่หัวของตารางมักมีคำอธิบายหรือ caption ต่าง ๆ ก่อนที่จะเป็นส่วนของตารางข้อมูล ฟังก์ชัน <code>pd.read_csv()</code> ยังมีพารามิเตอร์อีกหลายตัว (optional parameters) ที่สามารถกำหนดเพื่อปรับแต่งลักษณะของข้อมูลที่นำเข้ามาได้ รายละเอียดอื่น ๆ ผู้อ่านสามารถศึกษาเพิ่มเติมได้จาก <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html" class="uri">https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python syntax</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> pd.read_csv(<span class="st">"/Users/siwachoat/Downloads/gapminder.csv"</span>, header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Unnamed: 0             country     gdpPercap  lifeExp
0             1         Afghanistan    974.580338   43.828
1             2             Albania   5937.029526   76.423
2             3             Algeria   6223.367465   72.301
3             4              Angola   4797.231267   42.731
4             5           Argentina  12779.379640   75.320
..          ...                 ...           ...      ...
137         138             Vietnam   2441.576404   74.249
138         139  West Bank and Gaza   3025.349798   73.422
139         140         Yemen, Rep.   2280.769906   62.698
140         141              Zambia   1271.211593   42.384
141         142            Zimbabwe    469.709298   43.487

[142 rows x 4 columns]</code></pre>
</div>
</div>
<p>การเขียนไฟล์ CSV ด้วยภาษา Python สามารถทำได้หลายวิธี วิธีการหนึ่งคือการใช้ method <code>to_csv()</code> ซึ่งเป็น method หนึ่งภายใต้ pandas library พารามิเตอร์สำคัญของ method นี้ได้แก่ ตัวอย่างด้านล่างแสดงการเขียนไฟล์ข้อมูลใน Python เพื่อบันทึกลงใน folder ที่กำหนดไว้บนเครื่องคอมพิวเตอร์ สมมุติว่าผู้วิเคราะห์สร้างชุดข้อมูลใน Python เพื่อเก็บข้อมูลคะแนนสอบของนิสิตในรายวิชาแคลคูลัส (calculus) สถิติ (statistics) และคณิตศาสตร์ (math) การเขียนไฟล์ข้อมูลดังกล่าวเป็นไฟล์ CSV สามารถทำได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>header <span class="op">=</span> [<span class="st">"students"</span>,<span class="st">"calculus"</span>,<span class="st">"statistics"</span>,<span class="st">"math"</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>row_data <span class="op">=</span> [[<span class="dv">1</span>,<span class="dv">80</span>,<span class="dv">75</span>,<span class="dv">70</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">2</span>,<span class="dv">40</span>,<span class="dv">55</span>,<span class="dv">60</span>],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">3</span>,<span class="dv">84</span>,<span class="dv">85</span>,<span class="dv">86</span>],</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">4</span>,<span class="dv">51</span>,<span class="dv">38</span>,<span class="dv">43</span>],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">5</span>,<span class="dv">67</span>,<span class="dv">73</span>,<span class="dv">77</span>]]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(row_data, columns<span class="op">=</span>header)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   students  calculus  statistics  math
0         1        80          75    70
1         2        40          55    60
2         3        84          85    86
3         4        51          38    43
4         5        67          73    77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data.to_csv(<span class="st">"myCSV.csv"</span>, sep<span class="op">=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>ผู้อ่านสามารถศึกษารายละเอียดของ <code>to_csv()</code> ได้จาก <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_csv.html" class="uri">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_csv.html</a></p>
</section>
</section>
<section id="การนำเขาและเขยนไฟลแบบ-tsv" class="level3">
<h3 class="anchored" data-anchor-id="การนำเขาและเขยนไฟลแบบ-tsv"><strong>การนำเข้าและเขียนไฟล์แบบ TSV</strong></h3>
<p>ดังที่กล่าวไปแล้วข้างต้น ไฟล์แบบ TSV เป็นไฟล์ข้อมูลแบบ flat file ที่มีการใช้ตัวคั่นข้อมูลเป็นเครื่องหมายเว้นวรรค (tab) การนำเข้าไฟล์ข้อมูล TSV การนำเข้าและเขียนไฟล์ลักษณะดังกล่าวของแต่ละภาษาจึงสามารถดำเนินการได้ในทำนองเดียวกับไฟล์แบบ CSV รายละเอียดมีดังนี้</p>
<section id="ภาษา-r-2" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-r-2">ภาษา R</h4>
<p>ในภาษา R สามารถทำได้โดยใช้ฟังก์ชัน <code>read.table()</code> โดยอาร์กิวเมนท์ของฟังก์ชันนี้มีส่วนของอาร์กิวเมนท์จำเป็นที่เหมือนกับของฟังก์ชัน <code>read.csv()</code> ได้แก่ <code>file</code> ที่ใช้ระบุที่อยู่และชื่อของไฟล์ข้อมูลที่ต้องการนำเข้า โดยจะต้องระบุในลักษณะของตัวแปรตัวอักษรใน R กล่าวคือต้องระบุภายใต้เครื่องหมาย quotation อาร์กิวเมนท์ <code>header</code> ที่กำหนดได้ 2 ค่าคือ <code>TRUE</code> และ <code>FALSE</code> โดยที่ค่าเริ่มต้นคือ <code>header=FALSE</code> ซึ่งหมายความว่าตารางข้อมูลที่จะนำเข้ามานั้นเป็นตารางที่ไม่มีหัวตาราง และอาร์กิวเมนท์ <code>sep</code> ใช้ระบุลักษณะของตัวคั่นข้อมูลที่ใช้ในไฟล์ข้อมูล อาร์กิวเมนท์นี้จึงทำให้ฟังก์ชัน <code>read.table()</code> สามารถนำเข้า flat file ได้หลายประเภทไม่ได้จำกัดแค่เฉพาะ CSV หรือ TSV เท่านั้น นอกจากนี้ยังมีอาร์กิวเมนท์ <code>skip</code> ที่ทำงานเหมือนกับพารามิเตอร์ <code>skiprows</code> ในฟังก์ชัน <code>pd.read_csv()</code> ของภาษา Python ฟังก์ชัน <code>read.table()</code> เป็นฟังก์ชันที่มีอาร์กิวเมนท์ที่สามารถกำหนดได้จำนวนมาก รายละเอียดอื่น ๆ เกี่ยวข้องผู้อ่านสามารถศึกษาได้จากคู่มือของฟังก์ชันโดยพิมพ์คำสั่ง <code>?read.table()</code></p>
<p>จากที่กล่าวในข้างต้นจะเห็นว่า <code>read.table()</code> เป็นฟังก์ชันทั่วไปของ <code>read.csv()</code> ตัวอย่างต่อไปนี้แสดงให้เห็นว่าสามารถใช้ฟังก์ชัน <code>read.table()</code> เพื่อนำเข้าไฟล์แบบ CSV ได้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"/Users/siwachoat/Downloads/gapminder.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X     country  gdpPercap lifeExp
1 1 Afghanistan   974.5803  43.828
2 2     Albania  5937.0295  76.423
3 3     Algeria  6223.3675  72.301
4 4      Angola  4797.2313  42.731
5 5   Argentina 12779.3796  75.320
6 6   Australia 34435.3674  81.235</code></pre>
</div>
</div>
<p>ชุดข้อมูล <a href="https://raw.githubusercontent.com/ssiwacho/dataset/main/myTSV.txt">myTSV.txt</a> เป็นชุดข้อมูลแบบ flat file ที่มีการใช้ตัวคั่นเป็นเครื่องหมายเว้นวรรค (tab) การนำชุดข้อมูลดังกล่าวเข้าสู่โปรแกรม R ด้วยฟังก์ชัน <code>read.table()</code> สามารถทำได้โดยกำหนดอาร์กิวเมนท์ <code>sep = " "</code> ดังตัวอย่างต่อไปนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dat_TSV <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"https://raw.githubusercontent.com/ssiwacho/dataset/main/myTSV.txt"</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>dat_TSV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X students calculus statistics math
1 0        1       80         75   70
2 1        2       40         55   60
3 2        3       84         85   86
4 3        4       51         38   43
5 4        5       67         73   77</code></pre>
</div>
</div>
<p>ในทำนองเดียวกับการนำเข้าและเขียนไฟล์ CSV การเขียนไฟล์ TSV สามารถทำได้โดยใช้ฟังก์ชัน <code>write.table()</code> ที่มีอาร์กิวเมนท์สำคัญเหมือนกับฟังก์ชัน <code>write.csv()</code> ทุกประการ ความแตกต่างระหว่าง <code>write.table()</code> กับ <code>write.csv()</code> อันหนึ่งคือฟังก์ชัน <code>write.table()</code> มีอาร์กิวเมนท์ <code>sep</code> ที่ทำให้ผู้วิเคราะห์สามารถเลือกกำหนดได้ว่าจะเขียนไฟล์ข้อมูลของตนเองโดยใช้ตัวคั่นแบบใด ตัวอย่างต่อไปนี้แสดงการเขียนไฟล์ TSV ด้วยฟังก์ชัน <code>write.table()</code> จากชุดข้อมูลแบบ data.frame ที่สร้างเองบนโปรแกรม R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#เพศของนักเรียน</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"M"</span>,<span class="st">"F"</span>,<span class="st">"F"</span>,<span class="st">"F"</span>,<span class="st">"M"</span>) </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#วิธีการสอนของครู</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LEC"</span>,<span class="st">"LEC"</span>,<span class="st">"LEC"</span>,<span class="st">"PBL"</span>,<span class="st">"PBL"</span>,<span class="st">"PBL"</span>) </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># คะแนนสอบวิชา Eng</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>eng <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="fl">5.5</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="fl">8.5</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>mydat<span class="ot">&lt;-</span><span class="fu">data.frame</span>(gender, method, eng)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>mydat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  gender method eng
1      M    LEC 6.0
2      M    LEC 5.5
3      F    LEC 7.0
4      F    PBL 7.0
5      F    PBL 8.0
6      M    PBL 8.5</code></pre>
</div>
</div>
<p>ชุดคำสั่งข้างต้นเป็นการสร้างชุดข้อมูลแบบ data.frame ในโปรแกรม R ด้วยฟังก์ชัน <code>data.frame()</code> โดยเก็บชุดข้อมูลดังกล่าวเอาไว้ในตัวแปรชื่อ <code>mydat</code> การเขียนชุดข้อมูลนี้ออกไปบนเครื่องคอมพิวเตอร์เพื่อเก็บเป็นไฟล์ข้อมูลประเภท TSV สามารถดำเนินการได้ด้วยฟังก์ชัน <code>write.table()</code> ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(mydat, <span class="at">file=</span><span class="st">"mytsvfromR.txt"</span>, <span class="at">sep=</span><span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>รูปต่อไปนี้แสดงลักษณะของไฟล์ข้อมูล <code>mstsvformR.txt</code> ที่เขียนด้วยฟังก์ชัน <code>write.table()</code> ในข้างต้น จากรูปไฟล์ข้อมูลดังกล่าวเปิดด้วยโปรแกรม text editor</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/paste-C00C266B.png" class="img-fluid figure-img" width="250"></p>
<p></p><figcaption class="figure-caption">ไฟล์ข้อมูล mytsvfromR.txt</figcaption><p></p>
</figure>
</div>
</section>
<section id="ภาษา-python-2" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-python-2">ภาษา Python</h4>
<p>สำหรับภาษา Python การนำเข้าและเขียนไฟล์ TSV รวมทั้ง flat file แบบอื่น ๆ สามารถทำได้ด้วยฟังก์ชัน <code>pd.read_csv()</code> โดยเปลี่ยนค่าของพารามิเตอร์ <code>sep</code> ให้ตรงกับตัวคั่นที่ใช้ในไฟล์ข้อมูล ยกตัวอย่างเช่น หากต้องการนำเข้าชุดข้อมูล <a href="https://raw.githubusercontent.com/ssiwacho/dataset/main/myTSV.txt">myTSV.txt</a> สามารถดำเนินการได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dat_TSV <span class="op">=</span> pd.read_csv(<span class="st">"myTSV.txt"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                      header <span class="op">=</span> <span class="dv">0</span>, sep <span class="op">=</span> <span class="st">" "</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>dat_TSV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Unnamed: 0  students  calculus  statistics  math
0           0         1        80          75    70
1           1         2        40          55    60
2           2         3        84          85    86
3           3         4        51          38    43
4           4         5        67          73    77</code></pre>
</div>
</div>
<p>ในทำนองเดียวกันการเขียนไฟล์แบบ TSV ในภาษา Python สามารถทำได้ด้วยฟังก์ชัน <code>data.to_csv()</code> เหมือนกับที่ใช้เขียนไฟล์ CSV โดยเปลี่ยนตัวคั่นให้ตรงกับลักษณะไฟล์ที่ต้องการเขียนออกไปเก็บไว้บนคอมพิวเตอร์ ตัวอย่างต่อไปนี้แสดงการเขียนชุดข้อมูล <code>dat_TSV</code> ในตัวอย่างที่แล้วออกไปเป็นไฟล์ TSV บนเครื่องคอมพิวเตอร์</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dat_TSV.to_csv(<span class="st">"Dataframe_to_TSV_python.txt"</span>, sep<span class="op">=</span><span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="เรองท-4.1.3-การนำเขาและเขยนขอมลประเภท-spreadsheet" class="level2">
<h2 class="anchored" data-anchor-id="เรองท-4.1.3-การนำเขาและเขยนขอมลประเภท-spreadsheet">เรื่องที่ 4.1.3 การนำเข้าและเขียนข้อมูลประเภท spreadsheet</h2>
<p>ไฟล์ข้อมูลประเภท spreadsheet เป็นไฟล์ที่มีการจัดเก็บข้อมูลในรูปแบบตารางซึ่งเป็นรูปแบบไฟล์ที่นิยมใช้ในโปรแกรมสำเร็จรูปสำหรับการคำนวณและจัดการข้อมูล เช่น Microsoft Excel, Number หรือ googlesheet หัวข้อนี้จะกล่าวถึงวิธีการนำเข้าและเขียนไฟล์ข้อมูลประเภทดังกล่าวรายละเอียดมีดังนี้</p>
<section id="การนำเขาและเขยนไฟลขอมล-.xlsx" class="level3">
<h3 class="anchored" data-anchor-id="การนำเขาและเขยนไฟลขอมล-.xlsx">การนำเข้าและเขียนไฟล์ข้อมูล .xlsx</h3>
<p>ไฟล์ข้อมูล .xlsx เป็นไฟล์ข้อมูลของโปรแกรม Microsoft Excel (MS Excel) พื้นที่ภายในไฟล์ดังกล่าวเรียกว่า workbook โดยภายในแต่ละ workbook ประกอบด้วย worksheet ที่เป็นพื้นที่สำหรับจัดการข้อมูลและการคำนวณ worksheet ดังกล่าวมีลักษณะเป็นตาราง โดยภายในหนึ่ง workbook สามารถมีได้หลาย worksheet รูปต่อไปนี้แสดงตัวอย่าง workbook ของโปรแกรม MS Excel</p>
<section id="ภาษา-r-3" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-r-3">ภาษา R</h4>
<p>การนำเข้าไฟล์ข้อมูล .xlsx ในโปรแกรม R สามารถทำได้หลายวิธีการ วิธีการหนึ่งคือการใช้ฟังก์ชัน <code>read_excel()</code> ภายใต้ package-readxl ทั้งนี้ก่อนใช้งานฟังก์ชันดังกล่าวผู้วิเคราะห์ต้องดาวน์โหลดและติดตั้ง package ดังกล่าวโดยพิมพ์คำสั่งต่อไปนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"readxl"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>ไฟล์ข้อมูล <a href="https://github.com/ssiwacho/dataset/blob/main/IQ.xlsx?raw=true"><code>IQ.xlsx</code></a> เป็นไฟล์ .xlsx ที่บันทึกข้อมูลคะแนนเชาว์ปัญญา (iq) ของนักเรียนจำแนกตามจังหวัด เพศ และอายุ เมื่อผู้วิเคราะห์ดาวน์โหลดไฟล์ข้อมูลดังกล่าวลงในคอมพิวเตอร์แล้ว สามารถนำเข้าไฟล์ข้อมูล <code>IQ.xlsx</code> ได้โดยพิมพ์คำสั่งดังนี้</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>iq <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"iq.xlsx"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>iq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
      id `จังหวัด` gender.age    IQ
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;
 1     1 กรุงเทพฯ ชาย/14        80
 2     2 กรุงเทพฯ ชาย/24       101
 3     3 กรุงเทพฯ ชาย/25       105
 4     4 กรุงเทพฯ หญิง/54        99
 5     5 กรุงเทพฯ ชาย/18       100
 6     6 กรุงเทพฯ หญิง/65       105
 7     7 เชียงใหม่ ชาย/14        90
 8     8 เชียงใหม่ หญิง/15       110
 9     9 เชียงใหม่ ชาย/37       103
10    10 เชียงใหม่ หญิง/28       108
11    11 เชียงใหม่ ชาย/44        98
12    12 เชียงใหม่ หญิง/34       106</code></pre>
</div>
</div>
<p>เนื่องจากภายในไฟล์ .xlsx อาจมี worksheet ได้มากกว่าหนึ่ง worksheet ในกรณีดังกล่าวการนำเข้าไฟล์ข้อมูลจึงต้องระบุเพิ่มเติมด้วยว่าผู้วิเคราะห์จะเลือกเอา worksheet ตัวไหนเข้าสู่ R พิจารณาไฟล์ข้อมูล <a href="http://bit.ly/2EjFOnS"><code>Score.xlsx</code></a> (สิวะโชติ ศรีสุทธิยากร, 2564) เมื่อดาวน์โหลดและเปิดไฟล์ข้อมูลนี้ในโปรแกรม MS Excel ผู้อ่านจะเห็นว่าไฟล์ข้อมูลดังกล่าวประกอบด้วย worksheet จำนวน 2 worksheet ได้แก่ “Score” และ “Score3” ในกรณีที่ผู้วิเคราะห์ใช้โปรแกรม R เป็นหลักสามารถเรียกดู worksheet ต่าง ๆ ในไฟล์ .xlsx ได้โดยใช้ฟังก์ชัน <code>excel_sheets()</code> ของ package readxl เช่นเดียวกัน ดังตัวอย่างต่อไปนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(<span class="st">"Score.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Score"  "Score3"</code></pre>
</div>
</div>
<p>จากไฟล์ข้อมูล <code>Score.xlsx</code> ข้างต้น หากผู้วิเคราะห์ต้องการนำเข้า worksheet “Score3” สามารถดำเนินการได้โดยใช้ฟังก์ชัน <code>read_excel()</code> เหมือนเดิม แต่จะต้องมีกำหนดอาร์กิวเมนท์ <code>sheet</code> เพื่อระบุว่าต้องการนำเข้า worksheet ใดของไฟล์ข้อมูล การระบุอาร์กิวเมนท์ <code>sheet</code> ดังกล่าวสามารถทำได้สองลักษณะ ลักษณะแรกคือการระบุเป็นชื่อของ worksheet โดยตรงในกรณีนี้คือ <code>sheet = "Score3"</code> และลักษณะที่สองระบุด้วยลำดับของ worksheet โดยในกรณีที่ต้องการ worksheet “Score3” ให้กำหนดเป็น <code>sheet = 2</code> ตัวอย่างต่อไปนี้แสดงการนำเข้าชุดข้อมูลใน worksheet “Score3” จากไฟล์ข้อมูล <code>Score.xlsx</code> ดังกล่าว</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>score3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Score.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Score3"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(score3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  M     `2.7`   `9`   `4` `17.600000000000001`
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                &lt;dbl&gt;
1 F       2.9    22   3.2                 23  
2 M       3.3    12   4                   13.7
3 M       4.2    16   4.8                 18  
4 M       4.4    23   4.5                 14.9
5 F       4.7    20   5.2                 25.8
6 F       5.4    17   2.7                 13.8</code></pre>
</div>
</div>
<p><strong>หมายเหตุ :</strong> ตัวอย่างข้างต้นมีการใช้ฟังก์ชัน <code>head()</code> กับชุดข้อมูล <code>score3</code> ฟังก์ชันดังกล่าวมีหน้าที่กำหนดการแสดงผลของโปรแกรม R โดยจะแสดงชุดข้อมูล <code>score</code> เพียง 6 ค่าแรก ทั้งนี้เพื่อลดความวุ่นวายในหน้าต่างแสดงผล รายละเอียดของฟังก์ชัน <code>head()</code> นี้จะกล่าวถึงอีกครั้งหนึ่งในภายหลัง</p>
<p>จากผลลัพธ์ที่ได้ในตัวอย่างที่ผ่านมาผู้อ่านจะเห็นว่า การนำเข้าข้อมูลดังกล่าวยังไม่ถูกต้อง ทั้งนี้เป็นเพราะหากกลับไปดูที่ไฟล์ข้อมูลต้นฉบับผู้อ่านจะพบว่าชุดข้อมูลใน worksheet “Score3” ไม่ได้มีการกำหนดชื่อของคอลัมน์ไว้ เมื่อนำเข้าด้วยฟังก์ชัน <code>read_excel()</code> ดังในตัวอย่าง โปรแกรมจะนำข้อมูลในแถวแรกไปเป็นชื่อคอลัมน์โดยอัตโนมัติ ในกรณีเช่นนี้ผู้วิเคราะห์สามารถกำหนดอาร์กิวเมนท์ <code>col_names</code> เพิ่มเติม ค่าเริ่มต้นของฟังก์ชัน <code>read_excel()</code> กำหนดให้ <code>col_names = TRUE</code> ซึ่งหมายถึงฟังก์ชันจะกำหนดให้แถวแรกของชุดข้อมูลเป็นชื่อของตัวแปร ในทางกลับกันหากกำหนดให้ <code>col_names = FALSE</code> ฟังก์ชันจะ generate ชื่อของคอลัมน์ขึ้นมาต่างหาก ดังตัวอย่างต่อไปนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>score3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Score.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Score3"</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`
• `` -&gt; `...2`
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(score3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  ...1   ...2  ...3  ...4  ...5
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 M       2.7     9   4    17.6
2 F       2.9    22   3.2  23  
3 M       3.3    12   4    13.7
4 M       4.2    16   4.8  18  
5 M       4.4    23   4.5  14.9
6 F       4.7    20   5.2  25.8</code></pre>
</div>
</div>
<p>จากผลลัพธ์ข้างต้นจะเห็นว่า เมื่อกำหนดให้ <code>col_names = FALSE</code> ฟังก์ชัน <code>read_excel()</code> จะสร้างชื่อของแต่ละคอลัมน์ขึ้นมาให้เป็น <code>…1</code>, <code>…2</code>, …, .<code>…5</code> ตามลำดับ ในกรณีที่ผู้วิเคราะห์ต้องการกำหนดชื่อของคอลัมน์เองสามารถกำหนดผ่านอาร์กิวเมนท์ <code>col_names</code> ดังกล่าวได้เลย โดยกำหนดในลักษณะเวกเตอร์ตัวอักษร (character vector) เช่นต้องการกำหนดให้คอลัมน์ทั้ง 5 ใน worksheet “Score3” เป็น <code>gender</code>, <code>attitude_pre</code>, <code>problem_solving</code>, <code>attitude_post</code>, <code>ach_score</code> สามารถเขียนคำสั่งได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>score3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Score.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Score3"</span>, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"gender"</span>, <span class="st">"attitude_pre"</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"problem_solving"</span>, <span class="st">"attitude_post"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"ach_score"</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>score3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
   gender attitude_pre problem_solving attitude_post ach_score
   &lt;chr&gt;         &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
 1 M               2.7               9           4        17.6
 2 F               2.9              22           3.2      23  
 3 M               3.3              12           4        13.7
 4 M               4.2              16           4.8      18  
 5 M               4.4              23           4.5      14.9
 6 F               4.7              20           5.2      25.8
 7 F               5.4              17           2.7      13.8
 8 M               5.8              22           3.7      17.6
 9 F               6                20           5        23.3
10 M               6                22           3.7      20.9
11 F               6.1              20           5.6      21.2
12 F               6.5              21           5.2      18.5
13 F               6.6              22           6.2      29.6
14 F               6.6              21           6.9      15.9
15 F               6.7              25           7.1      24.6
16 M               6.7              20           4.8      15.8
17 M               7                24           6.4      29  
18 M               7.8              24           6.7      29.3
19 F               8.9              28           8        28.2
20 F               9.1              28           5.4      28.6</code></pre>
</div>
</div>
<p>การเขียนไฟล์ข้อมูล .xlsx บน working directory ของ R สามารถทำได้หลายวิธีการ วิธีการหนึ่งคือการใช้ฟังก์ชัน <code>write.xlsx()</code> ของ package xlsx ในทำนองเดียวกับการใช้ฟังก์ชัน <code>read_excel()</code> ผู้วิเคราะห์จำเป็นต้องดาวน์โหลดและติดตั้ง package ดังกล่าวก่อนที่จะใช้งาน</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"xlsx"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>จากชุดข้อมูล <code>dat_TSV</code> ในหัวข้อ 4.1.2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dat_TSV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X students calculus statistics math
1 0        1       80         75   70
2 1        2       40         55   60
3 2        3       84         85   86
4 3        4       51         38   43
5 4        5       67         73   77</code></pre>
</div>
</div>
<p>สามารถเขียนชุดข้อมูลดังกล่าวเป็นไฟล์ .xlsx บน working directory ของ R ได้โดยพิมพ์คำสั่งต่อไปนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(dat_TSV, <span class="at">file=</span><span class="st">"dat_TSV.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>รูปต่อไปนี้แสดงไฟล์ <code>dat_TSV.xlsx</code> ที่เขียนด้วยฟังก์ชัน <code>write.xlsx()</code> ในข้างต้น</p>
<p><img src="images/image-388606005.png" class="img-fluid" style="width:40.0%"></p>
</section>
<section id="ภาษา-python-3" class="level4">
<h4 class="anchored" data-anchor-id="ภาษา-python-3">ภาษา Python</h4>
<p>ในทำนองเดียวกับ R ผู้วิเคราะห์สามารถเรียกดูชื่อของ worksheet ในไฟล์ .xlsx ได้ ซึ่งสามารถทำได้หลายวิธีการ วิธีการหนึ่งคือการใช้ฟังก์ชัน <code>ExcelFile()</code> ของ library pandas ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sheets <span class="op">=</span> pd.ExcelFile(<span class="st">"Score.xlsx"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>sheets.sheet_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Score', 'Score3']</code></pre>
</div>
</div>
<p>ผลลัพธ์ข้างต้นแสดงให้เห็นว่าในไฟล์ <code>Score.xlsx</code> มี worksheet จำนวน 2 worksheet ได้แก่ <code>Scoore</code> และ <code>Score3</code> สมมุติว่าผู้วิเคราะห์ต้องการนำเข้าชุดข้อมูลใน worksheet <code>Score</code> สามารถเขียนคำสั่งเพิ่มได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> sheets.parse(sheet_name <span class="op">=</span> <span class="st">"Score"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id gender  MathScore  EngScore
0   1      M         33        80
1   2      M         57        20
2   3      F         76        80
3   4      M         80        85
4   5      F         92        95</code></pre>
</div>
</div>
<p>ฟังก์ชัน <code>parse()</code> ที่ใช้นำเข้าข้อมูลข้างต้นมีพารามิเตอร์ที่สามารถใช้ควบคุมการทำงานอยู่หลายตัว จากตัวอย่างข้างต้นจะเห็นว่ามีพารามิเตอร์ <code>sheet_name</code> ที่ใช้สำหรับระบุ worksheet ที่ไฟล์ .xlsx ที่ต้องการนำเข้า นอกจากนี้ยังมีพารามิเตอร์ <code>header</code> ที่ใช้ระบุแถวของชื่อตัวแปรในแต่ละคอลัมน์ ค่าเริ่มต้นของพารามิเตอร์นี้คือ <code>header = 0</code> ซึ่งหมายความว่ากำหนดให้แถวแรกของชุดข้อมูลเป็นชื่อของตัวแปร นอกจากนี้ยังสามารถกำหนดชื่อของตัวแปรในแต่ละคอลัมน์ได้ผ่านพารามิเตอร์ <code>names</code> โดยกำหนดให้รูปแบบของ list ที่สมาชิกแต่ละตัวแปร string เป็นต้น</p>
<p>อีกวิธีการหนึ่งที่สามารถใช้เพื่อนำเข้าไฟล์ .xlsx ใน Python ได้คือการใช้ฟังก์ชัน <code>read_excel()</code> ใน library pandas ฟังก์ชันนี้มีพารามิเตอร์สำคัญคือ <code>io</code> ที่ใช้ระบุชื่อหรือที่อยู่ (url) ของไฟล์ .xlsx ที่ต้องการนำเข้าสู่ Python นอกจากนี้ยังมีพารามิเตอร์ <code>sheet_name</code>, <code>header</code>, <code>names</code> และพารามิเตอร์อื่น ๆ ที่เหมือนกับฟังก์ชัน <code>parse()</code>ในตัวอย่างข้างต้น รายละเอียดของพารามิเตอร์ต่าง ๆ ผู้อ่านสามารถศึกษาเพิ่มเติมได้จาก <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html" class="uri">https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html</a></p>
<p>ตัวอย่างต่อไปนี้แสดงการนำเข้าชุดข้อมูลจาก worksheet <code>Score3</code> ในไฟล์ <code>Score.xlsx</code> โดยใช้ฟังก์ชัน <code>read_excel()</code> ดังกล่าว เนื่องจากชุดข้อมูลใน worksheet นี้ไม่ได้มีการกำหนดชื่อของตัวแปรเอาไว้ในแถวแรกของชุดข้อมูล จึงมีการกำหนดพารามิเตอร์ <code>header = None</code> และกำหนดชื่อของตัวแปรในแต่ละคอลัมน์ของชุดข้อมูลผ่านพารามิเตอร์ <code>names</code> นอกจากนี้ เนื่องจากชุดข้อมูลใน worksheet <code>Score3</code> มีจำนวนค่อนข้างมาก จากตัวอย่างข้างต้นจึงมีการใช้ฟังก์ชัน <code>head()</code> เพื่อควบคุมจำนวนข้อมูลที่จะนำเสนอใน printout</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>score3 <span class="op">=</span> pd.read_excel(<span class="st">"Score.xlsx"</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                        sheet_name <span class="op">=</span> <span class="st">"Score3"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                        header <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                        names <span class="op">=</span> [<span class="st">'gender'</span>,<span class="st">'att_pre'</span>,<span class="st">'prob_sov'</span>, <span class="st">'att_post'</span>,<span class="st">'ach'</span>])</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>score3.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  gender  att_pre  prob_sov  att_post   ach
0      M      2.7         9       4.0  17.6
1      F      2.9        22       3.2  23.0
2      M      3.3        12       4.0  13.7
3      M      4.2        16       4.8  18.0
4      M      4.4        23       4.5  14.9
5      F      4.7        20       5.2  25.8
6      F      5.4        17       2.7  13.8
7      M      5.8        22       3.7  17.6
8      F      6.0        20       5.0  23.3
9      M      6.0        22       3.7  20.9</code></pre>
</div>
</div>
<p>การเขียนชุดข้อมูลใน Python ออกไปเป็นไฟล์ .xlsx สามารถทำได้โดยใช้ฟังก์ชัน <code>to_excel()</code> ซึ่งมีการใช้งานที่คล้ายกับกับฟังก์ชัน <code>to_csv()</code> อย่างไรก็ตามเนื่องจากไฟล์ .xlsx มีโครงสร้างการเก็บข้อมูลที่ซับซ้อนกว่าไฟล์ CSV หรือ flatfile อื่น ๆ ฟังก์ชันดังกล่าวจึงมีพารามิเตอร์เฉพาะสำหรับการเขียนไฟล์ .xlsx ด้วย ฟังก์ชัน <code>to_excel()</code> มีพารามิเตอร์ที่สำคัญได้แก่ (1) พารามิเตอร์ <code>excel_writer</code> ใช้ระบุที่อยู่และชื่อไฟล์ .xlsx ที่ต้องการเขียนออกไป (2) พารามิเตอร์ <code>sheet_name</code> ใช้กำหนดชื่อของ worksheet ภายในไฟล์ .xlsx ที่ต้องการเขียนออกไป (3) พารามิเตอร์ <code>na_rep</code> ใช้สำหรับระบุสัญลักษณะของข้อมูลสูญหาย (missing value representation) (4) พารามิเตอร์ <code>startrow</code> และ <code>startcol</code> ใช้สำหรับกำหนดขอบเขตของข้อมูลที่ต้องการเขียนออกไปในไฟล์ .xlsx นอกจากนี้ยังมีพารามิเตอร์อื่น ๆ อีกหลายตัว โดยผู้อ่านสามารถศึกษาได้จาก <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html" class="uri">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html</a></p>
<p>ตัวอย่างต่อไปนี้แสดงการใช้ฟังก์ชัน <code>to_excel()</code> เพื่อเขียนไฟล์ข้อมูลตัวอย่าง <code>exam_dat</code> ออกไปเป็นไฟล์ <code>exam_dat.xlsx</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#เพศของนักเรียน</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>gender <span class="op">=</span> [<span class="st">"M"</span>,<span class="st">"M"</span>,<span class="st">"F"</span>,<span class="st">"F"</span>,<span class="st">"F"</span>,<span class="st">"M"</span>]</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#วิธีการสอนของครู</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> [<span class="st">"LEC"</span>,<span class="st">"LEC"</span>,<span class="st">"LEC"</span>,<span class="st">"PBL"</span>,<span class="st">"PBL"</span>,<span class="st">"PBL"</span>]</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># คะแนนสอบวิชา Eng</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>eng <span class="op">=</span> [<span class="dv">6</span>, <span class="fl">5.5</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="fl">8.5</span>]</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> {<span class="st">'gender'</span>: gender,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">'method'</span>: method,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">'eng'</span>: eng}</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>exam_dat <span class="op">=</span> pd.DataFrame(dat)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>exam_dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  gender method  eng
0      M    LEC  6.0
1      M    LEC  5.5
2      F    LEC  7.0
3      F    PBL  7.0
4      F    PBL  8.0
5      M    PBL  8.5</code></pre>
</div>
</div>
<p>การเขียนชุดข้อมูล <code>exam_dat</code> ออกไปเป็นไฟล์ <code>exam_dat.xlsx</code> สามารถเขียนคำสั่งได้ดังนี้</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>exam_dat.to_excel(excel_writer <span class="op">=</span> <span class="st">'exam_dat.xlsx'</span> , sheet_name<span class="op">=</span><span class="st">"exam_dat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>รูปต่อไปนี้แสดงไฟล์ <code>exam_dat.xlsx</code> ที่เขียนด้วยฟังก์ชัน <code>to_excel()</code> ในข้างต้น</p>
<p><img src="images/image-978432785.png" class="img-fluid" style="width:40.0%"></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">แผนการสอนประจำหน่วย</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./tidy.html" class="pagination-link">
        <span class="nav-page-text">ตอนที่ 4.2 การจัดระเบียบข้อมูล (tidying data)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>