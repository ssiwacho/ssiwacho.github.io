---
title: "ML: สัปดาห์ที่ 4: </br> Logistic Regression"
author: "อ.ดร.สิวะโชติ ศรีสุทธิยากร"
output:
  xaringan::moon_reader:
    css: xaringan-themer1.css
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      beforeInit: "https://platform.twitter.com/widgets.js"
      countIncrementalSlides: false
---

class: center, middle

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

library(tidyr)
library(ggplot2)
library(dplyr)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)


style_mono_accent(
  base_color = "#1c5253",
  header_font_google = google_font("Maitree"),
  text_font_google   = google_font("Sarabun"),
  code_font_google   = google_font("Fira Mono")
)
  

#style_duo_accent(header_font_google = google_font("Maitree"),
#  text_font_google   = google_font("Sarabun"),
#  code_font_google   = google_font("Fira Mono"),
#  primary_color = "#4d3e3e",
#  secondary_color="#fff3cd",
 
#text_color="#382933",

#  colors = c(
#  red = "#f34213",
#  purple = "#3e2f5b",
#  orange = "#ff8811",
#  green = "#136f63",
#  white = "#FFFFFF")

#)

```


<img src="linear-regression-vs-logistic-regression.png" width=120%>

<small>
[https://www.javatpoint.com/linear-regression-vs-logistic-regression-in-machine-learning](https://www.javatpoint.com/linear-regression-vs-logistic-regression-in-machine-learning)
</small>
---
class: middle

.left-column[

### Classification: Logistic regression

- **What's logistic regression?**

- Use case

- Fitting the model

- Interpreting the logistic regression

- Predicting the outcome

- Classification thresholds

- Model's Evaluating


]

.right-column[

### Linear Regression

.pull-left[
<small>

การวิเคราะห์ความถดถอยเชิงเส้นเป็นเทคนิคการเรียนรู้ที่ใช้สร้างโมเดลทางคณิตศาสตร์เพื่อเรียนรู้ความสัมพันธ์ระหว่างตัวแปรตามแบบต่อเนื่องกับตัวแปรอิสระใด ๆ ภายในชุดข้อมูล โดยมีวัตถุประสงค์การวิเคราะห์ที่อาจจำแนกได้เป็น 2 ข้อ ได้แก่

1. เพื่อวิเคราะห์อิทธิพลของตัวแปรอิสระที่มีต่อตัวแปรตาม

2. เพื่อทำนายแนวโน้มของค่าสังเกตของตัวแปรตามโดยใช้ข้อมูลของตัวแปรอิสระ

ทั้งนี้การวิเคราะห์ความถดถอยเชิงเส้นจะเรียนรู้ความสัมพันธ์ระหว่างตัวแปรจากชุดข้อมูลดังกล่าว แล้วนำความสัมพันธ์ที่เรียนรู้ได้นี้มาสร้างเป็นสมการทำนาย $\hat{y}$ ที่อยู่ในรูปผลรวมเชิงเส้นของตัวแปรอิสระดังนี้

$$\hat{y}_i=b_0+b_1x_{1i}+b_2x_{2i}+...+b_px_{pi}$$
</small>

]

.pull-right[

```{r fig.retina=3, echo=F, fig.height=5, fig.width=6, fig.align="left"}
set.seed(12345)
x<-rnorm(50,50,10)
y<-2+1.5*x+rnorm(50,0,5)
par(mar=c(5,5,0.5,0.5))
plot(x,y,pch=16, xlab="Performance", ylab="Achievement", cex.lab=1.5,cex=1.5,col="darkblue")
abline(lm(y~x),col="orange")
text(58,50,expression(hat(y)==3.60+1.50*performance),cex=1.5)
```
]

]

---
class: middle

.left-column[

### Classification: Logistic regression

- **What's logistic regression?**

- Use case

- Fitting the model

- Interpreting the logistic regression

- Predicting the outcome

- Classification thresholds

- Model's Evaluating


]



.right-column[

### Logistic Regression

<small>

Linear regression  เป็นการวิเคราะห์ความสัมพันธ์เชิงสาเหตุระหว่างตัวแปรตามแบบต่อเนื่องกับตัวแปรอิสระ ส่วน logistic regression ใช้สำหรับวิเคราะห์ความสัมพันธ์เชิงสาเหตุระหว่างตัวแปรตามแบบจัดประเภทกับตัวแปรอิสระ โดยจำแนกได้เป็นหลายประเภท ได้แก่

- **Binary logistic regression** ใช้ในกรณีที่ตัวแปรตามเป็นตัวแปรแบบจัดประเภทและมีค่าสังเกตที่เป็นไปได้ 2 ค่า (binary response)

- **Multinomial logistic regression** ใช้ในกรณีที่ตัวแปรตามเป็นตัวแปรแบบจัดประเภทที่ค่าสังเกตมีค่าที่เป็นไปได้มากกว่า 2 ค่า และมีระดับการวัดแบบนามบัญญัติ

- **Ordinal logistic regression** ใช้ในกรณีตัวแปรตามเป็นตัวแปรแบบจัดประเภทที่ค่าสังเกตมีค่าที่เป็นไปได้มากกว่า 2 ค่า และมีระดับการวัดแบบเรียงอันดับ

</small>


]


---
class: middle

.left-column[

### Classification: Logistic regression

- **What's logistic regression?**

- Use case

- Fitting the model

- Interpreting the logistic regression

- Predicting the outcome

- Classification thresholds

- Model's Evaluating


]

.right-column[

### Why's Logistic Regression?

```{r echo=F, fig.retina=3, message=F, warning=F, fig.height=4}
engagement<-rnorm(100,0,1)
success<---3+4*engagement+rnorm(100,0,0.2)
p<-exp(success)/(1+exp(success))
success<-ifelse(success>0.5,1,0)
temp<-data.frame(engagement,success)
library(dplyr)
library(ggplot2)
temp%>%ggplot(aes(x=engagement,y=success))+geom_point()+geom_smooth(method="lm")

```



]
