<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>การเรียนรู้เชิงลึก</title>

        <script src="DL2_files/header-attrs-2.7/header-attrs.js"></script>
        <script src="DL2_files/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="DL2_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="DL2_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="DL2_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="DL2_files/navigation-1.1/tabsets.js"></script>
        <link href="DL2_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="DL2_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="DL2_files/robobook-0.1/robobook.css" rel="stylesheet" />
        <link href="DL2_files/robobook-0.1/robobook_fonts_embed.css" rel="stylesheet" />
        <script src="DL2_files/robobook-0.1/robobook.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
            <!-- robobook start -->   
   <div class="book with-summary">
      <div class="book-summary">
        <ul>
          <li class="title">การเรียนรู้เชิงลึก</li>
          <li class="divider"></li>
        </ul>
        <nav role="navigation" id="toc">
          <ul>
          <li><a href="#introduction"><strong>Introduction</strong></a>
          <ul>
          <li><a href="#forward-propagation"><strong>Forward propagation</strong></a></li>
          <li><a href="#backward-propagation"><strong>Backward propagation</strong></a></li>
          <li><a href="#activation-function"><strong>Activation function</strong></a></li>
          <li><a href="#ประเภทของ-dl-model"><strong>ประเภทของ ​DL model</strong></a></li>
          </ul></li>
          <li><a href="#the-first-dl-model-mlp-with-keras"><strong>The first DL model (MLP) with Keras</strong></a>
          <ul>
          <li><a href="#ติดตั้ง-package">ติดตั้ง package</a></li>
          <li><a href="#regression-example">Regression Example</a></li>
          <li><a href="#classification-example">Classification Example</a></li>
          </ul></li>
          </ul>
        </nav>
        <ul class="authors">
          <li class="divider"></li>
                            </ul>     
      </div>
      <div class="book-body fixed">
        <div class="body-inner">
            <a class="btn pull-left js-toolbar-action toggle-sidebar" aria-label="Toggle Sidebar" title="Toggle Sidebar" href="#">
              <span class="glyphicon glyphicon-menu-hamburger"></span>
            </a>
            <div class="page-inner">
              <section id="content" class="normal">
      
   
        
      <h1 class="title">การเรียนรู้เชิงลึก</h1>
      
        

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<p style="line-height:1.3; font-size:16px; color: #353b48; text-align:right;">
สิวะโชติ ศรีสุทธิยากร </br> </br> ภาควิชาวิจัยและจิตวิทยาการศึกษา คณะครุศาสตร์ </br> จุฬาลงกรณ์มหาวิทยาลัย </br> </font> 13 May 2021 </font>
</p>
</body>
</html>
<div id="introduction" class="section level1">
<h1><strong>Introduction</strong></h1>
<p>DL model กลุ่มของอัลกอริทึมการเรียนรู้ของเครื่องที่มีความสามารถสูงมากในปัจจุบัน โดยสามารถทำนายค่าของตัวแปรเป้าหมายได้อย่างมีประสิทธิภาพ และแม่นยำ DL ถูกนำไปประยุกต์ใช้ในหลากหลายวงการทั้งทางการแพทย์ เช่น การวินิจฉัยโรคจากภาพ X-ray หรือ CT Scan ทางการศึกษา เช่น การตรวจจับใบหน้าหรือเสียงของผู้เรียนเพื่อวินิจฉัยอารมณ์ความรู้สึกหรือความยึดมั่นผูกพันทางการเรียนของนักเรียน เป็นต้น</p>
<p>อัลกอริทึมหลักของ DL คือ Artificial neural network ซึ่งเป็นอัลกอริทึมที่มีจุดเด่นคือรองรับข้อมูลนำเข้าที่หลากหลายทั้งในรูปแบบข้อมูลที่มีโครงสร้าง และไม่มีโครงสร้าง แตกต่างจาก traditional ML algorithm ที่มักใช้ได้กับข้อมูลที่มีโครงสร้างเท่านั้น</p>
<p>นอกจากนี้โครงสร้างการเรียนรู้ของ neural network ยังมีประสิทธิภาพและมีความยืดหยุ่น และมีลักษณะการเรียนรู้ที่สอดคล้องใกล้เคียงกับการเรียนรู้ของมนุษย์มากกว่า traditional ML รูปต่อไปนี้แสดงลักษณะการเรียนรู้แบบ traditional ML</p>
<p><left><img src="Screen%20Shot%202564-05-15%20at%2002.08.01.png" style="width:60.0%" alt="tradition ML algorithm" /></left></p>
<p><em>tradition ML algorithm</em></p>
<p>จากรูปจะเห็นว่า traditional ML algorithm ประกอบด้วย 3 ส่วนหลักได้แก่</p>
<ol style="list-style-type: decimal">
<li><p>ส่วนข้อมูลนำเข้า (Input)</p></li>
<li><p>ส่วน Model</p></li>
<li><p>ส่วนการทำนาย</p></li>
</ol>
<p>ส่วน neural network model มีลักษณะการเรียนรู้ดังรูป</p>
<p><left><img src="Screen%20Shot%202564-05-15%20at%2002.29.19.png" style="width:80.0%" /></left></p>
<p>จากรูปจะเห็นว่า neural network ประกอบด้วยส่วนประกอบหลักที่เรียกว่า layer จำนวน 3 ส่วนได้แก่</p>
<ol style="list-style-type: decimal">
<li><p>input layer</p></li>
<li><p>hidden layer</p></li>
<li><p>output layer</p></li>
</ol>
<p>จากรูปจะเห็นว่าโมเดลมี input layer ที่ประกอบด้วยหน่วยย่อยหรือที่เรียกว่า นิวรอน (neurons) จำนวน 3 หน่วย โดยนิวรอนใน input layer จะใช้แทนตัวแปรอิสระของโมเดล ในที่นี้จะได้ว่า <span class="math inline">\(X = [x_1, x_2, x_3]\)</span></p>
<p>โมเดลจะนำข้อมูลนำเข้าใน input layer ที่กำหนดมาประมวลผลร่วมกับพารามิเตอร์ <span class="math inline">\(w[1]\)</span> และ <span class="math inline">\(b[1]\)</span> เพื่อนำส่งไปยัง neuron แต่ละตัวภายใน hidden layer ผู้อ่านจะเห็นว่าการประมวลผลเพื่อให้ได้ neuron ดังกล่าวสามารถเขียนเป็นแผนภาพได้ดังนี้</p>
<p><left><img src="Screen%20Shot%202564-05-15%20at%2002.32.24.png" style="width:50.0%" /></left></p>
<p>เมื่อได้ค่าของ neuron แต่ละตัวในชั้นของ hidden layer จึงทำการประมวลผลร่วมกับพารามิเตอร์ <span class="math inline">\(w[2]\)</span> และ <span class="math inline">\(b[2]\)</span> เพื่อคำนวณค่าทำนายใน output layer เรียกกระบวนการนี้ว่า <strong>forward propagation</strong></p>
<p>การประมวลผลของ neuron ใน hidden layer จะนำข้อมูลของ neuron ที่อยู่ใน layer ก่อนหน้ามาคำนวณผลรวมเชิงเส้นแบบถ่วงน้ำหนัก จากตัวอย่างของ deep learning model ในข้างต้น จะได้ว่าผลรวมเชิงเส้นของแต่ละ neuron ใน hidden layer คำนวณได้ดังนี้</p>
<p><span class="math inline">\(h_j=b+w_1x_1+w_2x_2\)</span></p>
<p>เรียก <span class="math inline">\(w_k\)</span> ว่าน้ำหนัก (weight) และ <span class="math inline">\(b\)</span> ว่าค่าความลำเอียง (bias)</p>
<p>โดยทั่วไปมีความเป็นไปได้ที่ค่าของผลรวมเชิงเส้นที่คำนวณได้ข้างต้นจะมีพิสัยที่ไม่สอดคล้องกับตัวแปรตามที่ต้องการทำนาย จึงมีการนำค่าผลรวมเชิงเส้นดังกล่าวมาแปลงค่าด้วยฟังก์ชันที่เรียกว่า activation function ก่อนที่จะส่งค่าไปยัง neuron ใน layer ถัดไป ดังตัวอย่างในรูปด้านล่าง</p>
<div id="forward-propagation" class="section level2">
<h2><strong>Forward propagation</strong></h2>
<p>โดยปกติแล้วเมื่อเริ่มต้นกระบวนการผู้วิเคราะห์จะยังไม่ทราบค่าพารามิเตอร์ที่เหมาะสมของโมเดลดังนั้นจึงต้องมีการประมาณค่าพารามิเตอร์ดังกล่าวก่อนการใช้งานจริง กระบวนการ forward propagation จะเริ่มจากการสุ่มค่าเริ่มต้นของพารามิเตอร์ทั้งหมดภายในโมเดลขึ้นมาก่อน 1 ชุด และใช้ชุดของพารามิเตอร์นี้ไปใช้กับชุดข้อมูลฝึกหัดเพื่อคำนวณเป็นผลลัพธ์ใน output layer</p>
<p>เมื่อได้ผลลัพธ์ดังกล่าวจะนำผลลัพธ์นี้ไปเปรียบเทียบกับค่าจริงของผลลัพธ์ในชุดข้อมูลฝึกหัดโดยใช้ cost function จากนั้นจะใช้กระบวนการ <strong>backward propagation</strong> เพื่อปรับค่าพารามิเตอร์ในโมเดลเพื่อให้ค่าของ loss function ลดลง และได้ชุดของพารามิเตอร์ที่มีความสมเหตุสมผลมากยิ่งขึ้น</p>
<p>กระบวนการทำงานข้างต้นจะดำเนินการแบบทวนซ้ำหลายรอบจนกระทั่งค่า cost function ของโมเดลลดลงอยู่ในระดับที่ต้องการ ในเชิงเทคนิคจะเรียกกระบวนการ forward + backward propagation 1 ชุด นี้ว่า 1 Epoch</p>
</div>
<div id="backward-propagation" class="section level2">
<h2><strong>Backward propagation</strong></h2>
<p>กระบวนการ forward propagation จะสิ้นสุดลงเมื่อคำนวณค่าทำนายของตัวแปรเป้าหมายในโมเดลได้ เมื่อได้ค่าทำนายดังกล่าวผู้วิเคราะห์จะทำการประเมินความสอดคล้องเชิงประจักษ์ของโมเดลด้วยการเปรียบเทียบค่าทำนายนี้กับค่าจริงในชุดข้อมูลฝึกหัดผ่านฟังก์ชันวัตถุประสงค์หรือฟังก์ชันต้นทุน (cost function) ซึ่งมีหลากหลายตัวขึ้นกับปัญหาของการทำงาน เช่นในปัญหา regression อาจใช้ cost function เป็นค่า mean squares error (MSE) หรือปัญหา binary classification อาจใช้ cost function เป็น cross entropy ดังนี้</p>
<p><span class="math inline">\(J = -\frac{1}{n}\sum_{i=1}^n (y_ilog(\hat{y}_i)+(1-y_i)log(1-\hat{y}_i))\)</span></p>
<p>กระบวนการ backward propagation จะปรับค่าพารามิเตอร์ในโมเดลเพื่อให้ได้โมเดลที่มีความสอดคล้่องกับข้อมูลฝึกหัดมากขึ้น โดยพิจารณาชุดของค่าพารามิเตอร์ที่ทำให้ cost function มีค่าต่ำที่สุด โดยใช้อัลกอริทึม gradient descent เป็นเครื่องมือ ดังนี้</p>
<ol style="list-style-type: decimal">
<li><p>หา first-order derivative ของ cost function เทียบกับค่าพารามิเตอร์ในโมเดลเขียนแทนด้วย <span class="math inline">\(\frac{\partial J(w)}{\partial w}\)</span></p></li>
<li><p>นำ <span class="math inline">\(\frac{\partial J(w)}{\partial w}\)</span> ไปหักลบออกจากค่าพารามิเตอร์ในรอบก่อนหน้าโดยควบคุมความเร็วในการเรียนรู้ผ่าน learning rate (<span class="math inline">\(\alpha\)</span>)</p></li>
<li><p>นำค่าพารามิเตอร์ที่ปรับปรุงใหม่ใน 2 ไปประมวลผลร่วมในกระบวนการ forward propagation ซึ่งจะทำให้ cost function มีค่าลดลง</p></li>
</ol>
<p>ทวนซ้ำกระบวนการข้างต้นจนกระทั่ง cost function มีแนวโน้มคงที่</p>
</div>
<div id="activation-function" class="section level2">
<h2><strong>Activation function</strong></h2>
<p>activation function เป็นฟังก์ชันทางคณิตศาสตร์ ที่ผู้วิเคราะห์ใช้สำหรับแปลงค่าผลรวมเชิงเส้นของข้อมูลนำเข้า ให้มีพิสัยอยู่ในช่วงที่สมเหตุสมผลหรือสอดคล้องกับตัวแปรตามที่ต้องการทำนาย</p>
<p>activation function ที่ใช้ในการวิเคราะห์มีได้หลากหลาย โดยอาจจำแนกเป็น 2 ประเภทได้แก่ <strong>linear activation function</strong> ซึ่งเขียนในรูปทั่วไปดังนี้</p>
<p><span class="math inline">\(\sigma(x)=m(x)+c\)</span></p>
<p>ฟังก์ชันประเภทนี้จะไม่ได้ทำให้พิสัยของข้อมูลนำเข้าเปลี่ยนแปลงไปจากเดิม กล่าวคือหาก <span class="math inline">\(x \in [-\infty, \infty]\)</span> แล้ว <span class="math inline">\(\sigma(x) \in [-\infty, \infty]\)</span> เช่นเดิม แต่อาจช่วยแปลงสเกลของข้อมูลนำเข้าให้เหมาะสมมากหรือใกล้เคียงกับช่วงที่เป็นไปได้ของตัวแปรตามมากขึ้น ดังตัวอย่างในรูปด้านล่าง</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-1-1.png" width="480" /></p>
<p>และ <strong>nonlinear activation function</strong> ซึ่งมักใช้ใช้บ่อยกว่า linear activation function ทั้งนี้เป็นเพราะมีความสามารถที่จะแปลงพิสัยของข้อมูลนำเข้าให้อยู่ในช่วงที่เหมาะสมได้ เช่นแปลง <span class="math inline">\(x \in [-\infty, \infty]\)</span> ให้อยู่ในช่วง <span class="math inline">\([0,1]\)</span> หรือ <span class="math inline">\([0, \infty]\)</span> หรือ <span class="math inline">\([-1,1]\)</span></p>
<div id="ตัวอย่าง-activation-function" class="section level3">
<h3>ตัวอย่าง activation function</h3>
<p><strong>Sigmoid function:</strong> <span class="math inline">\(\sigma(x)=\frac{1}{1+exp(-x)}\)</span></p>
<p>เหมาะสำหรับใช้เป็น activation function ในปัญหา binary classification ฟังก์ชันนี้จะแปลงข้อมูลนำเข้าในอยู่ในพิสัย <span class="math inline">\([0,1]\)</span></p>
<p><strong>Hyperbolic Tangent function:</strong> <span class="math inline">\(\sigma(x)=\frac{e^x-e^{-x}}{e^x+e^{-x}}\)</span></p>
<p>ฟังก์ชันนี้มีลักษณะคล้ายกับ sigmoid function แต่พิสัยของฟังก์ชันจะอยู่ในช่วง <span class="math inline">\([-1,1]\)</span> บางครั้งเรียกว่า sigmoidal funcion หรือ tanh function</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Rectified Linear Unit:</strong> <span class="math inline">\(\sigma(x)=max(0,x)\)</span></p>
<p>เป็น activation function ที่มักใช้บ่อยใน hidden layer โดยพิสัยของฟังก์ชันจะอยู่ในช่วง <span class="math inline">\([0,\infty]\)</span> ดังรูป</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Leaky Rectified Linear Unit:</strong> <span class="math inline">\(\sigma(x)= \begin{cases} x,&amp; \text{if } x\geq 1\\ax, &amp; \text{otherwise}\end{cases}\)</span></p>
<p><img src="DL2_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Softmax</strong></p>
<p>softmax activation function เป็น function ที่เหมาะสำหรับใช้ในปัญหา multi-class classification จากสูตรของฟังก์ชันจะเห็นว่าผลลัพธ์ที่ได้จะเป็นความน่าจะเป็นที่มีพิสัยอยู่ในช่วง <span class="math inline">\([0,1]\)</span></p>
<p>กำหนดให้ <span class="math inline">\(x=(x_1, x_2, x_3, x_4)\)</span> เป็นเวกเตอร์ของข้อมูลนำเข้า และตัวแปรตามเป็นตัวแปรแบบจัดประเภทที่มี 3 ระดับได้แก่ <span class="math inline">\(a, b, c\)</span></p>
<p>สมมุติว่าต้องการหาความน่าจะเป็นของการเกิดผลลัพธ์ <span class="math inline">\(a, b, c\)</span> เมื่อกำหนดข้อมูลนำเข้า <span class="math inline">\(x\)</span> จะสามารถหาได้โดยใช้ความน่าจะเป็นแบบมีเงื่อนไข (conditional probability) ดังนี้</p>
<p><span class="math inline">\(P(a|x)=\frac{y_a}{y_a+y_b+y_c}\)</span></p>
<p><span class="math inline">\(P(b|x)=\frac{y_b}{y_a+y_b+y_c}\)</span></p>
<p><span class="math inline">\(P(c|x)=\frac{y_c}{y_a+y_b+y_c}\)</span></p>
<p>เมื่อ</p>
<p><span class="math inline">\(y_a=w_{1,a}x_1+w_{2,a}x_2+w_{3,a}x_3+w_{4,a}x_4\)</span></p>
<p><span class="math inline">\(y_b=w_{1,b}x_1+w_{2,b}x_2+w_{3,b}x_3+w_{4,b}x_4\)</span></p>
<p><span class="math inline">\(y_c=w_{1,c}x_1+w_{2,c}x_2+w_{3,c}x_3+w_{4,c}x_4\)</span></p>
<p>จะสังเกตเห็นว่า <span class="math inline">\(P(a|x)+P(b|x)+P(c|x)=1\)</span></p>
<p>เนื่องจากผลรวมเชิงเส้นในข้างต้นมีพิสัยเป็นจำนวนจริง จึงทำให้ผลรวมเชิงเส้นดังกล่าวสามารถมีค่าติดลบได้ ซึ่งอาจส่งผลให้ค่าความน่าจะเป็นแบบมีเงื่อนไขมีค่าอยู่นอกช่วง <span class="math inline">\([0,1]\)</span></p>
<p>เพื่อแก้ปัญหานี้จึงมีการใช้ฟังก์ชัน exponential แปลงพิสัยของผลรวมเชิงเส้นที่เป็นจำนวนจริงให้อยู่ในช่วง <span class="math inline">\([0, \infty]\)</span> ซึ่งทำให้ sofmax activation function สามารถเขียนในรูปทั่วไปได้ดังนี้</p>
<p>กำหนดให้ <span class="math inline">\(x = (x_1, x_2, x_3, ..., x_p)^T\)</span> เป็นเวกเตอร์ข้อมูลนำเข้าของตัวแปรอิสระจำนวน <span class="math inline">\(p\)</span> ตัว และ <span class="math inline">\(y\)</span> เป็นตัวแปรตามแบบจัดประเภทที่มีจำนวน <span class="math inline">\(k\)</span> ระดับ softmax activation function นิยามดังนี้</p>
<p><span class="math inline">\(\sigma(x)=P(y=y_m|x)=\frac{exp(x_i)}{\sum_{j=1}^pexp(x_j)}\)</span></p>
<p>เมื่อ <span class="math inline">\(i = 1,2,...,p\)</span> และ <span class="math inline">\(m = 1,2,...,k\)</span></p>
<p>์Note: สังเกตว่า DL model ทำนายตัวแปรตามที่ต้องการด้วยการแยกส่วนการประมวลผลออกเป็นส่วนย่อย ๆ หลาย ๆ ส่วน โดยที่แต่ละส่วนถูกบรรจุอยู่ใน neuron</p>
</div>
</div>
<div id="ประเภทของ-dl-model" class="section level2">
<h2><strong>ประเภทของ ​DL model</strong></h2>
<ul>
<li><p>Multilayer Perceptron Model (MLP models)</p></li>
<li><p>Convolutional Neural Network (CNNs)</p></li>
<li><p>Recurrent Neural Network (RNNs)</p></li>
<li><p>Restricted Boltzmann Machines (RBMs)</p></li>
<li><p>Deep Belief Networks (DBNs)</p></li>
</ul>
</div>
</div>
<div id="the-first-dl-model-mlp-with-keras" class="section level1">
<h1><strong>The first DL model (MLP) with Keras</strong></h1>
<p>multi-layer perceptron เป็น neural network ประเภทหนึ่งที่เรียกว่า Feedforward neural networks (FFNNs) ซึ่งเป็นโมเดลพื้นฐานที่ใช้ในการทำงานทั่วไป ภายในโมเดลประกอบด้วย input, hidden และ output layers ดังที่กล่าวมาแล้ว โมเดลประเภทนี้สามารถประยุกต์ใช้ได้กับทั้งปัญหา classification และ regression</p>
<p><img src="Screen%20Shot%202564-05-15%20at%2003.15.07.png" /></p>
<p><em>(a) Single layer perceptron; (b) multi-layer perceptron</em></p>
<p>หัวข้อนี้จะกล่าวถึงการสร้าง MLP โดยใช้ package-keras</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/j_pJmXJwMLA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="ติดตั้ง-package" class="section level2">
<h2>ติดตั้ง package</h2>
<p>keras สามารถติดตั้งและเรียกใช้งานได้ทั้งบน python และ R โดยสำหรับภาษา python ให้ดำเนินการดังนี้</p>
<ol style="list-style-type: decimal">
<li>ในหน้าต่าง terminal ให้ดำเนินการดาวน์โหลดและติดตั้ง tensorflow และ keras ดังนี้</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pip install <span class="op">--</span>upgrade tensorflow</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pip install keras</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>ใน python ก่อนการใช้งานแต่ละครั้งจะเป็นต้องเรียกใช้โดยพิมพ์คำสั่งดังนี้</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span></code></pre></div>
<p>สำหรับโปรแกรม R ให้ดำเนินการดาวน์โหลดและติดตั้ง package-keras โดยพิมพ์คำสั่งดังนี้</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;keras&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_keras</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span></code></pre></div>
</div>
<div id="regression-example" class="section level2">
<h2>Regression Example</h2>
<p>จากชุดข้อมูล crimm.csv สมมุติว่่าต้องการสร้าง MLP เพื่อทำนายอัตราการเกิดคดีโจรกรรมของแต่ละพื้นที่</p>
<p>ใน python สามารถดำเนินการได้ดังนี้ —&gt; <a href="https://ssiwacho.github.io/deep%20learning/DL_reg_1.html">MLP in Python</a></p>
<p>ใน R สามารถดำเนินการได้ดังนี้</p>
<ol style="list-style-type: decimal">
<li>นำเข้าชุดข้อมูล</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/Users/siwachoat/Library/Mobile Documents/com~apple~CloudDocs/เอกสารประกอบการสอน/Machine Learning/เอกสาร/ep2_regression/_02_multiple regression/crimm.csv&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dat)</span></code></pre></div>
<pre><code>Rows: 2,212
Columns: 17
$ householdSize          &lt;dbl&gt; 3.10, 2.82, 2.43, 2.40, 2.76, 2.45, 2.60, 2.45,…
$ pct.lao                &lt;dbl&gt; 1.37, 0.80, 0.74, 1.70, 0.53, 2.51, 1.60, 14.20…
$ pct.thai               &lt;dbl&gt; 91.78, 95.57, 94.33, 97.35, 89.16, 95.65, 96.57…
$ pct.myanmar            &lt;dbl&gt; 6.50, 3.44, 3.43, 0.50, 1.17, 0.90, 1.47, 0.40,…
$ pct.cambodia           &lt;dbl&gt; 1.88, 0.85, 2.35, 0.70, 0.52, 0.95, 1.10, 0.63,…
$ numPop.urban           &lt;int&gt; 11980, 23123, 29344, 0, 0, 140494, 28700, 59449…
$ medIncome.household    &lt;int&gt; 75122, 47917, 35669, 20580, 17390, 21577, 42805…
$ pctWPubAsst            &lt;dbl&gt; 1.03, 2.75, 2.94, 11.71, 11.21, 7.12, 5.41, 8.8…
$ pctPop.poor            &lt;dbl&gt; 1.96, 3.98, 4.75, 17.23, 29.99, 17.78, 4.01, 17…
$ pchLessM3              &lt;dbl&gt; 5.81, 5.61, 2.80, 11.05, 12.15, 8.76, 4.49, 10.…
$ PctUnemployed          &lt;dbl&gt; 2.70, 2.43, 4.01, 9.86, 9.08, 5.72, 4.85, 8.19,…
$ NumIlllegal.labor      &lt;int&gt; 1277, 1920, 1468, 339, 196, 2091, 2637, 517, 14…
$ HousVacant             &lt;int&gt; 64, 240, 544, 669, 333, 5119, 566, 2051, 1562, …
$ Num.HomelessInShelters &lt;int&gt; 11, 0, 16, 0, 2, 327, 0, 21, 125, 43, 1, 20, 28…
$ Num.HomelessInStreet   &lt;int&gt; 0, 0, 0, 0, 0, 4, 0, 0, 15, 4, 0, 49, 2, 0, 0, …
$ PopDens                &lt;dbl&gt; 1845.9, 2186.7, 2780.9, 3217.7, 974.2, 1995.7, …
$ TheifperPop            &lt;dbl&gt; 114.85, 242.37, 758.14, 1301.78, 728.93, 1386.4…</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>normalized ค่าของตัวแปรอิสระ</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>] <span class="ot">&lt;-</span> <span class="fu">scale</span>(dat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>], <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div>
<pre><code> householdSize        pct.lao           pct.thai        pct.myanmar      
 Min.   :-3.3118   Min.   :-0.6548   Min.   :-4.9515   Min.   :-0.59018  
 1st Qu.:-0.6198   1st Qu.:-0.5945   1st Qu.:-0.4647   1st Qu.:-0.45838  
 Median :-0.1412   Median :-0.4542   Median : 0.3874   Median :-0.32211  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000  
 3rd Qu.: 0.4271   3rd Qu.: 0.1261   3rd Qu.: 0.7451   3rd Qu.: 0.00013  
 Max.   : 7.6954   Max.   : 6.1265   Max.   : 0.9521   Max.   :12.23910  
  pct.cambodia        numPop.urban      medIncome.household  pctWPubAsst     
 Min.   :-0.535563   Min.   :-0.23211   Min.   :-1.8714     Min.   :-1.4079  
 1st Qu.:-0.479978   1st Qu.:-0.23211   1st Qu.:-0.7579     1st Qu.:-0.7508  
 Median :-0.394541   Median :-0.14438   Median :-0.1899     Median :-0.2531  
 Mean   : 0.000000   Mean   : 0.00000   Mean   : 0.0000     Mean   : 0.0000  
 3rd Qu.:-0.008363   3rd Qu.:-0.02843   3rd Qu.: 0.5581     3rd Qu.: 0.4896  
 Max.   : 5.995335   Max.   :35.35959   Max.   : 6.6748     Max.   : 8.0855  
  pctPop.poor        pchLessM3       PctUnemployed     NumIlllegal.labor 
 Min.   :-1.2767   Min.   :-1.3485   Min.   :-1.6314   Min.   :-0.11294  
 1st Qu.:-0.8262   1st Qu.:-0.6819   1st Qu.:-0.6918   1st Qu.:-0.10608  
 Median :-0.2657   Median :-0.2158   Median :-0.2064   Median :-0.09479  
 Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000  
 3rd Qu.: 0.6143   3rd Qu.: 0.3985   3rd Qu.: 0.4801   3rd Qu.:-0.05380  
 Max.   : 5.4002   Max.   : 6.1158   Max.   : 8.7007   Max.   :37.44611  
   HousVacant       Num.HomelessInShelters Num.HomelessInStreet
 Min.   :-0.26310   Min.   :-0.11874       Min.   :-0.07266    
 1st Qu.:-0.22192   1st Qu.:-0.11874       1st Qu.:-0.07266    
 Median :-0.18297   Median :-0.11874       Median :-0.07266    
 Mean   : 0.00000   Mean   : 0.00000       Mean   : 0.00000    
 3rd Qu.:-0.08021   3rd Qu.:-0.07978       3rd Qu.:-0.06859    
 Max.   :26.27786   Max.   :41.29419       Max.   :42.46083    
    PopDens         TheifperPop      
 Min.   :-0.9801   Min.   :   16.92  
 1st Qu.:-0.5663   1st Qu.:  511.69  
 Median :-0.2682   Median :  822.72  
 Mean   : 0.0000   Mean   : 1033.43  
 3rd Qu.: 0.1903   3rd Qu.: 1350.23  
 Max.   :14.6406   Max.   :11881.02  </code></pre>
<ol start="3" style="list-style-type: decimal">
<li>แบ่งชุดข้อมูลเป็น train and test data โดยให้เก็บค่าไว้ในรูปแบบของเมทริกซ์ (matrix) จำแนกเป็นเมทริกซ์ของตัวแปรอิสระ และเมทริกซ์ของตัวแปรตาม</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>train.id <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dat<span class="sc">$</span>TheifperPop, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> F)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>train_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[train.id, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[train.id, <span class="dv">17</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>test_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[<span class="sc">-</span>train.id, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[<span class="sc">-</span>train.id, <span class="dv">17</span>])</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># remove column name</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(train_x) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(train_y) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>สร้างโมเดล MLP ด้วย package-keras</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Create a Sequential model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>model.r <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Add input, hidden and output layer</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>model.r <span class="sc">%&gt;%</span> <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">32</span>, <span class="at">input_shape =</span> <span class="fu">c</span>(<span class="dv">16</span>), <span class="at">activation =</span> <span class="st">&quot;relu&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">16</span>, <span class="at">activation =</span> <span class="st">&quot;relu&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. summary the model</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>model.r</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. compile model</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>model.r <span class="sc">%&gt;%</span> <span class="fu">compile</span>(<span class="at">optimizer =</span> <span class="st">&quot;adam&quot;</span>, <span class="at">loss =</span> <span class="st">&quot;mse&quot;</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. train the model</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> model.r <span class="sc">%&gt;%</span> keras<span class="sc">::</span><span class="fu">fit</span>(train_x, train_y, <span class="at">epoch =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>Model
Model: &quot;sequential_60&quot;
________________________________________________________________________________
Layer (type)                        Output Shape                    Param #     
================================================================================
dense_176 (Dense)                   (None, 32)                      544         
________________________________________________________________________________
dense_175 (Dense)                   (None, 16)                      528         
________________________________________________________________________________
dense_174 (Dense)                   (None, 1)                       17          
================================================================================
Total params: 1,089
Trainable params: 1,089
Non-trainable params: 0
________________________________________________________________________________</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>ประเมินคุณภาพของโมเดล</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(history)</span></code></pre></div>
<p><img src="DL2_files/figure-html/unnamed-chunk-13-1.png" width="768" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mse  <span class="co">#MSE</span></span></code></pre></div>
<pre><code>    loss 
237833.2 </code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(mse)  <span class="co">#RMSE</span></span></code></pre></div>
<pre><code>    loss 
487.6814 </code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred, test_y)</span></code></pre></div>
<p><img src="DL2_files/figure-html/unnamed-chunk-13-2.png" width="768" /></p>
</div>
<div id="classification-example" class="section level2">
<h2>Classification Example</h2>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2013.44.05.png" style="width:40.0%" /></left></p>
</div>
</div>

   
   
           </section>
  </div>
  </div>
  </div>
  </div>
      
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
