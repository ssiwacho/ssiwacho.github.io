<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>การเรียนรู้เชิงลึก</title>

        <script src="DL2_files/header-attrs-2.7/header-attrs.js"></script>
        <script src="DL2_files/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="DL2_files/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="DL2_files/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="DL2_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="DL2_files/navigation-1.1/tabsets.js"></script>
        <link href="DL2_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="DL2_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="DL2_files/robobook-0.1/robobook.css" rel="stylesheet" />
        <link href="DL2_files/robobook-0.1/robobook_fonts_embed.css" rel="stylesheet" />
        <script src="DL2_files/robobook-0.1/robobook.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
            <!-- robobook start -->   
   <div class="book with-summary">
      <div class="book-summary">
        <ul>
          <li class="title">การเรียนรู้เชิงลึก</li>
          <li class="divider"></li>
        </ul>
        <nav role="navigation" id="toc">
          <ul>
          <li><a href="#introduction"><strong>Introduction</strong></a>
          <ul>
          <li><a href="#deep-learning-model"><strong>Deep learning model</strong></a></li>
          <li><a href="#activation-function"><strong>Activation function</strong></a></li>
          <li><a href="#ประเภทของ-dl-model"><strong>ประเภทของ ​DL model</strong></a></li>
          </ul></li>
          <li><a href="#the-first-dl-model-slp-and-mlp-with-keras"><strong>The first DL model (SLP and MLP) with Keras</strong></a>
          <ul>
          <li><a href="#ติดตั้ง-package">ติดตั้ง package</a></li>
          <li><a href="#regression-example">Regression example</a></li>
          <li><a href="#classification-example">Classification example</a></li>
          </ul></li>
          </ul>
        </nav>
        <ul class="authors">
          <li class="divider"></li>
                            </ul>     
      </div>
      <div class="book-body fixed">
        <div class="body-inner">
            <a class="btn pull-left js-toolbar-action toggle-sidebar" aria-label="Toggle Sidebar" title="Toggle Sidebar" href="#">
              <span class="glyphicon glyphicon-menu-hamburger"></span>
            </a>
            <div class="page-inner">
              <section id="content" class="normal">
      
   
        
      <h1 class="title">การเรียนรู้เชิงลึก</h1>
      
        

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<p style="line-height:1.3; font-size:16px; color: #353b48; text-align:right;">
สิวะโชติ ศรีสุทธิยากร </br> </br> ภาควิชาวิจัยและจิตวิทยาการศึกษา คณะครุศาสตร์ </br> จุฬาลงกรณ์มหาวิทยาลัย </br> </font> 13 May 2021 </font>
</p>
</body>
</html>
<div id="introduction" class="section level1">
<h1><strong>Introduction</strong></h1>
<div id="deep-learning-model" class="section level2">
<h2><strong>Deep learning model</strong></h2>
<p>โมเดล deep learning พื้นฐานที่สุดจะประกอบด้วยส่วนประกอบหลักที่เรียกว่าชั้น (layer) จำนวน 3 ส่วนได้แก่</p>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2009.15.17.png" style="width:50.0%" /></left></p>
<ul>
<li><p>input layer</p></li>
<li><p>hidden layer</p></li>
<li><p>output layer</p></li>
</ul>
<p>จากรูปจะเห็นว่าโมเดลมี input layer ที่ประกอบด้วยหน่วยย่อยหรือที่เรียกว่า นิวรอน (neurons) จำนวน 2 หน่วย โดยนิวรอนใน input layer จะใช้แทนตัวแปรอิสระของโมเดล ในที่นี้จะได้ว่า <span class="math inline">\(X = [x_1, x_2]\)</span></p>
<p>โมเดลจะนำข้อมูลนำเข้าใน input layer ที่กำหนดมาประมวลผลเป็น hidden layer และส่งผ่านค่าไปยัง output layer ในท้ายที่สุด</p>
<p>การประมวลผลของ neuron ใน hidden layer จะนำข้อมูลของ neuron ที่อยู่ใน layer ก่อนหน้ามาคำนวณผลรวมเชิงเส้นแบบถ่วงน้ำหนัก จากตัวอย่างของ deep learning model ในข้างต้น จะได้ว่าผลรวมเชิงเส้นของแต่ละ neuron ใน hidden layer คำนวณได้ดังนี้</p>
<p><span class="math inline">\(h_j=b+w_1x_1+w_2x_2\)</span></p>
<p>เรียก <span class="math inline">\(w_k\)</span> ว่าน้ำหนัก (weight) และ <span class="math inline">\(b\)</span> ว่าค่าความลำเอียง (bias)</p>
<p>โดยทั่วไปมีความเป็นไปได้ที่ค่าของผลรวมเชิงเส้นที่คำนวณได้ข้างต้นจะมีพิสัยที่ไม่สอดคล้องกับตัวแปรตามที่ต้องการทำนาย จึงมีการนำค่าผลรวมเชิงเส้นดังกล่าวมาแปลงค่าด้วยฟังก์ชันที่เรียกว่า activation function ก่อนที่จะส่งค่าไปยัง neuron ใน layer ถัดไป ดังตัวอย่างในรูปด้านล่าง</p>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2009.35.57.png" style="width:70.0%" /></left></p>
</div>
<div id="activation-function" class="section level2">
<h2><strong>Activation function</strong></h2>
<p>activation function เป็นฟังก์ชันทางคณิตศาสตร์ ที่ผู้วิเคราะห์ใช้สำหรับแปลงค่าผลรวมเชิงเส้นของข้อมูลนำเข้า ให้มีพิสัยอยู่ในช่วงที่สมเหตุสมผลหรือสอดคล้องกับตัวแปรตามที่ต้องการทำนาย</p>
<p>activation function ที่ใช้ในการวิเคราะห์มีได้หลากหลาย โดยอาจจำแนกเป็น 2 ประเภทได้แก่ <strong>linear activation function</strong> ซึ่งเขียนในรูปทั่วไปดังนี้</p>
<p><span class="math inline">\(\sigma(x)=m(x)+c\)</span></p>
<p>ฟังก์ชันประเภทนี้จะไม่ได้ทำให้พิสัยของข้อมูลนำเข้าเปลี่ยนแปลงไปจากเดิม กล่าวคือหาก <span class="math inline">\(x \in [-\infty, \infty]\)</span> แล้ว <span class="math inline">\(\sigma(x) \in [-\infty, \infty]\)</span> เช่นเดิม แต่อาจช่วยแปลงสเกลของข้อมูลนำเข้าให้เหมาะสมมากหรือใกล้เคียงกับช่วงที่เป็นไปได้ของตัวแปรตามมากขึ้น ดังตัวอย่างในรูปด้านล่าง</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-1-1.png" width="480" /></p>
<p>และ <strong>nonlinear activation function</strong> ซึ่งมักใช้ใช้บ่อยกว่า linear activation function ทั้งนี้เป็นเพราะมีความสามารถที่จะแปลงพิสัยของข้อมูลนำเข้าให้อยู่ในช่วงที่เหมาะสมได้ เช่นแปลง <span class="math inline">\(x \in [-\infty, \infty]\)</span> ให้อยู่ในช่วง <span class="math inline">\([0,1]\)</span> หรือ <span class="math inline">\([0, \infty]\)</span> หรือ <span class="math inline">\([-1,1]\)</span></p>
<div id="ตัวอย่าง-activation-function" class="section level3">
<h3>ตัวอย่าง activation function</h3>
<p><strong>Sigmoid function:</strong> <span class="math inline">\(\sigma(x)=\frac{1}{1+exp(-x)}\)</span></p>
<p>เหมาะสำหรับใช้เป็น activation function ในปัญหา binary classification ฟังก์ชันนี้จะแปลงข้อมูลนำเข้าในอยู่ในพิสัย <span class="math inline">\([0,1]\)</span></p>
<p><strong>Hyperbolic Tangent function:</strong> <span class="math inline">\(\sigma(x)=\frac{e^x-e^{-x}}{e^x+e^{-x}}\)</span></p>
<p>ฟังก์ชันนี้มีลักษณะคล้ายกับ sigmoid function แต่พิสัยของฟังก์ชันจะอยู่ในช่วง <span class="math inline">\([-1,1]\)</span> บางครั้งเรียกว่า sigmoidal funcion หรือ tanh function</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Rectified Linear Unit:</strong> <span class="math inline">\(\sigma(x)=max(0,x)\)</span></p>
<p>เป็น activation function ที่มักใช้บ่อยใน hidden layer โดยพิสัยของฟังก์ชันจะอยู่ในช่วง <span class="math inline">\([0,\infty]\)</span> ดังรูป</p>
<p><img src="DL2_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Leaky Rectified Linear Unit:</strong> <span class="math inline">\(\sigma(x)= \begin{cases} x,&amp; \text{if } x\geq 1\\ax, &amp; \text{otherwise}\end{cases}\)</span></p>
<p><img src="DL2_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Softmax</strong></p>
<p>softmax activation function เป็น function ที่เหมาะสำหรับใช้ในปัญหา multi-class classification จากสูตรของฟังก์ชันจะเห็นว่าผลลัพธ์ที่ได้จะเป็นความน่าจะเป็นที่มีพิสัยอยู่ในช่วง <span class="math inline">\([0,1]\)</span></p>
<p>กำหนดให้ <span class="math inline">\(x=(x_1, x_2, x_3, x_4)\)</span> เป็นเวกเตอร์ของข้อมูลนำเข้า และตัวแปรตามเป็นตัวแปรแบบจัดประเภทที่มี 3 ระดับได้แก่ <span class="math inline">\(a, b, c\)</span></p>
<p>สมมุติว่าต้องการหาความน่าจะเป็นของการเกิดผลลัพธ์ <span class="math inline">\(a, b, c\)</span> เมื่อกำหนดข้อมูลนำเข้า <span class="math inline">\(x\)</span> จะสามารถหาได้โดยใช้ความน่าจะเป็นแบบมีเงื่อนไข (conditional probability) ดังนี้</p>
<p><span class="math inline">\(P(a|x)=\frac{y_a}{y_a+y_b+y_c}\)</span></p>
<p><span class="math inline">\(P(b|x)=\frac{y_b}{y_a+y_b+y_c}\)</span></p>
<p><span class="math inline">\(P(c|x)=\frac{y_c}{y_a+y_b+y_c}\)</span></p>
<p>เมื่อ</p>
<p><span class="math inline">\(y_a=w_{1,a}x_1+w_{2,a}x_2+w_{3,a}x_3+w_{4,a}x_4\)</span></p>
<p><span class="math inline">\(y_b=w_{1,b}x_1+w_{2,b}x_2+w_{3,b}x_3+w_{4,b}x_4\)</span></p>
<p><span class="math inline">\(y_c=w_{1,c}x_1+w_{2,c}x_2+w_{3,c}x_3+w_{4,c}x_4\)</span></p>
<p>จะสังเกตเห็นว่า <span class="math inline">\(P(a|x)+P(b|x)+P(c|x)=1\)</span></p>
<p>เนื่องจากผลรวมเชิงเส้นในข้างต้นมีพิสัยเป็นจำนวนจริง จึงทำให้ผลรวมเชิงเส้นดังกล่าวสามารถมีค่าติดลบได้ ซึ่งอาจส่งผลให้ค่าความน่าจะเป็นแบบมีเงื่อนไขมีค่าอยู่นอกช่วง <span class="math inline">\([0,1]\)</span></p>
<p>เพื่อแก้ปัญหานี้จึงมีการใช้ฟังก์ชัน exponential แปลงพิสัยของผลรวมเชิงเส้นที่เป็นจำนวนจริงให้อยู่ในช่วง <span class="math inline">\([0, \infty]\)</span> ซึ่งทำให้ sofmax activation function สามารถเขียนในรูปทั่วไปได้ดังนี้</p>
<p>กำหนดให้ <span class="math inline">\(x = (x_1, x_2, x_3, ..., x_p)^T\)</span> เป็นเวกเตอร์ข้อมูลนำเข้าของตัวแปรอิสระจำนวน <span class="math inline">\(p\)</span> ตัว และ <span class="math inline">\(y\)</span> เป็นตัวแปรตามแบบจัดประเภทที่มีจำนวน <span class="math inline">\(k\)</span> ระดับ softmax activation function นิยามดังนี้</p>
<p><span class="math inline">\(\sigma(x)=P(y=y_m|x)=\frac{exp(x_i)}{\sum_{j=1}^pexp(x_j)}\)</span></p>
<p>เมื่อ <span class="math inline">\(i = 1,2,...,p\)</span> และ <span class="math inline">\(m = 1,2,...,k\)</span></p>
<p>์Note: สังเกตว่า DL model ทำนายตัวแปรตามที่ต้องการด้วยการแยกส่วนการประมวลผลออกเป็นส่วนย่อย ๆ หลาย ๆ ส่วน โดยที่แต่ละส่วนถูกบรรจุอยู่ใน neuron</p>
</div>
</div>
<div id="ประเภทของ-dl-model" class="section level2">
<h2><strong>ประเภทของ ​DL model</strong></h2>
<ul>
<li><p>Multilayer Perceptron Model (MLP models)</p></li>
<li><p>Convolutional Neural Network (CNNs)</p></li>
<li><p>Recurrent Neural Network (RNNs)</p></li>
<li><p>Restricted Boltzmann Machines (RBMs)</p></li>
<li><p>Deep Belief Networks (DBNs)</p></li>
</ul>
</div>
</div>
<div id="the-first-dl-model-slp-and-mlp-with-keras" class="section level1">
<h1><strong>The first DL model (SLP and MLP) with Keras</strong></h1>
<p><img src="1200px-Keras_logo.png" style="width:30.0%" /></p>
<p>หนังสือบางเล่มเรียก DL ประเภทนี้ว่า Feedforward neural networks (FFNNs) เป็นโมเดล DL พื้นฐานที่ใช้กันทั่วไป ภายในโมเดลประกอบด้วย input, hidden และ output layers ดังที่กล่าวมาแล้ว โมเดลประเภทนี้สามารถประยุกต์ใช้ได้กับทั้งปัญหา classification และ regression</p>
<p>หัวข้อนี้จะกล่าวถึงการสร้าง DL model พื้นฐานโดยใช้ package-keras</p>
<p><img src="Screen%20Shot%202564-05-14%20at%2010.04.28.png" /></p>
<p>นิสิตสามารถศึกษาภาพรวมของ package-keras ได้จากคลิปด้านล่าง</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/j_pJmXJwMLA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<div id="ติดตั้ง-package" class="section level2">
<h2>ติดตั้ง package</h2>
<p>keras สามารถติดตั้งและเรียกใช้งานได้ทั้งบน python และ R</p>
<div id="สำหรับ-python" class="section level3">
<h3>สำหรับ python</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pip install <span class="op">--</span>upgrade tensorflow</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pip install keras</span></code></pre></div>
</div>
<div id="สำหรับ-r" class="section level3">
<h3>สำหรับ R</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;keras&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_keras</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(keras)</span></code></pre></div>
</div>
</div>
<div id="regression-example" class="section level2">
<h2>Regression example</h2>
<p>จากชุดข้อมูล crimm.csv</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;/Users/siwachoat/Library/Mobile Documents/com~apple~CloudDocs/เอกสารประกอบการสอน/Machine Learning/เอกสาร/ep2_regression/_02_multiple regression/crimm.csv&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code></pre></div>
<pre><code>  householdSize pct.lao pct.thai pct.myanmar pct.cambodia numPop.urban
1          3.10    1.37    91.78        6.50         1.88        11980
2          2.82    0.80    95.57        3.44         0.85        23123
3          2.43    0.74    94.33        3.43         2.35        29344
4          2.40    1.70    97.35        0.50         0.70            0
5          2.76    0.53    89.16        1.17         0.52            0
6          2.45    2.51    95.65        0.90         0.95       140494
  medIncome.household pctWPubAsst pctPop.poor pchLessM3 PctUnemployed
1               75122        1.03        1.96      5.81          2.70
2               47917        2.75        3.98      5.61          2.43
3               35669        2.94        4.75      2.80          4.01
4               20580       11.71       17.23     11.05          9.86
5               17390       11.21       29.99     12.15          9.08
6               21577        7.12       17.78      8.76          5.72
  NumIlllegal.labor HousVacant Num.HomelessInShelters Num.HomelessInStreet
1              1277         64                     11                    0
2              1920        240                      0                    0
3              1468        544                     16                    0
4               339        669                      0                    0
5               196        333                      2                    0
6              2091       5119                    327                    4
  PopDens TheifperPop
1  1845.9      114.85
2  2186.7      242.37
3  2780.9      758.14
4  3217.7     1301.78
5   974.2      728.93
6  1995.7     1386.46</code></pre>
<p>สมมุติว่าต้องการสร้างโมเดลทำนายอัตราการเกิดคดีโจรกรรมในแต่ละพื้นที่โดยใช้ตัวแปรอิสระทั้งหมดที่มีในชุดข้อมูล</p>
<div id="import-and-manipulating-data" class="section level3">
<h3>1. Import and manipulating data</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>train.id <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(dat<span class="sc">$</span>TheifperPop, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> F)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[train.id, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(training) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>training_outcome <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[train.id, <span class="dv">17</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>testing <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[<span class="sc">-</span>train.id, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(testing) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>testing_outcome <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat[<span class="sc">-</span>train.id, <span class="dv">17</span>])</span></code></pre></div>
</div>
<div id="create-the-model-in-python" class="section level3">
<h3>2. Create the Model (in Python)</h3>
<p>ระบุ DL model โดยกำหนดให้มี hidden layer 1 ชั้น จำนวน 5 neurons</p>
<p>การสร้างโมเดล DL ข้างต้นด้วย Sequential API ของ Keras package สามารถทำได้โดยเขียนคำสั่งดังนี้</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#1. Create a Sequential model</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#2. Add an input layer and a hidden layer with 2 neurons.</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">5</span>, input_shape<span class="op">=</span>[<span class="dv">16</span>],</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">5</span>, activation<span class="op">=</span><span class="st">&quot;relu&quot;</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#3. Add 1-neuron output layer</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#4. model summary</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#5. compile and train the model</span></span></code></pre></div>
<pre><code>Model: &quot;sequential_48&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_138 (Dense)            (None, 5)                 85        
_________________________________________________________________
dense_139 (Dense)            (None, 5)                 30        
_________________________________________________________________
dense_140 (Dense)            (None, 1)                 6         
=================================================================
Total params: 121
Trainable params: 121
Non-trainable params: 0
_________________________________________________________________</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer <span class="op">=</span> <span class="st">&quot;adam&quot;</span>, loss <span class="op">=</span> <span class="st">&quot;mse&quot;</span>)  <span class="co">#compiling</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># manipulating data</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> np.array(r.training)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>train_out <span class="op">=</span> np.array(r.training_outcome)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> np.array(r.testing)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>test_out<span class="op">=</span> np.array(r.testing_outcome)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(train, train_out, epochs<span class="op">=</span><span class="dv">500</span>, verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#training</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#7. calcualte the predicted value using training model</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># การคำนวณค่าทำนายของตัวแปรตามสามารถทำได้โดยใช้ method `predict()` ดังนี้</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.predict(test)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#8. Model Evaluation</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ผู้วิเคราะห์ยังสามารถเรียกดู performance metric ของโมเดลได้โดยใช้ method `evaluate()` ดังตัวอย่างต่อไปนี้</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> model.evaluate(test, test_out)</span></code></pre></div>
<pre><code>
 1/14 [=&gt;............................] - ETA: 0s - loss: 174522.9844
14/14 [==============================] - 0s 568us/step - loss: 259533.5312</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>math.sqrt(mse) <span class="co">#RMSE</span></span></code></pre></div>
<pre><code>509.44433577182895</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(pred, test_out)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="DL2_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;loss&#39;</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;model loss&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;loss&#39;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;epoch&#39;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;train&#39;</span>, <span class="st">&#39;test&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="DL2_files/figure-html/unnamed-chunk-9-2.png" width="768" /></p>
</div>
</div>
<div id="classification-example" class="section level2">
<h2>Classification example</h2>
<p>```</p>
<p><left><img src="Screen%20Shot%202564-05-13%20at%2013.44.05.png" style="width:40.0%" /></left></p>
</div>
</div>

   
   
           </section>
  </div>
  </div>
  </div>
  </div>
      
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
