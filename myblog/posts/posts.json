[
  {
    "path": "posts/2022-02-19-glm1/",
    "title": "GLM1",
    "description": "General Linear Modeling",
    "author": [
      {
        "name": "Siwachoat Srisuttiyakorn",
        "url": {}
      }
    ],
    "date": "2022-02-19",
    "categories": [],
    "contents": "\n\nContents\nBayesian alternative to t-test\nTraditional Independent-sample t-test\nBayesian approach 1\nกิจกรรม 1\nBayesian approach 2\nกิจกรรม 2\n\nPosterior Predictive Check\nPosterior Predictive P-value (PPP)\n\nBayesian Alternative to ANOVA\n\nBayesian alternative to t-test\nกิจกรรมนี้จะกล่าวถึงการใช้สถิติแบบเบส์สำหรับการวิเคราะห์เพื่อเปรียบเทียบค่าเฉลี่ยสองกลุ่ม ผู้อ่านจะเห็นว่าการวิเคราะห์แบบเบส์เป็นวิธีการที่ให้สารสนเทศเกี่ยวกับความแตกต่างของค่าเฉลี่ยระหว่างตัวอย่างสองกลุ่มที่มากกว่าการทดสอบ t-test แบบดั้งเดิม\nการเปรียบเทียบด้วยวิธีการแบบเบส์ทำให้ผู้วิเคราะห์สามารถประมาณการแจกแจงความน่าจะเป็นภายหลัง ซึ่งเป็นข้อมูลสำคัญสำหรับการคำนวณช่วงความน่าเชื่อถือ (credible intervals) ของพารามิเตอร์ต่าง ๆ ได้แก่ ค่าเฉลี่ย ส่วนเบี่ยงเบนมาตรฐาน รวมทั้งความแตกต่างระหว่างค่าเฉลี่ย ส่วนเบี่ยงเบนมาตรฐาน และขนาดอิทธิพล\nผลการทดสอบเพื่อเปรียบเทียบความแตกต่างของค่าเฉลี่ยสามารถตัดสินใจได้ทั้ง การยอมรับสมมุติฐานหลัก (accept null hypothesis) และยอมรับสมมุติฐานทางเลือก (accept alternative hypothesis) ซึ่งแตกต่างและมีความยืดหยุ่นมากกว่าการทดสอบเพื่อเปรียบเทียบค่าเฉลี่ยแบบดั้งเดิมอย่างมาก\nTraditional Independent-sample t-test\nสมมุติว่านักวิจัยต้องการเปรียบเทียบความแตกต่างของผลสัมฤทธิ์ทางการเรียนวิชาคณิตศาสตร์ และทักษะการแก้ปัญหา ระหว่างนักเรียนที่ได้รับการสอนแบบบรรยาย และแบบใช้ปัญหาเป็นฐาน ข้อมูลค่าสังเกตเป็นดังนี้\n\n\nset.seed(1253)\ndat<-data.frame(Ach=c(rnorm(50,50,5),rnorm(50,48,15)),\n                Solve=c(rt(50,3,0)*5+50,rt(50,3,0)*10+70),\n                Method=c(rep(1,50),rep(2,50)))\nhead(dat)\n\n\n       Ach    Solve Method\n1 57.88928 50.01438      1\n2 51.20072 49.48460      1\n3 43.34361 43.94092      1\n4 55.12593 48.40898      1\n5 45.35700 50.11348      1\n6 53.47266 56.45850      1\n\ntail(dat)\n\n\n         Ach    Solve Method\n95  57.27558 59.71888      2\n96  55.89447 71.65605      2\n97  54.42124 66.07296      2\n98  50.62769 70.03023      2\n99  44.82859 79.04969      2\n100 46.05098 99.74767      2\n\nsummary(dat)\n\n\n      Ach            Solve            Method   \n Min.   :20.93   Min.   : 28.48   Min.   :1.0  \n 1st Qu.:43.60   1st Qu.: 49.28   1st Qu.:1.0  \n Median :49.68   Median : 57.62   Median :1.5  \n Mean   :49.06   Mean   : 60.96   Mean   :1.5  \n 3rd Qu.:55.05   3rd Qu.: 70.84   3rd Qu.:2.0  \n Max.   :80.01   Max.   :117.62   Max.   :2.0  \n\nโดยที่ Ach และ Solve คือผลสัมฤทธ์และทักษะการแก้ปัญหาตามลำดับ ส่วน TMethod = 1 คือกลุ่มนักเรียนที่ได้รับการสอนแบบบรรยาย และ TMethod = 2 คือกลุ่มนักเรียนที่ได้รับการสอนแบบใช้ปัญหาเป็นฐาน\n\n\npar(mfrow=c(1,2))\nplot(density(dat$Ach[1:50]),type=\"l\", main=\"Ach\", xlim=c(0,100), lty=1)\npoints(density(dat$Ach[51:100]),type=\"l\", main=\"\", lty=2)\nlegend(0,0.06, legend=c(\"LEC\",\"PBL\"),lty=c(1,2), bty=\"n\")\n\nplot(density(dat$Solve[1:50]),type=\"l\", main=\"Solve\", xlim=c(0,100), lty=1)\npoints(density(dat$Solve[51:100]),type=\"l\", main=\"\", lty=2)\nlegend(0,0.04, legend=c(\"LEC\",\"PBL\"),lty=c(1,2), bty=\"n\")\n\n\n\n\nหากทำการวิเคราะห์ด้วยสถิติทดสอบ t-test แบบดั้งเดิม พบว่าได้ผลการวิเคราะห์ดังนี้\n\n\n    Welch Two Sample t-test\n\ndata:  Ach by Method\nt = 1.9067, df = 66.984, p-value = 0.06085\nalternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0\n95 percent confidence interval:\n -0.179778  7.852900\nsample estimates:\nmean in group 1 mean in group 2 \n       50.97567        47.13911 \n\n    Welch Two Sample t-test\n\ndata:  Solve by Method\nt = -9.0266, df = 70.811, p-value = 2.144e-13\nalternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0\n95 percent confidence interval:\n -27.47607 -17.53326\nsample estimates:\nmean in group 1 mean in group 2 \n       49.70763        72.21230 \n\nผลการวิเคราะห์ที่ได้จาก t-test ข้างต้นให้สารสนเทศใดแก่ผู้วิเคราะห์บ้าง?\nBayesian approach 1\nการเปรียบเทียบค่าเฉลี่ยด้วยวิธีการแบบเบส์สามารถทำได้หลายวิธีการ วิธีการหนึ่งที่สามารถทำได้อาจกำหนดโมเดลดังรูปด้านล่าง\n\nจากรูปจะเห็นว่ามีการกำหนดโมเดลให้กับค่าสังเกตในแต่ละกลุ่มเป็นการแจกแจงแบบปกติที่มีค่าเฉลี่ยเท่ากับ \\(\\mu_1\\) และ \\(\\mu2\\) และพารามิเตอร์ความเที่ยงตรงเท่ากับ \\(\\tau_1\\) และ \\(\\tau_2\\) ตามลำดับ และได้มีการกำหนดการแจกแจงความน่าจะเป็นเบื้องต้นให้กับพารามิเตอร์ต่าง ๆ ของโมเดลค่าสังเกต โดยพารามิเตอร์ค่าเฉลี่ยมีการแจกแจงความน่าจะเป็นเบื้องต้นเป็นการแจกแจงแบบปกติ ส่วนพารามิเตอร์ความเที่ยงตรงมีการแจกแจงความน่าจะเป็นเบื้องต้นเป็นแบบแกมมา (Gamma distribution)\nการแจกแจงแบบแกมมา มีพารามิเตอร์กำกับการแจกแจง 2 ตัวได้แก่ shape และ rate parameters ซึ่งเขียนแทนด้วยสัญลักษณ์ \\(\\alpha>0\\) และ \\(\\beta >0\\) และมีฟังก์ชันความน่าจะเป็นดังนี้\n\\(p(\\theta)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\theta^{\\alpha-1}exp\\{-\\beta \\theta \\}\\) โดยที่ \\(\\theta>0\\)\nรูปต่อไปนี้แสดงตัวอย่างการแจกแจงความน่าจะเป็นแบบแกมมา เมื่อกำหนดพารามิเตอร์เป็นค่าต่าง ๆ\n\n\npar(mfrow=c(1,2), mar=c(5,5,1,1))\ntheta<-seq(0,5,0.01)\nplot(theta, dgamma(theta,1,1), type=\"l\", col=2, ylab=\"Density\", xlab=expression(tau))\npoints(theta, dgamma(theta,2,1), type=\"l\", col=3)\npoints(theta, dgamma(theta,3,1), type=\"l\", col=4)\npoints(theta, dgamma(theta,5,1), type=\"l\", col=5)\n\nplot(theta, dgamma(theta,1,2), type=\"l\", col=2, ylab=\"Density\", xlab=expression(tau))\npoints(theta, dgamma(theta,1,4), type=\"l\", col=3)\npoints(theta, dgamma(theta,1,6), type=\"l\", col=4)\npoints(theta, dgamma(theta,1,10), type=\"l\", col=5)\n\n\n\n\nแนวทางการกำหนดค่าพารามิเตอร์ในการแจกแจงความน่าจะเป็นก่อนหน้าของพารามิเตอร์ความเที่ยงตรง (\\(\\tau\\)) การทำได้สองลักษณะ ลักษณะแรกคือ noninformative prior อาจกำหนดให้พารามิเตอร์ \\(\\alpha\\) และ \\(\\beta\\) มีค่าน้อย ๆ เช่น dgamma(0.01,0.01) หรือ dgamma(0.001,0.001) รูปด้านล่างแสดงตัวอย่างของการแจกแจงดังกล่าว\n\n\n\nอีกลักษณะหนึ่งคือการกำหนดให้มีสารสนเทศในการแจกแจงความน่าจะเป็นก่อนหน้า โดยอาจมองว่าพารามิเตอร์ \\(\\alpha\\) มีค่าเท่ากับฐานนิยมของ \\(\\tau\\) และ \\(\\beta\\) มีค่าเท่ากับส่วนเบี่ยงเบนมาตรฐานของ \\(\\tau\\) (Kruschke, 2012)\nกิจกรรม 1\nดำเนินการวิเคราะห์ข้อมูลเพื่อเปรียบเทียบค่าเฉลี่ยผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ ระหว่างกลุ่มนักเรียนที่ได้รับการสอนแบบบรรยายและใช้ปัญหาเป็นฐาน ด้วยวิธีการแบบเบส์ โดยใช้การกำหนดโมเดลข้างต้น แล้วตอบคำถามต่อไปนี้\nตัวอย่างพารามิเตอร์ที่จำลองจากอัลกอริทึม MCMC มีคุณสมบัติที่เหมาะสมสำหรับนำไปวิเคราะห์เพื่อตอบคำถามข้างต้นหรือไม่ เพราะเหตุใด\nผลการวิเคราะห์เพื่อเปรียบเทียบความแตกต่างของผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ระหว่างกลุ่มนักเรียนทั้งสองกลุ่มเป็นอย่างไร?\nสารสนเทศที่ได้จากการวิเคราะห์ด้วยสถิติแบบเบส์ กับสถิติแบบดั้งเดิมมีความแตกต่างกันอย่างไร\nBayesian approach 2\nการกำหนดโมเดลสำหรับวิเคราะห์ข้อมูลด้วยสถิติแบบเบส์สามารถกำหนดได้อย่างหลากหลาย กล่าวคือในปัญหาเดียวกันหากผู้วิเคราะห์มีมุมมองหรือกรอบแนวคิดที่แตกต่างกันก็สามารถกำหนดโมเดลการวิเคราะห์ที่แตกต่างกันได้ รูปด้านล่างแสดงการกำหนดโมเดลสำหรับเปรียบเทียบค่าเฉลี่ยสองกลุ่มในอีกลักษณะหนึ่ง\n เมื่อเปรียบเทียบกับโมเดลที่ 1 ที่ได้ดำเนินการวิเคราะห์ไปแล้ว นิสิตคิดว่าโมเดลนี้มีความเหมือนและแตกต่างไปจากเดิมอย่างไรบ้าง?\nทั้งนี้การแจกแจงความน่าจะเป็นแบบทีดังกล่าวเป็นอีก version หนึ่งเรียกว่า Generalized student’s t distribution ซึ่งมีพารามิเตอร์กำกับการแจกแจง 3 ตัวได้แก่ ค่าเฉลี่ย ส่วนเบี่ยงเบนมาตรฐาน และองศาความเป็นอิสระ (\\(\\nu>0\\)) และมีฟังก์ชันความน่าจะเป็นดังนี้\n\\(p(y|\\mu, \\sigma, \\nu)=\\frac{\\Gamma(\\frac{\\nu+1}{2})}{\\Gamma(\\frac{\\nu}{2})\\sqrt{\\pi\\nu}\\sigma}(1+\\frac{1}{\\nu}(\\frac{y-\\mu}{\\sigma})^2)^{-\\frac{\\nu+1}{2}}\\)\nการเลิือกใช้การแจกแจงแบบทีเป็นโมเดลค่าสังเกตมีข้อดีกว่าการแจกแจงแบบปกติคือ การแจกแจงแบบทีเป็นการแจกแจงที่มีส่วนปลาย (หาง) ของการแจกแจงที่หนากว่าการแจกแจงแบบปกติ ซึ่งทำให้โมเดลของค่าสังเกตมีความแกร่งต่อการเกิดค่าผิดปกติ (outlier) มากกว่าโมเดลที่ใช้การแจกแจงแบบปกติ ความหนา ณ ส่วนปลายของการแจกแจงแบบทีสามารถกำหนดผ่านค่าพารามิเตอร์องศาความเป็นอิสระ (\\(\\nu\\)) โดยถ้า \\(\\nu\\) ยิ่งมีค่าน้อย การแจกแจงทีจะยิ่งมีส่วนปลายที่หนาขึ้น ในทางกลับกันหาก \\(\\nu\\) มีค่ามาก การแจกแจงทีดังกล่าวจะลู่เข้าหาการแจกแจงแบบปกติ กล่าวได้ว่าโมเดลนี้เป็นกรณีทั่วไปของ model 1 ที่ได้กล่าวไว้ก่อนหน้านี้นั่นเอง รูปต่อไปนี้แสดงฟังก์ชันความหนาแน่นของการแจกแจงความน่าจะเป็นแบบที เมื่อมีองศาความเป็นอิสระต่าง ๆ กัน\n\n\npar(mar=c(5,5,1,1))\nx<-seq(-6,6,0.01)\nplot(x, dnorm(x,0,1), type=\"l\", lty=1, ylab=\"Density\")\npoints(x, dt(x,1), type=\"l\",lty=2)\npoints(x, dt(x,2), type=\"l\",lty=3)\npoints(x, dt(x,3), type=\"l\",lty=4)\npoints(x, dt(x,5), type=\"l\",lty=5)\npoints(x, dt(x,10), type=\"l\",lty=6)\n\ntext(0,0.1, \"t-Distribution\")\ntext(2, 0.38, \"Normal Distriibution\")\n\n\n\n\nนอกจากการกำหนดโมเดลการวิเคราะห์ทั้งสอง ผู้วิเคราะห์ยังสามารถกำหนดโมเดลการวิเคราะห์อื่น ๆ ได้อย่างหลากหลาย ทั้งนี้ต้องคำนึงถึงธรรมชาติของข้อมูลและพารามิเตอร์ภายในโมเดลการวิเคราะห์ เช่น หากผู้วิเคราะห์สำรวจข้อมูลแล้วพบว่าข้อมูลคะแนนค่าสังเกตที่ต้องการนำมาวิเคราะห์มีการแจกแจงที่เบ้ขวา (positively skewed) ผู้วิเคราะห์อาจกำหนดโมเดลของค่าสังเกตเป็นการแจกแจงแบบ log-normal โดยอาจเขียนคำสั่งดังนี้\n\nmodel{\n  for(i in 1:n)\n  {\n    #log-normal likelihood\n    y[i]~dlnorm(log(mu[x[i]]),tau[x[i]])\n  }\n  \n  for(j in 1:2)\n  {\n    mu[j]~dnorm(m,t)\n    tau[j]~dgamma(a,b)\n  }\n}\n\nกิจกรรม 2\nดำเนินการวิเคราะห์ข้อมูลเพื่อเปรียบเทียบค่าเฉลี่ยผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ ระหว่างกลุ่มนักเรียนที่ได้รับการสอนแบบบรรยายและใช้ปัญหาเป็นฐาน ด้วยวิธีการแบบเบส์ โดยใช้การกำหนดโมเดลข้างต้น แล้วตอบคำถามต่อไปนี้\nตัวอย่างพารามิเตอร์ที่จำลองจากอัลกอริทึม MCMC มีคุณสมบัติที่เหมาะสมสำหรับนำไปวิเคราะห์เพื่อตอบคำถามข้างต้นหรือไม่ เพราะเหตุใด\nผลการวิเคราะห์เพื่อเปรียบเทียบความแตกต่างของผลสัมฤทธิ์และทักษะการแก้ปัญหาทางคณิตศาสตร์ระหว่างกลุ่มนักเรียนทั้งสองกลุ่มเป็นอย่างไร?\nระหว่างโมเดล 1 กับโมเดล 2 โมเดลใดเป็นโมเดลที่เหมาะสมมากกว่า เพราะเหตุใด\nPosterior Predictive Check\nposteior predictve check เป็นการตรวจสอบความสอดคล้องเชิงประจักษ์ของโมเดลการวิเคราะห์ ด้วยการเปรียบเทียบกันระหว่างค่าทำนายของตัวแปรตามที่ได้จากโมเดลกับค่าสังเกตจริงจากข้อมูลตัวอย่าง\n\n\ntwosamples=\n\"model{\n  #likelihood function\n  for(i in 1:n)\n  {\n    y[i]~dnorm(mu[x[i]],tau[x[i]])\n  }\n  \n  for (j in 1:2)\n  {\n  #prior distribution\n  mu[j]~dnorm(0,0.01)\n  tau[j]~dgamma(0.01,0.01)\n  \n  #deterministic nodes\n  sigma[j]<-sqrt(1/tau[j])\n  }\n  \n}\"\nlibrary(rjags)\nlibrary(runjags)\nlibrary(coda)\ndataList<-list(y=dat$Ach, x=dat$Method, n=dim(dat)[1])\nfit<-run.jags(method=\"rjparallel\",\n                        model=twosamples,\n                        monitor=c(\"mu\",\"sigma\"),\n                        data=dataList,\n                        n.chains=3,\n                        sample = 10000,\n                        thin=3,\n                        summarise=TRUE,\n                        plots=FALSE,\n                        keep.jags.files = FALSE)\n\n\nCompiling rjags model...\nNote: the model did not require adaptation\nStarting 3 rjags simulations using a Fork cluster with 3 nodes\non host 'localhost'\nSimulation complete\nCalculating summary statistics...\nCalculating the Gelman-Rubin statistic for 4 variables....\nFinished running the simulation\n\nขั้นตอนต่อไปนี้แสดงการสร้าง predictive value จาก posterior distribution โดยสุ่มเลือกค่าพารามิเตอร์ขึ้นมา 1000 ชุด เพื่อสร้าง posterior predictive distribution จำนวน 1000 ชุด โดยที่แต่ละชุดมีค่าสังเกตผลสัมฤทธิ์ทางการเรียนจำนวน 100 ค่า เหมือนกับข้อมูลตัวอย่างตั้งต้น\n\n\nsample<-as.mcmc.list(fit)\nsample<-as.matrix(sample)\ndim(sample)\n\n\n[1] 30000     4\n\nparam.id<-sample(1:30000,1000)\nsample<-sample[param.id,]\n\ny.rep<-matrix(nrow=100,ncol=1000)\nfor(i in 1:1000)\n{\ny1<-rnorm(50, sample[,1], sample[,3])\ny2<-rnorm(50, sample[,2], sample[,4])\ny.rep[,i]<-c(y1,y2)\n}\n\n### example of posterior predictive distribution\n\npar(mfrow=c(4,4), mar=c(1,1,1,1))\nfor(i in 1:16)\n{\n  hist(y.rep[,i], col=\"skyblue\", border=\"white\", main=\"\", nclass=30)\n}\n\n\n\n\nการใช้งาน posterior predictive distribution คือการพิจารณาว่าการแจกแจง predictive ดังกล่าวมีความลำเอียงไปจากการแจกแจงของข้อมูลค่าสังเกตอย่างมีนัยสำคัญหรือไม่ รูปต่อไปนี้แสดงการเปรียบเทียบระหว่าง posterior predictive ที่สร้างขึ้นกับข้อมูลจริง\n\n\n\nนอกจากการตรวจสอบด้วย visualization ในข้างต้นแล้ว ยังสามารถเปรียบเทียบ posterior predictve กับข้อมูลจริงด้วยค่าสถิติ เช่น\nPosterior Predictive P-value (PPP)\nbayesian p-value เป็นวิธีการหนึ่งที่ใช้นำเสนอความแตกต่างระหว่างค่าสังเกตจริงกับค่าทำนายของโมเดล การคำนวณค่า bayesian p-value สามารถทำได้หลายลักษณะขึ้นอยู่กับค่าสถิติที่เลือกใช้ นิยามของค่า PPP เป็นดังนี้\n\\(PPP = P(T(y^{rep}) \\geq T(y))\\)\nเมื่อ \\(T(.)\\) คือ discrepancy measures หรือ test quantiles ที่จะใช้เป็นตัวเปรียบเทียบระหว่างการแจกแจงของ posterior predictive กับ observed value การกำหนด test quantile ดังกล่าวสามารถทำได้หลายลักษณะและไม่ได้มีกฎเกณฑ์ตายตัว ขึ้นอยู่กับว่าผู้วิเคราะห์ต้องการสารสนเทศในเชิงการเปรียบเทียบแบบใด ค่า test quantile ที่มักใช้ได้แก่ ค่าต่ำสุด ค่าสูงสุด ค่าเฉลี่ย และส่วนเบี่ยงเบนมาตรฐาน ตัวอย่างต่อไปนี้แสดงการคำนวณค่า PPP ข้างต้น\n\n\n TRUE \n0.271 \n\n\n\nTRUE \n 0.2 \n\nจากนิยามของ PPP ข้างต้นจะเห็นว่าหาก PPP มีค่าเข้าใกล้ 0 หรือ 1 นั่นหมายความว่าโมเดลการวิเคราะห์สร้าง predictive value ที่มีความแตกต่าง/ลำเอียง ไปจากข้อมูลจริงอย่างมาก ดังนั้น PPP = 0.5 จึงหมายความว่าโมเดลมีความสอดคล้องกับข้อมูลจริงอย่างสมบูรณ์ ในทางปฏิบัติไม่ได้มีการกำหนด cut-off ไว้แน่นอน แต่ค่า cut-off ที่มักใช้กันคือ PPP<0.05,0.1 หรือ PPP>0.90,0.95\nBayesian Alternative to ANOVA\nนักวิจัยทดลองใช้วิธีการสอน 4 วิธี กับนักเรียนจำนวน 4 กลุ่มที่มีการวิเคราะห์แล้วว่ามีพื้นฐานใกล้เคียงกัน เมื่อสอนจบตามแผนแล้วมีการวัดผลการเรียนรู้ภายหลัง ได้ผลดังนี้\n\n\nlec\n\n\npbl\n\n\ncop\n\n\ndem\n\n\n5\n\n\n11\n\n\n6\n\n\n3\n\n\n6\n\n\n8\n\n\n9\n\n\n4\n\n\n7\n\n\n7\n\n\n8\n\n\n1\n\n\n3\n\n\n7\n\n\n5\n\n\n1\n\n\n7\n\n\n9\n\n\n4\n\n\n4\n\n\n5\n\n\n7\n\n\n4\n\n\n5\n\n\n2\n\n\n8\n\n\n7\n\n\n2\n\n\n4\n\n\n10\n\n\n6\n\n\n3\n\n\nโมเดลการวิเคราะห์ความแปรรปวนทางเดียวสามารถเขียนได้สองลักษณะ ลักษณะแรกเรียกว่า mean model เขียนได้ดังนี้\n\\(y_{ij}=\\mu_j+\\epsilon_{ij}\\)\nอีกลักษณะหนึ่งคือ effect model\n\\(y_{ij}=\\mu+\\alpha_j+\\epsilon_{ij}\\) เมื่อ \\(\\sum_{j=1}^J\\alpha_j=0\\)\nรูปด้านล่างแสดงโมเดลค่าสังเกตแบบ effect model\n\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": "posts/2022-02-19-glm1/glm1_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-02-19T12:21:53+07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-08-priors/",
    "title": "Prior Distributions",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Siwachoat Srisuttiyakorn",
        "url": {}
      }
    ],
    "date": "2022-02-07",
    "categories": [],
    "contents": "\n\nContents\nประเภทของ priors\nNoninformative priors\nUniform Distribution\nJeffrey’s prior\nการกำหนด priors ให้พารามิเตอร์ประเภทต่าง ๆ\nConjugacy priors\nInformative priors\n\n\nการแจกแจงความน่าจะเป็นก่อนหน้า (prior distribution) เป็นส่วนประกอบสำตัญในการวิเคราะห์ข้อมูลด้วยสถิติแบบเบส์ ทั้งนี้เป็นเพราะการแจกแจงความน่าจะเป็นก่อนหน้าทำให้ผู้วิเคราะห์สามารถสร้าง statement ความน่าจะเป็นของพารามิเตอร์ภายในโมเดลสถิติที่ใช้ในการวิเคราะห์ข้อมูลได้ นอกจากนี้การแจกแจงความน่าจะเป็นก่อนหน้ายังมีส่วนช่วยเพิ่มเติมสารสนเทศจากแหล่งอื่น ๆ นอกเหนือจากข้อมูลเชิงประจักษ์ให้กับผลการวิเคราะห์ได้อีกด้วย บทเรียนนี้จะกล่าวถึงมโนทัศน์และการกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าในโมเดลการวิเคราะห์ รายละเอียดมีดังนี้\nประเภทของ priors\nโดยทั่วไปแล้วอาจจำแนกการแจกแจงความน่าจะเป็นก่อนหน้าออกได้เป็น 2 ประเภท ได้แก่ การแจกแจงความน่าจะเป็นก่อนหน้าแบบไม่ให้สารสนเทศ (noninformative priors) และการแจกแจงความน่าจะเป็นก่อนหน้าแบบให้สารสนเทศ (informative priors)\nในกรณีที่ผู้วิเคราะห์เลือกใช้การแจกแจงความน่าจะเป็นก่อนหน้าแบบไม่ให้สารสนเทศ ผลการวิเคราะห์ที่ได้ในสถานการณ์นี้จะมีความเป็นปรนัย (objective) ทั้งนี้เป็นเพราะ noninformative priors เป็นการแจกแจงที่ไม่ได้ให้สารสนเทศใด ๆ เกี่ยวกับพารามิเตอร์ในโมเดลเพิ่มเติม ทำให้ผลการวิเคราะห์ต่าง ๆ ทั้งการประมาณค่า การทำนาย การเปรียบเทียบโมเดล จะขึ้นกับสารสนเทศที่ได้จากข้อมูลตัวอย่างเท่านั้น การที่ผู้วิเคราะห์เลือกใช้การแจกแจงความน่าจะเป็นก่อนหน้าประเภทนี้ในการวิเคราะห์ แสดงว่าผู้วิเคราะห์ต้องการให้ผลการวิเคราะห์ที่ได้มีความเป็นปรนัยมากที่สุด\nหนังสือหลายเล่มใช้คำว่า vague หรือ diffuse priors แทนคำว่า noninformative priors เพราะต้องการหลีกเลี่ยงการเข้าใจผิดว่า noninformative priors ไม่มีสารสนเทศ แต่ในความเป็นจริงการแจกแจงทุกตัวนั้นมีสารสนเทศเสมอ เพียงแต่ว่าเป็นการแจกแจงที่มีการกระจายค่อนข้างมากจึงไม่ได้ช่วยให้การวิเคราะห์มีสารสนเทศเพิ่มเติมไปจากสารสนเทศในข้อมูลตัวอย่าง\nในทางกลับกันหากผู้วิเคราะห์เลือกใช้ informative priors ในการวิเคราะห์ นั่นหมายความว่าผู้วิเคราะห์ดำเนินการวิเคราะห์โดยไม่ได้ใช้แต่สารสนเทศที่อยู่ภายในข้อมูลตัวอย่างเท่านั้น แต่ยังใช้สารสนเทศที่อยู่ภายในการแจกแจงความน่าจะเป็นก่อนหน้ามาร่วมประมวลผลด้วย ผลการวิเคราะห์ที่ได้ในกรณีนี้จะมีความเป็นอัตวิสัยมากกว่า\nNoninformative priors\nการแจกแจงความน่าจะเป็นก่อนหน้าแบบไม่ให้สารสนเทศในโมเดลมักใช้ในกรณีที่ผู้วิเคราะห์ไม่ได้มีความรู้หรือสารสนเทศเพิ่มเติมเกี่ยวกับพารามิเตอร์ต่าง ๆ ภายในโมเดลการวิเคราะห์ หรืออีกกรณีคือใช้ผลการวิเคราะห์ดังกล่าวเป็นผลการวิเคราะห์อ้างอิง (reference output) สำหรับการวิเคราะห์ผลกระทบที่เกิดจากการกำหนด informative priors หัวข้อนี้จะกล่าวถึงการแจกแจงความน่าจะเป็นก่อนหน้าแบบไม่ให้สารสนเทศบางตัวที่มักใช้เป็นการแจกแจงมาตรฐานในโปรแกรม JAGs รายละเอียดมีดังนี้\nUniform Distribution\nการแจกแจงแบบสม่ำเสมอ (uniform) เป็นการแจกแจงหนึ่งที่นิยมใช้เป็นการแจกแจงความน่าจะเป็นก่อนหน้าแบบไม่ให้สารสนเทศการแจกแจงหนึ่ง ซึ่งมีลักษณะเด่นคือ เป็นการแจกแจงที่ให้น้ำหนักกับความเป็นไปได้ต่าง ๆ ของค่าพารามิเตอร์ที่เท่าเทียมกัน กล่าวคือเป็น prior ที่มีฟังก์ชันความน่าจะเป็นอยู่ในรูปแบบ\n\\(p(\\theta)=Const.\\) เมื่อ \\(\\theta \\in A\\) โดยที่ \\(A\\) คือช่วงที่เป็นไปได้ของพารามิเตอร์ \\(\\theta\\)\nจากตัวอย่างการวิเคราะห์ความเที่ยงตรงของเหรียญ หากกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าของพารามิเตอร์ความลำเอียงเป็น uniform(0,1) จะได้ \\(p(\\theta)=1\\) เมื่อ \\(\\theta \\in [0,1]\\) รูปต่อไปนี้แสดงฟังก์ชันความน่าจะเป็นแบบ uniform บนช่วง 0,1\n\n\n\nจากรูปการกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าในข้างต้นไม่ได้ให้น้ำหนักกับค่าหรือช่วงใดช่วงหนึ่งของพารามิเตอร์ความลำเอียงเป็นพิเศษ ซึ่งทำให้การแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ความลำเอียงถูกพัฒนาขึ้นโดยใช้สารสนเทศจากฟังก์ชันภาวะความควรจะเป็นเกือบทั้งหมด ดังจะเห็นจากสมการด้านล่าง\n\\(p(\\theta|D) = \\frac{p(D|\\theta)p(\\theta)}{p(D)} =\\frac{p(D|\\theta) \\times 1}{P(D)}\\varpropto p(D|\\theta)\\)\nข้อควรระวังในการใช้การแจกแจงแบบ uniform เป็นการแจกแจงความน่าจะเป็นก่อนหน้าคือ การแจกแจงแบบ uniform ไม่มีคุณสมบัติ invariant กล่าวคือ ถ้า \\(\\theta \\sim Uniform(a,b)\\) แต่ \\(\\theta^2\\) ไม่ได้มีการแจกแจงแบบ \\(Uniform(a,b)\\) ดังกล่าว\nJeffrey’s prior\nจากปัญหาข้างต้น Harold Jeffrey (1961) ได้เสนอการแจกแจงความน่าจะเป็นก่อนหน้าแบบไม่ให้สารสนเทศที่มีคุณสมบัติ invariant ชื่อว่า Jeffrey’s prior ฟังก์ชันความน่าจะเป็นของการแจกแจงนี้แปรผันตรงกับรากที่สองของ determinant ของเมทริกซ์สารสนเทศของ Fisher (Fisher information matrix) ดังนี้\n\\(p(\\theta) \\varpropto |J(\\theta)|^{1/2}\\)\nเมื่อ \\(J(\\theta)\\) คือ Fisher information matrix ที่คำนวณได้จาก\n\\(J(\\theta)=Var(\\frac{\\partial}{\\partial \\theta}ln \\ p(\\theta|y))\\)\n\\(=E[-\\frac{\\partial^2 ln p(y|\\theta)}{\\partial \\theta^2}|\\theta]\\)\nจะเห็นว่า Fisher information ในข้างต้นเป็นดัชนีที่ใช้วัดสารสนเทศที่ข้อมูลตัวอย่างมีเกี่ยวกับพารามิเตอร์ต่าง ๆ ภายในโมเดล จากสูตรจะเห็นว่าดัชนีดังกล่าวคำนวณค่าสารสนเทศดังกล่าวโดยอิงกับค่าความแปรปรวน เนื่องจากในกรณีทั่วไปโมเดลการวิเคราะห์สามารถมีพารามิเตอร์ได้มากกว่าหนึ่งตัว ทำให้ Fisher information ดังกล่าวมีลักษณะเป็นเมทริกซ์ความแปรปรวนร่วม (covariance matrix) การสรุปสารสนเทศจากเมทริกซ์ดังกล่าวในเชิงของความแปรปรวน วิธีการหนึ่งคือการหาค่าความแปรปรวนทั่วไป (generalized variance) ด้วยการหา determinant ของเมทริกซ์ความแปรปรวนร่วมดังกล่าว\nจากมโนทัศน์ดังกล่าวจะเห็นว่า Jeffrey’s prior เป็นการแจกแจงความน่าจะเป็นก่อนหน้าที่อิงกับการแจกแจงความน่าจะเป็นของตัวอย่างสุ่มเป็นหลัก จึงจัดเป็น noninformative prior ตัวหนึ่งสำหรับโมเดลการวิเคราะห์แบบพาราเมทริกซ์\nตัวอย่างต่อไปนี้แสดงการแจกแจงความน่าจะเป็นก่อนหน้าแบบ Jeffrey สำหรับปัญหาการวิเคราะห์ความเที่ยงของของเหรียญ\nจากตัวอย่างการวิเคราะห์ความเที่ยงตรงของเหรียญ เนื่องจากฟังก์ชันภาวะความควรจะเป็นของพารามิเตอร์ความลำเอียงเมื่อกำหนดข้อมูลตัวอย่างคือ \\(p(D|\\theta)=\\theta^{\\sum y_i}(1-\\theta)^{n-\\sum y_i}\\) ดังนั้น log ของฟังก์ชันภาวะความควรจะเป็นดังกล่าวคือ\n\\(ln \\ p(D|theta) = \\sum y_i ln\\theta+(n-\\sum y_i)ln(1-\\theta)\\)\nและอนุพันธ์อันดับที่ 2 ของ \\(ln \\ p(D|theta)\\) มีค่าเท่ากับ\n\\(\\frac{\\partial^2 ln\\ p(D|\\theta)}{\\partial\\theta^2}=-\\frac{\\sum y_i}{\\theta^2}-\\frac{n-\\sum y_i}{(1-\\theta)^2}\\)\nดังนั้น Fisher Information ของพารามิเตอร์ \\(\\theta\\) ในโมเดลข้างต้นจึงมีค่าเท่ากับ\n\\(J(\\theta)=E[-\\frac{\\partial^2 ln p(y|\\theta)}{\\partial \\theta^2}|\\theta]=E[-(-\\frac{\\sum y_i}{\\theta^2}-\\frac{n-\\sum y_i}{(1-\\theta)^2})]=\\frac{n}{\\theta}+\\frac{n(1-\\theta)}{(1-\\theta)^2}\\)\nสมมุติว่าจากการเก็บรวบรวมข้อมูลพบว่า โยนเหรียญ 20 ครั้ง มีหน้าหัวเกิดขึ้น 7 ครั้ง แล้ว Jeffrey’s prior ของพารามิเตอร์ความลำเอียงคือ\n\\(p(\\theta)=|J(\\theta)|^{1/2}=|\\frac{20}{\\theta}+\\frac{20(1-\\theta)}{(1-\\theta)^2}|^{-1/2}\\)\n\n\npar(mar=c(5,5,1,1))\ntheta<-seq(0.01,0.99,0.01)\np.theta<-abs((20/theta+(20*(1-theta))/(1-theta)^2))^{0.5}\nplot(theta, p.theta, type=\"l\", col=\"#004D80\",xlab=expression(theta), ylab=\"Density\")\n\n\n\n\nหมายเหตุ ในปัญหาที่ใช้ฟังก์ชันภาวะความควรจะเป็นแบบ binomial จะได้ว่า Jeffrey’s prior จะมีการแจกแจงเทียบเท่ากับการแจกแจง beta ที่มีพารามิเตอร์ a = 0.5 และ b = 0.5\nตัวอย่างต่อไปนี้แสดงการเปรียบเทียบการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ความลำเอียง เมื่อกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าเป็นแบบ uniform(0,1) และเป็นแบบ Jeffrey’s prior\n\nCompiling rjags model...\nCalling the simulation using the rjags method...\nNote: the model did not require adaptation\nBurning in the model for 4000 iterations...\nRunning the model for 5000 iterations...\nSimulation complete\nCalculating summary statistics...\nCalculating the Gelman-Rubin statistic for 2 variables....\nFinished running the simulation\n\n\nIterations = 5001:10000\nThinning interval = 1 \nNumber of chains = 3 \nSample size per chain = 5000 \n\n1. Empirical mean and standard deviation for each variable,\n   plus standard error of the mean:\n\n         Mean     SD  Naive SE Time-series SE\ntheta1 0.3645 0.1007 0.0008219      0.0008105\ntheta2 0.3576 0.1014 0.0008283      0.0008282\n\n2. Quantiles for each variable:\n\n         2.5%    25%    50%    75%  97.5%\ntheta1 0.1803 0.2935 0.3611 0.4317 0.5715\ntheta2 0.1750 0.2851 0.3527 0.4260 0.5684\n\nคุณสมบัติเด่นของ Jeffrey priors คือมีคุณสมบัติ invariant to transformation กล่าวคือ หาก \\(\\psi=f(\\theta)\\) จะได้ว่า \\(p(\\psi) \\varpropto |J(\\psi)|^{0.5}\\)\nการกำหนด priors ให้พารามิเตอร์ประเภทต่าง ๆ\nพารามิเตอร์ในโมเดลการวิเคราะห์อาจจำแนกได้หลากหลายประเภท ขึ้นอยู่กับโมเดลการวิเคราะห์และตัวแปรในการวิเคราะห์ ทั้งนี้ธรรมชาติของพารามิเตอร์ดังกล่าวก็มีความแตกต่างกัน การกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าของพารามิเตอร์แต่ละประเภทจึงมีความแตกต่างกันตามธรรมชาติดังกล่าว\nการกำหนด noninformative prior ให้กับ location parameters\nConjugacy priors\nการแจกแจงความน่าจะเป็นก่อนหน้าจะเป็นการแจกแจงแบบ conjugacy prior ถ้าการแจกแจงความน่าจะเป็นก่อนหน้าและภายหลังเป็นการแจกแจงภายใน family เดียวกัน ด้วยคุณสมบัติดังกล่าวจึงทำให้การพิสูจน์หาสูตรหรือรูปแบบปิดของการแจกแจงความน่าจะเป็นภายหลังสามารถทำได้โดยที่ไม่ต้องหาเทอม \\(p(D)\\) ที่เป็นตัวส่วนใน Bayes’s rule\nตัวอย่างการแจกแจงก่อนหน้าแบบ conjugacy prior เช่น\nการแจกแจง beta คู่กับ binomial likelihood จะได้ posterior แบบ beta\nการแจกแจง normal คู่กับ normal likelihood จะได้ posterior แบบ normal\n\n\nInformative priors\ninformative prior หรือการแจกแจงความน่าจะเป็นก่อนหน้าแบบมีสารสนเทศ เป็นการแจกแจงความน่าจะเป็นก่อนหน้าที่รูปแบบของการแจกแจงไม่จำเป็นต้องขึ้นกับหรือเกี่ยวข้องกับฟังก์ชันภาวะความควรจะเป็น แต่ขึ้นกับสารสนเทศจากแหล่งอื่น ๆ นอกเหนือจากข้อมูลจริงที่ผู้วิเคราะห์มีเกี่ยวกับพารามิเตอร์ต่าง ๆ ภายในโมเดล สารสนเทศภายในการแจกแจงความน่าจะเป็นก่อนหน้าประเภทนี้อาจเรียกว่า ความรู้ก่อนหน้า (prior knowledge)\nการกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าลักษณะนี้จึงมีผลโดยตรงต่อการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ ซึ่งอาจทำให้ผลการรวิเคราะห์ที่ได้มีความถูกต้องมากขึ้น หรืออาจทำให้ผลการวิเคราะห์ที่ได้มีความลำเอียงก็ได้ ขึ้นอยู่กับการออกแบบ informative prior ของผู้วิเคราะห์\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": "posts/2022-02-08-priors/priors_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-02-14T22:34:36+07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-05-jags/",
    "title": "Introduction to JAGS",
    "description": "การใช้งาน JAGS เบื้องต้น",
    "author": [
      {
        "name": "Siwachoat Srisuttiyakorn",
        "url": {}
      }
    ],
    "date": "2022-02-04",
    "categories": [],
    "contents": "\n\nContents\nติดต้ังโปรแกรม\nการเขียนคำสั่งใน JAGS\nการนำเข้าและจัดการข้อมูล\nการระบุโมเดล\nโมเดลของค่าสังเกต\nการแจกแจงความน่าจะเป็นก่อนหน้า\nสภาพแวดล้อมของ JAGs\n\nการประมวลผล\nระบุ JAGs โมเดล\n\nrunjags packages\nrjags packages\nการตรวจสอบคุณสมบัติของตัวอย่างจาก MCMC algorithm\nการอนุมานเชิงสถิติแบบเบส์โดยใช้ตัวอย่างจาก MCMC algorithm\n\n\nผู้อ่านได้ทำความเข้าใจมโนทัศน์เกี่ยวกับอัลกอริทึม MCMC แล้ว อย่างไรก็ตามจะเห็นว่าการเขียนอัลกอริทึมดังกล่าวค่อนข้างลำบาก และมีโอกาสสูงที่จะเกิดความผิดพลาด ปัจจุบันมีโปรแกรมสำเร็จรูปหลายตัวที่ช่วยให้ผู้วิเคราะห์สามารถประมาณการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ภายในโมเดลใด ๆ ได้อย่างสะดวกมากยิ่งขึ้น บทเรียนนี้จะกล่าวถึงโปรแกรม JAGS (Just Another Gibb Sampler) รายละเอียดมีดังนี้\nติดต้ังโปรแกรม\nนิสิตสามารถ เข้าไปดาวน์โหลดโปรแกรม JAGS (Just Another Gibb Sampler) ได้ที่\nhttps://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/\nการใช้งาน JAGS ในข้างต้นจะไม่ได้ใช้งานแบบ standard alone แต่จะใช้งานผ่านโปรแกรม R ทั้งนี้ปัจจุบันมี package หลายตัวที่ถูกพัฒนาขึ้นเพื่อทำงานบน R ร่วมกับโปรแกรม JAGs เช่น R2jags, rjags และ runjags ในบทเรียนนี้จะกล่าวถึงการใช้งาน package ทั้งสาม โดยก่อนการใช้งานผู้้วิเคราะห์จำเป็นต้องดาวน์โหลด package ดังกล่าวก่อน ด้วยคำสั่งดังนี้\n\n\ninstall.packages(\"R2jags\")\ninstall.packages(\"rjags\", dependencies = TRUE)\ninstall.packages(\"runjags\", dependencies = TRUE)\n\n\n\nก่อนใช้งาน package ทั้งสองผู้ใช้จำต้องเรียกใช้ package ดังกล่าวก่อนโดยพิมพ์คำสั่งดังนี้\n\n\nlibrary(R2jags)\nlibrary(rjags)\nlibrary(runjags)\n\n\n\nกระบวนการทำงานร่วมกันระหว่าง R กับ JAGSการเขียนคำสั่งใน JAGS\nการเขียนคำสั่งต่าง ๆ จะทำบนโปรแกรม R ทั้งหมด โดยอาจแบ่งขั้นตอนการดำเนินงานออกเป็น 4 ขั้นตอนได้แก่ การนำเข้าและจัดการข้อมูล การระบุโมเดล การประมวลผล และการตรวจสอบและวิเคราะห์ผลลัพธ์ที่ได้ รายละเอียดมีดังนี้\nการนำเข้าและจัดการข้อมูล\nข้อมูลตัวอย่างผลสัมฤทธิ์ทางการเรียนวิชา calculas ของนิสิตจำนวน 100 คน บันทึกอยู่ในไฟล์ชื่อ bayes_exam1.csv ทั้งนี้เมื่อดาวน์โหลดข้อมูลมาแล้วสามารถนำเข้าสู่ R ได้โดยเขียนคำสั่งดังนี้\n\n\nlibrary(dplyr)\ndat<-read.csv(\"/Users/siwachoat/Documents/myblog/myblog/_posts/2022-02-05-jags/bayes_exam1.csv\")\nglimpse(dat)\n\n\nRows: 100\nColumns: 2\n$ id  <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…\n$ CAL <dbl> 68.8, 89.8, 40.0, 61.2, 8.8, 59.0, 57.5, 65.8, 50.9, 79.…\n\nการระบุโมเดล\nวัตถุประสงค์ของการวิเคราะห์มี 2 ข้อ ได้แก่\nเพื่อวิเคราะห์ระดับผลสัมฤทธิ์ทางการเรียนวิชา calculas ของนิสิต\nเพื่อวิเคราะห์ว่าค่าเฉลี่ยผลสัมฤทธิ์วิชา calculas ของนิสิตมีค่าสูงกว่า 50 คะแนนหรือไม่\nจากวัตถุประสงค์การวิเคราะห์และข้อมูลค่าสังเกตที่มี สามารถระบุโมเดลการวิเคราะห์ได้ดังนี้\nโมเดลของค่าสังเกต\nกำหนดให้โมเดลของคะแนนผลสัมฤทธิ์ (\\(y_i\\)) มีการแจกแจงแบบปกติที่มีค่าเฉลี่ยและความแปรปรวนเท่ากับ \\(\\mu\\) และ \\(\\sigma^2\\) ตามลำดับ เขียนแทนด้วย \\(y_i \\sim N(\\mu,\\sigma^2)\\) อย่างไรก็ตามในโปรแกรม JAGS จะไม่ได้ใช้พารามิเตอร์ความแปรปรวนเป็นพารามิเตอร์ของการแจกแจงแบบปกติ แต่ละใช้พารามิเตอร์ความเที่ยงตรง (precision parameter) ซึ่งเป็นส่วนกลับของพารามิเตอร์ความแปรปรวนแทน ดังนั้นโมเดลค่าสังเกตในกรณีนี้สามารถเขียนได้ดังนี้\n\\(y_i \\sim N(\\mu, \\tau=1/\\sigma^2)\\)\nจากโมเดลค่าสังเกตข้างต้นจะได้ ฟังก์ชันภาวะความควรจะเป็น (likelihood function) เป็น\n\\(p(D|y)=\\Pi_{i=1}^nN(y_i|\\mu, \\tau=1/\\sigma^2)\\)\nการแจกแจงความน่าจะเป็นก่อนหน้า\nจากการระบุโมเดลค่าสังเกตข้างต้น พบว่ามีพารามิเตอร์ 2 ตัวได้แก่ พารามิเตอร์ค่าเฉลี่ย และความเที่ยงตรง จึงระบุการแจกแจงความน่าจะเป็นก่อนหน้าให้กับพารามิเตอร์ทั้งสองเป็นดังนี้\n\\(\\mu \\sim N(m, t=1/S^2)\\) และ \\(\\tau \\sim Uniform(a,b)\\)\nความสัมพันธ์ระหว่างค่าสังเกต โมเดลความน่าจะเป็น และการแจกแจงความน่าจะเป็นก่อนหน้าสภาพแวดล้อมของ JAGs\nเมื่อผู้วิเคราะห์ระบุโมเดลเชิงทฤษฎีในข้างต้นแล้ว ขั้นตอนถัดมาคือการระบุโมเดลสำหรับโปรแกรม JAGS การระบุโมเดลใน JAGs จำเป็นต้องมีความรู้เบื้องต้นเกี่ยวกับสภาพแวดล้อมของโปรแกรม JAGs ก่อน ประเด็นแรกคือเรื่องวัตถุหรือตัวแปรภายต่าง ๆ ภายในโปรแกรม JAGs จะเรียกว่า node จำแนกออกเป็น 3 ประเภทได้แก่\nค่าคงที่ (constant nodes)\nค่าตัวแปรสุ่ม (Stochastic nodes) เป็นตัวแปรที่มีการแจกแจงความน่าจะเป็นกำกับโดเมนหรือค่าของตัวแปรไว้ การนิยามตัวแปรประเภทนี้จะเขียนอยู่ในรูปแบบ variable ~ distribution_name(par1, par2, ...) ยกตัวอย่างเช่น ตัวอย่างข้างต้นกำหนดให้โมเดลของค่าสังเกต \\(y_i\\) มีการแจกแจงแบบปกติ สามารถนิยามตัวแปรนี้บน JAGs ได้เป็น y[i] ~ dnorm(mu, tau) ส่วนการแจกแจงความน่าจะเป็นก่อนหน้าของพารามิเตอร์ \\(\\mu\\) และ \\(\\tau\\) สามารถระบุได้เป็น mu ~ dnorm(m,t) และ tau ~ dunif(a,b)\n\nฟังก์ชันเชิงคณิตศาสตร์ (Deterministic nodes) เป็นตัวแปรที่สร้างขึ้นจากฟังก์ชันหรือความสัมพันธ์เชิงคณิตศาสตร์กับ node อื่น ๆ เช่น mu[i] <- b0+b1*x[i]\nประเด็นที่สองเป็นเรื่องเกี่ยวกับโครงสร้างของตัวแปร และการระบุตำแหน่งของสมาชิกภายในโครงการของตัวแปร ตัวแปรอาจจำแนกโดยใช้โครงสร้างของตัวแปรออกได้เป็น 4 ประเภทหลัก ๆ ได้แก่ ค่าคงที่หรือสเกลาร์ เวกเตอร์ เมทริกซ์ และอาร์เรย์ที่มีมิติตั้งแต่ 3 มิติขึ้นไป การระบุตำแหน่งของสมาชิกภายในตัวแปรดังกล่าวทำได้ในวิธีเดียวกับในโปรแกรม R เช่น\ny[i] หมายถึงสมาชิกตัวที่ i ในเวกเตอร์ y\nmu.p[i,j] หมายถึงสมาชิกในแถวที่ i และคอลัมนท์ที่ j\nประเด็นที่สามเป็นเรื่องการดำเนินการทวนซ้ำ (repeated structures) ในโปรแกรม JAGs ผู้วิเคราะห์ไม่จำเป็นต้องพิสูจน์เพื่อหารูปแบบของฟังก์ชันภาวะความควรจะเป็นด้วยตัวเอง แต่สามารถสั่งให้โปรแกรมประมวลผลได้โดยกำหนดโมเดลของค่าสังเกตเอาไว้ภายใต้ loop เช่น ฟังก์ชันภาวะความควรจะเป็นในตัวอย่างข้างต้นสามารถระบุได้ดังนี้\n\n\nfor (i in 1:n)\n{\n  y[i]~dnorm(mu, tau)\n}\n\n\n\nประเด็นสุดท้ายเป็นโครงสร้างของชุดคำสั่งสำหรับระบุโมเดลทั้งหมด แต่ละโมเดลจะมีส่วนประกอบ 3 ส่วนได้แก่\nฟังก์ชันภาวะความควรจะเป็น (likelihood function) ระบุภายใต้ for loop ดังตัวอย่างด้านบน\nการแจกแจงความน่าจะเป็นก่อนหน้า (prior distributions) ของพารามิเตอร์ภายใต้โมเดลการวิเคราะห์\nส่วน deterministic function ที่ใช้สำหรับสร้างสารสนเทศที่ต้องการจากพารามิเตอร์ของโมเดล\nตัวอย่างด้านล่างแสดงโครงสร้างของชุดข้อมูลที่ใช้ระบุโมเดลในโปรแกรม JAGs\n\nmodel{\n  \n  # Likelihood\n  for (i in 1:n)\n  {\n    \n  }\n  \n  # Prior Distributions\n  \n  \n  \n  # Derived quantities \n  \n  \n\n  } #end of model\n\nการประมวลผล\nตัวอย่างต่อไปนี้แสดงขั้นตอนการสั่งให้ JAGs ประมวลผลเพื่อสร้างตัวอย่างสุ่มของลูกโซ่มาร์คอฟ\nระบุ JAGs โมเดล\n\n\nmean.model<-\"\nmodel{\n  \n  # Likelihood\n  for (i in 1:n)\n  {\n    y[i]~dnorm(mu, tau)\n  }\n  \n  # Prior Distributions\n  mu~dnorm(0,0.01)\n  tau~dunif(0,5)\n  \n  # Derived quantities \n  sigma2<-1/tau\n  \n  }\"\n# write mean.model to model1.txt\nwriteLines(mean.model, con=\"/Users/siwachoat/Documents/myblog/myblog/_posts/2022-02-05-jags/model1.txt\") \n\n\n\nในบางกรณี ผู้วิเคราะห์อาจไม่ต้องการสร้างไฟล์โมเดลเพิ่ม ก็สามารถเขียนโมเดลให้เก็บอยู่ใน R Console แล้วนำไปใช้ได้เลย โดยเขียนโมเดลเหมือนปกติ และบันทึกไว้ในลักษณะของ character variable ดังนี้\n\n\nmean.model<- \"model{\n  \n  # Likelihood\n  for (i in 1:n)\n  {\n    y[i]~dnorm(mu, tau)\n  }\n  \n  # Prior Distributions\n  mu~dnorm(0,0.01)\n  tau~dunif(0,5)\n  \n  # Derived quantities \n  sigma2<-1/tau\n\n}\"\n\n\n\nrunjags packages\nเป็น package หนึ่งที่สามารถเรียก JAGS จาก R ได้ ซึ่งมีจุดเด่นคือสามารถสั่งประมวลแบบคู่ขนาน (parallel) แยกตาม core ของ CPU ได้ในกรณีที่ผู้วิเคราะห์กำหนดให้สุ่มตัวอย่างจากลูกโซ่มาร์คอฟที่มีจำนวนมากกว่า 1 ลูกโซ่ ตัวอย่างคำสั่งเป็นดังนี้\n\n\n\n\n\nlibrary(runjags)\ndataList<-list(y=dat[,2], n=dim(dat)[1])\ninit1<-list(mu=50, tau=0.1)\ninit2<-list(mu=30, tau=0.01)\ninit3<-list(mu=90, tau=0.05)\ninitsList<-list(init1, init2, init3)\n\nmodel.runjags<-run.jags(method=\"parallel\",\n                        model=mean.model,\n                        monitor=c(\"mu\",\"sigma2\"),\n                        data=dataList,\n                        inits=initsList,\n                        n.chains=3,\n                        adapt = 1000,\n                        burnin=1000,\n                        sample = 10000,\n                        thin=1,\n                        summarise=TRUE,\n                        plots=FALSE,\n                        keep.jags.files = FALSE)\n\n\nCalling 3 simulations using the parallel method...\nFollowing the progress of chain 1 (the program will wait for\nall chains to finish before continuing):\nWelcome to JAGS 4.3.0 on Sat Feb 12 11:44:12 2022\nJAGS is free software and comes with ABSOLUTELY NO WARRANTY\nLoading module: basemod: ok\nLoading module: bugs: ok\n. . Reading data file data.txt\n. Compiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 100\n   Unobserved stochastic nodes: 2\n   Total graph size: 108\n. Reading parameter file inits1.txt\n. Initializing model\n. Adapting 1000\n-------------------------------------------------| 1000\n++++++++++++++++++++++++++++++++++++++++++++++++++ 100%\nAdaptation successful\n. Updating 1000\n-------------------------------------------------| 1000\n************************************************** 100%\n. . . Updating 10000\n-------------------------------------------------| 10000\n************************************************** 100%\n. . . . Updating 0\n. Deleting model\n. \nAll chains have finished\nSimulation complete.  Reading coda files...\nCoda files loaded successfully\nCalculating summary statistics...\nCalculating the Gelman-Rubin statistic for 2 variables....\nFinished running the simulation\n\nเมื่อประมวลผลเสร็จผู้วิเคราะห์สามารถเรียกดูข้อสรุปเบื้องต้นเกี่ยวกับตัวอย่างที่จำลองจากกระบวนการสุ่มข้างต้นได้ โดยพิมพ์ชื่อของตัวแปรที่เก็บผลลัพธ์จาก run.jags() ดังนี้\n\n\nJAGS model summary statistics from 30000 samples (chains = 3; adapt+burnin = 2000):\n                                                                 \n       Lower95 Median Upper95   Mean     SD Mode    MCerr MC%ofSD\nmu      53.772 57.168  60.512 57.152 1.7191   -- 0.010201     0.6\nsigma2   218.2 294.86  383.64 299.03 43.271   --  0.32807     0.8\n                               \n       SSeff      AC.10    psrf\nmu     28403   0.008448 0.99998\nsigma2 17397 -0.0020839  1.0004\n\nTotal time taken: 1.1 seconds\n\nสำหรับการตรวจสอบและวิเคราะห์ในเชิงลึกอื่น ๆ ผู้วิเคราะห์สามารถดึงกระบวนการสุ่มหรือลูกโซ่ของพารามิเตอร์ \\(\\mu\\) และ \\(\\sigma^2\\) ที่จำลองขึ้นมาอยู่ในโปรแกรม R เพื่อดำเนินการวิเคราะห์ในขั้นตอนต่อไปได้โดยใช้คำสั่ง as.mcmc.list() ดังนี้\n\n\n# sampling posterior samples\nsamples2<-as.mcmc.list(model.runjags)\nhead(samples2)\n\n\n[[1]]\nMarkov Chain Monte Carlo (MCMC) output:\nStart = 2001 \nEnd = 2007 \nThinning interval = 1 \n          mu  sigma2\n2001 57.5487 275.404\n2002 56.1627 276.307\n2003 56.1302 260.428\n2004 56.6929 313.530\n2005 57.0918 278.690\n2006 59.3460 297.571\n2007 55.3065 345.699\n\n[[2]]\nMarkov Chain Monte Carlo (MCMC) output:\nStart = 2001 \nEnd = 2007 \nThinning interval = 1 \n          mu  sigma2\n2001 56.1130 303.682\n2002 58.3842 270.347\n2003 56.8063 300.842\n2004 56.4171 308.145\n2005 59.4194 271.694\n2006 55.9829 332.392\n2007 55.1499 351.244\n\n[[3]]\nMarkov Chain Monte Carlo (MCMC) output:\nStart = 2001 \nEnd = 2007 \nThinning interval = 1 \n          mu  sigma2\n2001 57.8272 286.992\n2002 61.0377 274.274\n2003 57.6024 273.526\n2004 57.8438 235.769\n2005 54.4078 248.104\n2006 60.0294 337.741\n2007 57.9692 332.634\n\nattr(,\"class\")\n[1] \"mcmc.list\"\n\nrjags packages\n\n\nlibrary(rjags)\ndataList<-list(y=dat[,2], n=dim(dat)[1])\ninit1<-list(mu=50, tau=0.1)\ninit2<-list(mu=30, tau=0.01)\ninit3<-list(mu=90, tau=0.05)\ninitsList<-list(init1, init2, init3)\n\nmodel<-jags.model(file=\"/Users/siwachoat/Documents/myblog/myblog/_site/posts/2022-02-05-jags/model1.txt\",\n                  data = dataList,\n                  inits = initsList,\n                  n.chains = 3)\n\n\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 100\n   Unobserved stochastic nodes: 2\n   Total graph size: 108\n\nInitializing model\n\n\n\n# sampling posterior samples\nsamples<-coda.samples(model,\n                      variable.names = c(\"mu\",\"sigma2\"),\n                      n.iter = 10000,\n                      thin = 3)\n\n\n\n\n\nhead(samples)\n\n\n[[1]]\nMarkov Chain Monte Carlo (MCMC) output:\nStart = 1003 \nEnd = 1021 \nThinning interval = 3 \n           mu   sigma2\n[1,] 57.34737 240.9543\n[2,] 57.76166 350.2274\n[3,] 57.51731 376.2769\n[4,] 57.13501 299.5402\n[5,] 56.61046 285.8832\n[6,] 57.71678 283.4233\n[7,] 59.15487 256.3204\n\n[[2]]\nMarkov Chain Monte Carlo (MCMC) output:\nStart = 1003 \nEnd = 1021 \nThinning interval = 3 \n           mu   sigma2\n[1,] 59.68764 226.6262\n[2,] 58.26544 236.8657\n[3,] 55.85105 222.6479\n[4,] 60.14749 209.6911\n[5,] 55.52599 312.2547\n[6,] 58.86395 264.9162\n[7,] 58.24241 292.8658\n\n[[3]]\nMarkov Chain Monte Carlo (MCMC) output:\nStart = 1003 \nEnd = 1021 \nThinning interval = 3 \n           mu   sigma2\n[1,] 54.44243 366.7963\n[2,] 56.46555 285.7804\n[3,] 58.53672 230.0021\n[4,] 55.68155 277.9133\n[5,] 57.73368 303.1974\n[6,] 57.99630 276.1643\n[7,] 59.01244 294.8693\n\nattr(,\"class\")\n[1] \"mcmc.list\"\n\nการตรวจสอบคุณสมบัติของตัวอย่างจาก MCMC algorithm\n\n\nsummary(samples)\n\n\n\nIterations = 1003:10999\nThinning interval = 3 \nNumber of chains = 3 \nSample size per chain = 3333 \n\n1. Empirical mean and standard deviation for each variable,\n   plus standard error of the mean:\n\n         Mean     SD Naive SE Time-series SE\nmu      57.14  1.705  0.01705        0.01729\nsigma2 298.14 43.044  0.43047        0.45148\n\n2. Quantiles for each variable:\n\n         2.5%    25%    50%   75%  97.5%\nmu      53.74  55.97  57.13  58.3  60.43\nsigma2 225.15 267.50 293.62 324.6 392.77\n\n\n\nplot(samples)\n\n\n\nlibrary(MCMCvis)\nMCMCtrace(samples,  pdf = FALSE)\n\n\n\nMCMCtrace(samples,  pdf = FALSE, iter=100) #plot last 100 iterations\n\n\n\nprior<-rnorm(10000,0,100)\nMCMCtrace(samples,  pdf = FALSE, \n          param=\"mu\",\n          priors=prior, \n          n.eff=TRUE, \n          Rhat=TRUE,\n          post_zm = TRUE)\n\n\n\n\n\n\nautocorr.diag(samples)\n\n\n                  mu       sigma2\nLag 0    1.000000000  1.000000000\nLag 3    0.011004135  0.015620913\nLag 15   0.002266789  0.001606799\nLag 30  -0.003010521  0.001017228\nLag 150 -0.006209084 -0.004619363\n\nautocorr.plot(samples)\n\n\n\n\n\n\ngelman.diag(samples)\n\n\nPotential scale reduction factors:\n\n       Point est. Upper C.I.\nmu              1          1\nsigma2          1          1\n\nMultivariate psrf\n\n1\n\ngelman.plot(samples)\n\n\n\n\n\n[[1]]\n\nFraction in 1st window = 0.1\nFraction in 2nd window = 0.5 \n\n     mu  sigma2 \n-0.4773 -0.6180 \n\n\n[[2]]\n\nFraction in 1st window = 0.1\nFraction in 2nd window = 0.5 \n\n     mu  sigma2 \n 1.1457 -0.7003 \n\n\n[[3]]\n\nFraction in 1st window = 0.1\nFraction in 2nd window = 0.5 \n\n     mu  sigma2 \n-1.6166 -0.1384 \n\n\n\nlibrary(ggplot2)\ntheta_sim_posterior <- data.frame(as.matrix(samples))\nnames(theta_sim_posterior) = c(\"mu\",  \"sigma2\")\n\nggplot(theta_sim_posterior, aes(mu, sigma2)) +\n  geom_point(color = \"skyblue\", alpha = 0.4) +\n  geom_density_2d(color = \"orange\", size = 1)+\n  theme_minimal()\n\n\n\n\nการอนุมานเชิงสถิติแบบเบส์โดยใช้ตัวอย่างจาก MCMC algorithm\nsummary\n\n\nsummary(samples)\n\n\n\nIterations = 1003:10999\nThinning interval = 3 \nNumber of chains = 3 \nSample size per chain = 3333 \n\n1. Empirical mean and standard deviation for each variable,\n   plus standard error of the mean:\n\n         Mean     SD Naive SE Time-series SE\nmu      57.14  1.705  0.01705        0.01729\nsigma2 298.14 43.044  0.43047        0.45148\n\n2. Quantiles for each variable:\n\n         2.5%    25%    50%   75%  97.5%\nmu      53.74  55.97  57.13  58.3  60.43\nsigma2 225.15 267.50 293.62 324.6 392.77\n\nhist(theta_sim_posterior$mu, xlim=c(49,65))\nabline(v=quantile(theta_sim_posterior$mu, c(0.025, 0.975)), lty=2)\n\n\n\n\nMCMCsummary\n\n\nlibrary(MCMCvis)\nMCMCsummary(samples)\n\n\n            mean       sd      2.5%       50%     97.5% Rhat n.eff\nmu      57.13683  1.70463  53.73839  57.13484  60.42744    1  9735\nsigma2 298.14196 43.04437 225.14609 293.62443 392.76572    1  9247\n\nMCMCsummary(samples, params=\"mu\", round=2)\n\n\n    mean  sd  2.5%   50% 97.5% Rhat n.eff\nmu 57.14 1.7 53.74 57.13 60.43    1  9735\n\nMCMCplot\nMCMCplot is used to create caterpillar plots from MCMC output. Points represent posterior medians. Thick and thin lines represent credible intervals specified by the user using the ci argument, where the default is 50% and 95% credible intervals, respectively. Note, that the first element in ci should be less than or equal to the second element. By default, MCMCplot plots equal-tailed credible intervals (HPD = FALSE). However, highest posterior density intervals can be visualized using HPD = TRUE. As with the other functions in the package, particular parameters of interest can be specified.\n\n\n\n\n\n## HPD interval\nHPDinterval(samples)\n\n\n[[1]]\n           lower     upper\nmu      53.57906  60.24913\nsigma2 219.32954 386.88690\nattr(,\"Probability\")\n[1] 0.949895\n\n[[2]]\n           lower     upper\nmu      53.84288  60.49948\nsigma2 223.98087 390.10538\nattr(,\"Probability\")\n[1] 0.949895\n\n[[3]]\n           lower     upper\nmu      53.86939  60.42728\nsigma2 224.17333 389.09147\nattr(,\"Probability\")\n[1] 0.949895\n\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": "posts/2022-02-05-jags/jags_files/figure-html5/unnamed-chunk-16-1.png",
    "last_modified": "2022-02-12T11:44:20+07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-02-03-mcmc-via-jags/",
    "title": "Markov Chain Monte Carlo (MCMC)",
    "description": "มโนทัศน์ของลูกโซ่มาร์คอฟมอนติคาร์โล",
    "author": [
      {
        "name": "Siwachoat Srisuttiyakorn",
        "url": {}
      }
    ],
    "date": "2022-02-03",
    "categories": [],
    "contents": "\n\nContents\nMCMC algorithm\nMetropolis algorithm\nExample 1: Tossing coin\nExample 2: One-sample Mean and SD\n\nGibbs Sampling algorithm\nAssessing MCMC samples\nConvergence\nการตรวจสอบแนวโน้มการลู่เข้าด้วย Trace plot และ Density plot\nAutocorrelation\nThining\nEffective Sample Size (ESS)\n\nMonte Carlo Standard Error\nPotential Scale Reduction (\\(\\hat{R}\\) หรือ RSRF)\n\n\nMCMC algorithm\nหัวข้อนี้จะกล่าวถึงมโนทัศน์ของลูกโซ่มาร์คอฟมอนติคาร์โล (Monte Carlo Markov Chain: MCMC) ที่เป็นเครื่องมือสำคัญสำหรับประมาณการแจกแจงความน่าจะเป็นภายหลัง (posterior distribution) สำหรับการวิเคราะห์ข้อมูลที่อาศัยแนวคิดแบบเบส์\nแนวคิดเกี่ยวกับ MCMC มีมาค่อนข้างยาวนานประมาณ 40 ปีแล้ว แต่ด้วยข้อจำกัดทั้งด้านโปรแกรมและประสิทธิภาพของคอมพิวเตอร์ทำให้การใช้งานอัลกอริทึม ในสมัยก่อนทำได้ยาก และเกือบจะเป็นไปไม่ได้ที่จะใช้งานอัลกอริทึม MCMC กับปัญหาทางสถิติที่มีความซับซ้อน แต่ด้วยความก้าวหน้าทางเทคโนโลยีในยุคปัจจุบันทำให้ข้อจำกัดดังกล่าวลดลงจนแทบไม่มีอีกต่อไป\nอัลกอริทึม MCMC เป็นอัลกอริทึมที่ใช้สำหรับประมาณการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ โดยใช้ตัวอย่างสุ่มที่สร้างจากเทคนิคการจำลองแบบมอนติคาร์โล แทนการพิสูจน์หรือการทดลองแทนค่าเพื่อหาค่าที่ดีที่สุดทางคณิตศาสตร์ คำตอบที่ได้จากอัลกอริทึม MCMC นี้จึงไม่ใช่สูตรหรือฟังก์ชันทางคณิตศาสตร์ แต่จะเป็นตัวอย่างสุ่มของพารามิเตอร์ที่สร้างขึ้น ตัวอย่างดังกล่าวหากมีจำนวนที่มากเพียงพอ จะสามารถใช้เป็นตัวแทนของการแจกแจงความน่าจะเป็นภายหลังที่ต้องการ และสามารถนำตัวอย่างดังกล่าวมาผ่านกระบวนการทางสถิติเพื่อสร้างข้อสรุปเกี่ยวกับพารามิเตอร์ในโมเดลได้โดยตรง กล่าวโดยสรุปได้ว่าอัลกอริทึม MCMC เป็นเทคนิคที่นำมาประยุกต์ใช้ในการวิเคราะห์ข้อมูลแบบเบส์ เพื่อประมาณการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ต่าง ๆ ภายในโมเดล ด้วยตัวอย่างสุ่มของพารามิเตอร์\nรูปต่อไปนี้แสดงการเปรียบเทียบระหว่างการแจกแจงความน่าจะเป็นเชิงทฤษฎี (theoretical/exact distribution) กับการแจกแจงความน่าจะเป็นที่ประมาณด้วยตัวอย่างสุ่มที่สร้างจากเทคนิคการจำลองแบบมอนติคาร์โล\nด้วยเทคนิคการจำลองแบบมอนติคาร์โล ผู้วิเคราะห์สามารถจำลองตัวอย่างสุ่มจากการแจกแจงความน่าจะเป็นใดก็ได้ แต่มีเงื่อนไขว่าต้องทราบฟังก์ชันความน่าจะเป็นของการแจกแจงดังกล่าวก่อน เงื่อนไขนี้เป็นข้อจำกัดที่ทำให้ไม่สามารถใช้เทคนิคการจำลองแบบมอนติคาร์โลแบบปกติได้โดยตรง ทั้งนี้เป็นเพราะในโมเดลที่มีความซับซ้อนระดับหนึ่ง เป็นการยากมากที่ผู้วิเคราะห์จะทราบรูปแบบหรือฟังก์ชันของการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ในโมเดลที่ต้องการใช้งาน\n\n\nlibrary(scales)\nx<-seq(-3,3,0.01)\npar(mfrow=c(2,3), mar=c(1,5,6,5))\nplot(x, dnorm(x,0,1),type=\"l\", main=\"exact distribution N(0,1)\", xlab=\"X\")\nhist(rnorm(500,0,1), freq=F, nclass=30, col=alpha(\"#004D80\",0.7),\n     main=\"sample distribution n=500\", xlab=\"X\")\nhist(rnorm(1000,0,1), freq=F, nclass=30, col=alpha(\"#004D80\",0.7),\n     main=\"sample distribution n=1000\", xlab=\"X\")\nhist(rnorm(5000,0,1), freq=F, nclass=30, col=alpha(\"#004D80\",0.7),\n     main=\"sample distribution n=5000\", xlab=\"X\")\nhist(rnorm(10000,0,1), freq=F, nclass=30, col=alpha(\"#004D80\",0.7),\n     main=\"sample distribution n=10000\", xlab=\"X\")\nhist(rnorm(50000,0,1), freq=F, nclass=30, col=alpha(\"#004D80\",0.7),\n     main=\"sample distribution n=50000\", xlab=\"X\")\n\n\n\n\nMetropolis algorithm\nMetropolis algorithm เป็นกระบวนการสุ่ม (random process/stochastic process) ประเภทหนึ่ง ตั้งชื่ออัลกอริทึมตามคณะผู้พัฒนาได้แก่ Metropolis, Rosenbluth, Rosenbluth, Teller & Teller (1953)\nอัลกอริทึมนี้สามารถนำมาประยุกต์ใช้เพื่อหาการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ โดยปริภูมิของพารามิเตอร์ (parameters space) ดังกล่าวนั้นเป็นไปได้ทั้งแบบไม่ต่อเนื่อง (discrete) และแบบต่อเนื่อง (continuous) และสามารถใช้ได้กับปริภูมิพารามิเตอร์ที่มีมิติตั้งแต่หนึ่งมิติ (unidimensional) ไปจนถึงหลายมิติ (multidimensional) อัลกอริทึม Metropolis มีลักษณะการทำงานแบบทวนซ้ำ (interative) มีรายละเอียดของขั้นตอนวิธีดังนี้\nกำหนดให้ \\(p(\\theta)\\) เป็นการแจกแจงความน่าจะเป็นภายหลังที่ต้องการประมาณ\nสุ่ม/เลือกค่าตั้งต้น (initial values) ของพารามิเตอร์ในการแจกแจงความน่าจะเป็นภายหลัง เขียนแทนด้วย \\(\\theta_0\\) ทั้งนี้ค่าพารามิเตอร์ที่สุ่มมามีเงื่อนไขคือต้องอยู่ภายใต้ปริภูมิของพารามิเตอร์ กล่าวคือ \\(p(\\theta_0)>0\\)\nสร้างค่า proposal jump เพื่อใช้เป็นตัวปรับค่าตั้งต้นของพารามิเตอร์ เขียนแทนด้วย \\(\\Delta\\theta\\) จากการแจกแจงความน่าจะเป็นโครงร่าง (proposal distribution) ที่กำหนดไว้ เช่นอาจกำหนดให้ \\(\\Delta\\theta \\sim N(0, \\sigma)\\) ซึ่งจะได้ proposed values ของพารามิเตอร์ค่าใหม่เขียนแทนด้วย \\(\\theta_{pro}\\) โดยที่ \\(\\theta_{pro}=\\theta_{i-1}+\\Delta\\theta\\) เมื่อ \\(i=1,2,3,...,m\\)\nคำนวณค่าความน่าจะเป็นในการเดิน/เปลี่ยนแปลงของ proposed values ดังนี้ \\(p_{move}=min(1,\\frac{p(\\theta_{pro})}{p(\\theta_{i-1})})\\) โดยที่ \\(p(\\theta_{pro})=p(D|\\theta_{pro}p(\\theta_{pro}))\\) และ \\(p(\\theta_{i-1})=p(D|\\theta_{i-1})p(\\theta_{i-1})\\) จากความน่าจะเป็นข้างต้น จะเห็นว่า ถ้า \\(\\theta_{pro}\\) มีค่าอยู่นอกเหนือค่าที่เป็นไปได้หรือค่าที่ควรจะเป็นของพารามิเตอร์ \\(\\theta\\) ในโมเดล ค่าความน่าจะเป็นก่อนหน้า \\(p(\\theta_{pro})\\) และ/หรือค่าของฟังก์ชันภาวะความควรจะเป็น \\(p(D|\\theta_{pro})\\) จะมีค่าเท่ากับ 0 ซึ่งทำให้ค่า \\(p_{move}=0\\)\nเกณฑ์การพิจารณายอมรับค่า proposed value \\(\\theta_{pro}\\) จะยอมรับด้วยความน่าจะเป็นเท่ากับ \\(p_{move}\\) ในทางปฏิบัติจะสุ่มเลขสุ่มจากการแจกแจงแบบ uniform [0,1] ขึ้นมา 1 ค่า เขียนแทนด้วย \\(u\\) หาก \\(u<p_{move}\\) จะยอมรับค่า \\(theta_{pro}\\) ดังกล่าว แต่ถ้าหาก \\(u > p_{move}\\) จะปฏิเสธค่า \\(\\theta_{pro}\\) ในกรณีนี้ค่าพารามิเตอร์ \\(\\theta_{i-1}\\) ก็จะไม่ได้มีการเปลี่ยนแปลงสถานะ\nอัลกอริทึมข้างต้นเป็นกระบวนการทวนซ้ำโดยจะดำเนินการทวนซ้ำในขั้นตอนที่ 2-4 จนกระทั่งตัวอย่างพารามิเตอร์ \\(\\theta\\) มีจำนวนเพียงพอ และมีคุณสมบัติที่เหมาะสม\nExample 1: Tossing coin\nจากตัวอย่างปัญหาการวิเคราะห์ความเที่ยงตรงของเหรียญ หากต้องการทำ MCMC เพื่อประมาณการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ความลำเอียง อาจดำเนินการดังนี้\nกำหนดให้ \\(y_i\\) คือค่าสังเกตของการโยนเหรียญ โดยที่ \\(i=1,2,3...,n\\) และโมเดลของค่าสังเกตดังกล่าวคือ \\(p(y_i|\\theta)=\\theta^y_i(1-\\theta)^{n-y_i}\\) จากการกำหนดนี้จะได้ฟังก์ชันภาวะความควรจะเป็นคือ\n\n\\(p(y|\\theta)=\\theta^{\\sum y_i}(1-\\theta)^{n-\\sum y_i}\\)\n\nและกำหนดให้พารามิเตอร์ \\(\\theta\\) มีการแจกแจงความน่าจะเป็นก่อนหน้าเป็น\n\n\\(p(\\theta)=Beta(\\theta|a,b)\\)\n\nการแจกแจงความน่าจะเป็นแบบ Beta มีธรรมชาติของการแจกแจงคือ ค่าที่เป็นไปได้ของโดเมนอยู่บนช่วง [0,1] ซึ่งสอดคล้องกับธรรมชาติของพารามิเตอร์ความลำเอียงในโมเดลค่าสังเกต\nKruschke, 2015ในกรณีนี้เลือกการแจกแจงความน่าจะเป็นก่อนหน้าเป็น \\(Beta(1,1)\\) ซึ่งจะเห็นว่าเทียบเท่ากับการแจกแจงแบบ uniform ที่หมายถึงผู้วิเคราะห์ไม่ได้มีสารสนเทศเบื้องต้นใด ๆ เกี่ยวกับความลำเอียงของเหรียญที่ทำการศึกษา นอกจากขอบเขตที่เป็นไปได้ของค่าพารามิเตอร์\nจากการกำหนดเงื่อนไขของการศึกษาในข้างต้น จะค่าความน่าจะเป็นในการเปลี่ยนแปลงสถานะหรือ \\(p_{move}\\) เป็น\n\\(p_{move}=min(1,\\frac{p(\\theta_{pro})}{p(\\theta{i-1})})\\)\n\\(=min(1, \\frac{[\\theta_{pro}^{\\sum y_i}(1-\\theta_{pro})^{n-\\sum y_i}] \\times Beta(\\theta_{pro}|1,1)}{[\\theta_{i-1}^{\\sum y_i}(1-\\theta_{i-1})^{n-\\sum y_i}] \\times Beta(\\theta_{i-1}|1,1)})\\)\nเนื่องจากการแจกแจงความน่าจะเป็นแบบ Beta มีฟังก์ชันความน่าจะเป็นคือ \\(p(\\theta|a,b)=\\frac{1}{B(a,b)} \\theta^{a-1}(1-\\theta)^{b-1}\\) โดยที่ \\(B(a,b)=\\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}\\) และ \\(\\Gamma(.)\\) คือฟังก์ชันแกมมา (Gamma function)\nดังนั้นความน่าจะเป็นในการเปลี่ยนสถานะของ proposed values จะมีค่าเท่ากับ\n\\(p_{move}=min(1,\\frac{\\theta_{pro}^{\\sum y_i+a-1}(1-\\theta_{pro})^{n-\\sum y_i+b-1}/B(a,b)}{\\theta_{i-1}^{\\sum y_i+a-1}(1-\\theta_{i-1})^{n-\\sum y_i+b-1}/B(a,b)})\\)\nสมมุติว่าผู้วิเคราะห์ทำการทดสอบโยนเหรียญ 20 ครั้ง และได้หน้าหัวเท่ากับ 7 ครั้ง\n\n\ntheta<-0.99 #initial value\nm<-5000 #iteration number\ntheta.dat<-matrix(nrow=m,ncol=3)\nsd.pro<-c(0.02,0.2,2) #learning rate\ncount<-matrix(nrow=m, ncol=3)\n\nfor(j in 1:length(sd.pro))\n  {\n  for(i in 1:m)\n    {\ndelta.theta<-rnorm(1,0,sd.pro[j]) #proposal jump (change)\ntheta.pro<-theta+delta.theta #proposed bias parameter\n\nnom<-theta.pro^(7+1-1)*(1-theta.pro)^(20-7+1-1)\ndenom<-theta^(7+1-1)*(1-theta)^(20-7+1-1)\n\np.move<-min(1,nom/denom)\n\nif(runif(1,0,1)<p.move)\n{theta<-theta.pro\ncount[i,j]<-1\n}else{\n\ntheta<-theta  \ncount[i,j]<-0\n}\ntheta.dat[i,j]<-theta\n  } # end of m iteration\n} # end of sd loop\n\n\n\nจากการดำเนินอัลกอริทึมในข้างต้น พบว่าได้ผลการวิเคราะห์ดังต่อไปนี้\n\n\n\nเราอาจพิจารณาประสิทธิภาพของอัลกอริทึมในข้างต้นจากสัดส่วนของจำนวนค่าพารามิเตอร์ผ่านการยอมรับต่อจำนวน proposed values ของพารามิเตอร์ ซึ่งจะพบว่ามีค่าเท่ากับ\n\n\ncolSums(count)/5000\n\n\n[1] 0.9392 0.5182 0.0626\n\nExample 2: One-sample Mean and SD\nสมมุตินักวิจัยต้องการประมาณค่าเฉลี่ย IQ ของนักเรียนในโรงเรียนสังกัด สพฐ. ว่ามีค่าสูงกว่าเกณฑ์มาตรฐานคือ 90 คะแนน หรือไม่ ในการวิจัยนักวิจัยได้สร้างแบบวัด IQ และนำไปเก็บรวบรวมข้อมูลจากนักเรียนดังกล่าวจำนวน 3000 คน พบว่ามีคะแนนดังนี้\n\n\nset.seed(123)\niq<-rnorm(3000,99,10) #IQ sample data\nhist(iq, nclass=30, xlab=\"IQ score\",col=alpha(\"#004D80\",0.7))\n\n\n\n\nจากปัญหาในข้างต้น นักวิจัยได้กำหนดโมเดลของค่าสังเกตด้วยการแจกแจงความน่าจะเป็นแบบปกติ ดังนี้ \\(y_i \\sim N(\\mu,\\ \\sigma)\\) ที่มีฟังก์ชันความน่าจะเป็นคือ\n\\(p(y_i|\\mu,\\ \\sigma)=\\frac{1}{\\sqrt{2\\pi\\sigma^2}}exp\\{-\\frac{1}{2\\sigma^2}(y_i-\\mu)^2\\}\\)\nซึ่งทำให้ได้ว่าฟังก์ชันภาวะความควรจะเป็นของข้อมูลค่าสังเกตเมื่อกำหนดพารามิเตอร์ \\(\\mu\\) และ \\(\\sigma\\) คือ\n\\(\\Pi_{i=1}^n p(y_i|\\mu,\\sigma)=(\\frac{1}{\\sqrt{2\\pi\\sigma^2}})^nexp\\{-\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\sum_{i=1}^n(y_i-\\mu)^2 \\}\\)\nเนื่องจากพารามิเตอร์ทั้งสองเป็นอิสระซึ่งกันและกัน การกำหนดการแจกแจงความน่าจะเป็นก่อนหน้าให้กับพารามิเตอร์ดังกล่าวจึงสามารถกำหนดแยกจากการได้อย่างอิสระ โดยในตัวอย่างนี้จะกำหนดให้การแจกแจงความน่าจะเป็นก่อนหน้าของพารามิเตอร์ค่าเฉลี่ยมีการแจกแจงแบบปกติ ที่มีค่าเฉลี่ยเท่ากับ 90 และส่วนเเบี่ยงเบนมาตรฐานเท่ากับ 30 ดังนี้\n\\(p(\\mu|\\mu_p=90, \\sigma_p=30)=\\frac{1}{\\sqrt{2\\pi\\times30^2}}exp\\{-\\frac{1}{2\\times30^2}(\\mu-90)^2 \\}\\)\nและกำหนดให้พารามิเตอร์ความแปรปรวน (\\(\\sigma^2\\) ) มีการแจกแจงความน่าจะเป็นก่อนหน้าเป็นแบบ uniform บนช่วง [0,10000] ซึ่งมีฟังก์ชันความน่าจะเป็นดังนี้\n\\(p(\\sigma^2)=\\frac{1}{10000}\\)\nรูปด้านล่างแสดงโค้งความหนาแน่นของการแจกแจงความน่าจะเป็นก่อนหน้าของ \\(\\mu \\sim N(90,30)\\) และ \\(\\sigma^2 \\sim U(0,10000)\\)\n\n\n\nจากการกำหนดในข้างต้นจะได้ว่าความน่าจะเป็นในการเปลี่ยนสถานะของพารามิเตอร์ทั้งสองมีค่าเท่ากับ\n\\(p.move=min(1,\\frac{p(y|\\mu_{pro},\\sigma_{pro})p(\\mu_{pro},\\sigma_{pro})}{p(y|mu_{i-1},\\sigma_{i-1})p(\\mu_{i-1},\\sigma_{i-1})})\\)\n\\(=min(1,\\frac{p(y|\\mu_{pro},\\sigma_{pro})\\times N(mu_{pro}|90,30) \\times (1/10000)}{p(y|\\mu_{i-1},\\sigma_{i-1})\\times N(mu_{i-1}|90,30) \\times (1/10000)})\\)\nอย่างไรก็ตามจะเห็นว่าความน่าจะเป็นข้างต้นมีสูตรค่อนข้างซับซ้อนและการคำนวณตรง ๆ อาจมีปัญหา ผู้วิเคราะห์จึง take log เข้าที่ความน่าจะเป็นดังกล่าวจึงทำให้เกณฑ์การพิจารณากลายเป็น\n\\(p.move = min(0, [lnp(y|\\mu_{pro},\\sigma_{pro})+lnN(mu_{pro}|90,30)+0]-[lnp(y|\\mu_{i-1},\\sigma_{i-1})+lnN(mu_{i-1}|90,30)+0]\\)\nจากเงื่อนไขข้างต้นสามารถเขียนอัลกอริทึม Metropolis เพื่อประมาณพารามิเตอร์ \\(\\mu\\) และ \\(\\sigma\\) ได้ดังนี้\n\n\n#initial value\nmu<-50\nsigma<-30\n\n#iteration number\nm<-5000 \ntheta.dat<-matrix(nrow=m,ncol=6)\nsd.pro<-c(0.05,0.2,2)\ncount<-matrix(nrow=m, ncol=3)\n\nfor(j in 1:length(sd.pro))\n  {\nfor(i in 1:m)\n{\n\ndelta.mu<-rnorm(1,0,sd.pro[j])\ndelta.sigma<-rnorm(1,0,sd.pro[j])\n\n#proposed values\nmu.pro<-mu+delta.mu \nsigma.pro<-sigma+delta.sigma\n\nnom<-sum(dnorm(iq,mean = mu.pro,sd = sigma.pro, log=TRUE))+dnorm(mu.pro,90,30, log=TRUE)\ndenom<-sum(dnorm(iq,mean = mu,sd = sigma, log=TRUE))+dnorm(mu,90,30, log=TRUE)\n\np.move<-min(1,exp(nom-denom))\n\nif(p.move==\"NaN\")\n{\nmu<-mu\nsigma<-sigma\ncount[i,j]<-0\n} else if (runif(1,0,1)<p.move)\n{\nmu<-mu.pro\nsigma<-sigma.pro\ncount[i,j]<-1\n}\nelse\n{\nmu<-mu\nsigma<-sigma\ncount[i,j]<-0\n}\n\ntheta.dat[i,2*j-1]<-mu\ntheta.dat[i,2*j]<-sigma\n  } # end of m iteration\n}#end of sd loop\n\ncolnames(theta.dat)<-c(\"mu_sdpro1\",\"sigma_sdpro1\",\"mu_sdpro2\",\"sigma_sdpro2\",\"mu_sdpro3\",\"sigma_sdpro3\")\n\n\n\nประสิทธิภาพในด้านการยอมรับ proposed value ในแต่ละเงื่อนไขเป็นดังนี้\n\n\ncolSums(count)\n\n\n[1] 3355 2245   52\n\nการแจกแจงความน่าจะเป็นภายหลังที่ประมาณได้ในตัวอย่างนี้เป็นการแจกแจงความน่าจะเป็นร่วม (joint probability distribution) เนื่องจากมีพารามิเตอร์ 2 ตัวที่ต้องการประมาณค่า รูปต่อไปนี้แสดงการประมาณการแจกแจงความน่าจะเป็นภายหลังจากตัวอย่างสุ่มของพารามิเตอร์ทั้งสองที่สร้างจากอัลอริทึม Metropolis\n\n\npar(mfrow=c(2,3))\nplot(theta.dat[,1],theta.dat[,2], type=\"l\",xlab=expression(mu),ylab=expression(sigma), main=\"sd.pro=0.005\")\nplot(theta.dat[,3],theta.dat[,4], type=\"l\",xlab=expression(mu),ylab=expression(sigma), main=\"sd.pro=0.02\")\nplot(theta.dat[,5],theta.dat[,6], type=\"l\",xlab=expression(mu),ylab=expression(sigma), main=\"sd.pro=2\")\n\nlibrary(MASS)\nden3d<-kde2d(theta.dat[1000:5000,1],theta.dat[1000:5000,2])\npersp(den3d, box=T,phi=20,theta=-30, xlab=\"mu\", ylab=expression(sigma))\n\nden3d<-kde2d(theta.dat[1000:5000,3],theta.dat[1000:5000,4])\npersp(den3d, box=T,phi=20,theta=50, xlab=expression(mu), ylab=expression(sigma))\n\nden3d<-kde2d(theta.dat[1000:5000,5],theta.dat[1000:5000,6])\npersp(den3d, box=T,phi=20,theta=50, xlab=expression(mu), ylab=expression(sigma))\n\n\n\n\nจากตัวอย่างในข้างต้น ผู้อ่านจะเห็นว่าตัวอย่างที่สุ่มจากอัลกอริทึม Metropolis ข้างต้นมีลักษณะที่แตกต่างกันออกไปตามลักษณะของ proposal distribution ที่กำหนด\nถ้า proposal distribution มีลักษณะการกระจายที่แคบกว่าการแจกแจงความน่าจะเป็นภายหลัง/การแจกแจงเป้าหมาย ที่ต้องการประมาณมาก กระบวนการสุ่มที่สร้างขึ้นจากอัลกอริทึม Metropolis ในข้างต้นจะสร้างตัวอย่างสุ่มของพารามิเตอร์ที่เป็นตัวแทน ครอบคลุมการแจกแจงความน่าจะเป็นภายหลังที่ต้องการได้ช้า ภายใต้สถานการณ์ดังกล่าว ผู้วิเคราะห์จึงต้องใช้จำนวนการทวนซ้ำที่เพ่ิมจึ้นกว่าปกติเพื่อที่จะได้ตัวอย่างของพารามิเตอร์ที่เป็นตัวแทนของการแจกแจงความน่าจะเป็นภายหลังดังกล่าวได้ ในทางกลับกันหาก proposal distribution มีการกระจายที่กว้างเมื่อเปรียบเทียบกับการแจกแจงความน่าจะเป็นภายหลัง จะทำให้การพัฒนาค่าของพารามิเตอร์ในแต่ละรอบมีการเปลี่ยนแปลงมากเกินไป และอาจไม่สามารถลู่เข้าไปสู่การแจกแจงความน่าจะเป็นภายหลังที่ต้องการได้\nปัจจัยในข้างต้นส่งผลโดยตรงต่อประสิทธิภาพของอัลกอริทึม Metropolis การพิจารณาว่า proposal distribution ดังกล่าวมีความเหมาะสมแล้วหรือไม่ อาจพิจารณาได้จากอัตราส่วนการยอมรับ ซึ่งคำนวณได้จาก จำนวนพารามิเตอร์ที่ได้รับการยอมรับต่อจำนวนการทวนซ้ำทั้งหมด รูปต่อไปนี้แสดงการเปรียบเทียบกระบวนการสุ่มที่สร้างจากอัลกอริทึม MCMC ภายใต้สถานการณ์ที่มีการกำหนดการกระจายของ proposal distribution แตกต่างกัน\nปัจจัยในข้างต้นส่งผลโดยตรงต่อประสิทธิภาพของอัลกอริทึม Metropolis การพิจารณาว่า proposal distribution ดังกล่าวมีความเหมาะสมแล้วหรือไม่ อาจพิจารณาได้จากอัตราส่วนการยอมรับ ซึ่งคำนวณได้จาก จำนวนพารามิเตอร์ที่ได้รับการยอมรับต่อจำนวนการทวนซ้ำทั้งหมด\n\n\ncolSums(count)/5000\n\n\n[1] 0.6710 0.4490 0.0104\n\nGibbs Sampling algorithm\nอัลกอริทึม Metropolis ที่กล่าวในหัวก่อนหน้านี้เป็นอัลกอริทึมที่มีประโยชน์มากสำหรับหาการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ที่ไม่สามารถพิสูจน์หรือหารูปแบบปิดได้ อย่างไรก็ตามอัลกอริทึมดังกล่าวอาจมีประสิทธิภาพต่ำในหลายกรณีดังจะเห็นในตัวอย่างก่อนหน้านี้ที่หลายกรณีมีการ reject ค่า proposed value จำนวนมากจน ตัวอย่างที่เหลืออาจมีปริมาณน้อยเกินไปจนไม่เพียงพอที่จะนำไปใช้อนุมานเกี่ยวกับพารามิเตอร์ที่ต้องการ\nปัจจัยสำคัญที่มีผลต่ออัตราการยอมรับหรือปฏิเสธค่า proposed values คือการแจงแจงโครงร่าง การกำหนดการแจกแจงโครงร่างที่มีขอบเขตแคบมากเกินไป ถึงแม้ว่าในกรณีนี้อัตราการยอมรับค่า proposed value จะมีสูง แต่จะเห็นว่าอัลกอริทึมต้องใช้จำนวนรอบการทวนซ้ำที่มากขึ้น เพื่อให้ได้ตัวอย่างของพารามิเตอร์ที่ครอบคลุมและเป็นตัวแทนของการแจกแจงความน่าจะเป็นภายหลังที่ต้องการ\nในทางกลับกันหากกำหนดการแจกแจงความน่าจะเป็นโครงร่างที่มีขอบเขตกว้างมากเกินไป จะเห็นว่าอัตราการยอมรับ proposed value มีแนวโน้มต่ำลงมา ทั้งนี้เป็นเพราะมีโอกาสสูงขึ้นที่ proposed value ที่ได้จะถูกสุ่มมาแล้วอยู่นอกเหนือขอบเขตที่เป็นไปได้จริงของพารามิเตอร์ที่ต้องการประมาณ\nรูปด้านล่างแสดงการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ \\(\\mu\\) และ \\(\\sigma\\) ใน mean model \\(y_i=\\mu+\\epsilon_i\\) ภายใต้สถานการณ์ที่มีการกำหนดการแจกแจงโครงร่างแตกต่างกัน\n\n\n\nจากข้อจำกัดนี้จึงมีการพัฒนาอัลกอริทึมตัวอื่น ๆ ขึ้นมาเพิ่มเติม อัลกอริทึม Gibbs Sampling พัฒนาขึ้นโดย Geman และ Geman (1984) เป็นอัลกอริทึมหนึ่งที่มีจุดเด่นในการนำมาใช้ประมาณการแจกแจงความน่าจะเป็นภายหลังของโมเดลการวิเคราะห์ที่มีพารามิเตอร์จำนวนมาก\nGibbs sampling เป็นแนวเดินสุ่ม (random walk) ประเภทหนึ่งเหมือนกับอัลกอริทึม Metropolis ความแตกต่างระหว่าง Gibbs กับ Metropolis ของในแต่ละขั้นของการทวนซ้ำ Metropolis จะสุ่มตัวอย่างของพารามิเตอร์ทุกตัวขึ้นมาพร้อมกันจากการแจกแจงความน่าจะเป็นภายหลัง \\(p(\\theta_1, \\theta_2, \\theta_3,...,\\theta_k|D)\\)\nในขณะที่แต่ละรอบการทวนซ้ำของอัลกอริทึม Gibbs sampling จะแบ่งสุ่มพารามิเตอร์ทีละค่า จากการแจกแจงความน่าจะเป็นภายหลังแบบมีเงื่อนไข\n\\(p(\\theta_1|D,\\theta_2, \\theta_3, ...,\\theta_k)\\)\n\\(p(\\theta_2|D,\\theta_1, \\theta_3, ...,\\theta_k)\\)\n\\(p(\\theta_3|D,\\theta_1, \\theta_2, ...,\\theta_k)\\)\n…\n\\(p(\\theta_k|D,\\theta_1, \\theta_2, ...,\\theta_{k-1})\\)\nดังนั้นจะเห็นว่าอัลกอริทึม Gibbs sampling จะใช้เวลาในแต่ละรอบของการทวนซ้ำมากกว่าอัลกอริทึม Metropolis เพราะต้องเสียเวลาในการสุ่มพารามิเตอร์ในโมเดลทีละค่าจนครบก่อน และจึงเริ่มรอบการทวนซ้ำรอบต่อไป\nอัลกอริทึม Gibbs sampling เป็นอัลกอริทึมที่ดำเนินการได้ง่ายกว่า Metropolis ในทางปฏิบัติทั้งสองอัลกอริทึมจะไม่ทราบรูปแบบ (functional form) ของการแจกแจงความน่าจะเป็นร่วมภายหลังของพารามิเตอร์ทั้งหมดภายในโมเดล แต่อัลกอริทึม Gibbs sampling มีการระบุเงื่อนไขเพิ่มเติมคือจำเป็นจะต้องทราบต้องทราบรูปแบบของการแจกแจงความน่าจะเป็นแบบมีเงื่อนไขของพารามิเตอร์แต่ละตัว เมื่อกำหนดข้อมูลและพารามิเตอร์ตัวที่เหลือ การจำลองตัวอย่างพารามิเตอร์แต่ละตัวจากการแจกแจงความน่าจะเป็นแบบที่เงื่อนไขดังกล่าวด้วยจำนวนรอบทวนซ้ำที่มากเพียงพอ จะทำให้ผู้วิเคราะห์ได้ตัวอย่างจำลองที่ใช้เป็นตัวแทนการแจกแจงความน่าจะเป็นภายหลังร่วมที่ต้องการได้\nจากที่กล่าวในข้างต้นทำให้พอจะเห็นได้ว่า Gibbs sampling เป็นกรณีเฉพาะของอัลกอริทึม Metropolis โดยเป็นกรณีที่การแจกแจงโครงร่างเป็นฟังก์ชันที่ขึ้นกับปริภูมิของพารามิเตอร์ภายในโมเดล และค่าตัวอย่างของพารามิเตอร์อื่น ๆ ที่เหลือ กล่าวคือ การแจกแจงโครงร่างของพารามิเตอร์ \\(\\theta_j\\) คือการแจกแจงความน่าจะเป็นภายหลังแบบมีเงื่อนไขของพารามิเตอร์ \\(\\theta_j\\) เมื่อกำหนดข้อมูลตัวอย่าง และพารามิเตอร์ส่วนที่เหลือในโมเดล \\(p(\\theta_j|D,\\theta_1,\\theta_2,...,\\theta_{j-1},\\theta_{j+1},...,\\theta_k)\\)\nเนื่องจากการแจกแจงโครงร่างดังกล่าวเป็นการแจกแจงเดียวกันกับการแจกแจงความน่าจะเป็นภายหลังแบบมีเงื่อนไขของพารามิเตอร์ ดังนั้นอัตราการยอมรับในอัลกอริทึม Gibbs sampling จึงมีค่าเท่ากับ 100% เสมอ ดังนั้น Gibbs sampling จึงมีประสิทธิภาพสูงกว่า Metropolis ในแง่ความเร็วของการประมวลผล อย่างไรก็ตามในกรณีที่เงื่อนไขของ Gibbs sampling ไม่เป็นจริง อัลกอริทึม Metropolis ก็ยังมีความจำเป็นอยู่เช่นเดียวกัน\n\n\n{\"x\":{\"visdat\":{\"3441240eeb5e\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"3441240eeb5e\",\"attrs\":{\"3441240eeb5e\":{\"z\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"surface\",\"showlegend\":false,\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"xaxis\":{\"title\":\"mu\"},\"yaxis\":{\"title\":\"sigma\"},\"hoverlabel\":{\"bgcolor\":\"#FFFFFF99\"},\"scene\":{\"zaxis\":{\"title\":\"res\"}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"scrollZoom\":false},\"data\":[{\"colorbar\":{\"title\":\"res\",\"ticklen\":2},\"colorscale\":[[\"0\",\"rgba(68,1,84,1)\"],[\"0.0416666666666667\",\"rgba(70,19,97,1)\"],[\"0.0833333333333333\",\"rgba(72,32,111,1)\"],[\"0.125\",\"rgba(71,45,122,1)\"],[\"0.166666666666667\",\"rgba(68,58,128,1)\"],[\"0.208333333333333\",\"rgba(64,70,135,1)\"],[\"0.25\",\"rgba(60,82,138,1)\"],[\"0.291666666666667\",\"rgba(56,93,140,1)\"],[\"0.333333333333333\",\"rgba(49,104,142,1)\"],[\"0.375\",\"rgba(46,114,142,1)\"],[\"0.416666666666667\",\"rgba(42,123,142,1)\"],[\"0.458333333333333\",\"rgba(38,133,141,1)\"],[\"0.5\",\"rgba(37,144,140,1)\"],[\"0.541666666666667\",\"rgba(33,154,138,1)\"],[\"0.583333333333333\",\"rgba(39,164,133,1)\"],[\"0.625\",\"rgba(47,174,127,1)\"],[\"0.666666666666667\",\"rgba(53,183,121,1)\"],[\"0.708333333333333\",\"rgba(79,191,110,1)\"],[\"0.75\",\"rgba(98,199,98,1)\"],[\"0.791666666666667\",\"rgba(119,207,85,1)\"],[\"0.833333333333333\",\"rgba(147,214,70,1)\"],[\"0.875\",\"rgba(172,220,52,1)\"],[\"0.916666666666667\",\"rgba(199,225,42,1)\"],[\"0.958333333333333\",\"rgba(226,228,40,1)\"],[\"1\",\"rgba(253,231,37,1)\"]],\"showscale\":true,\"z\":[[3.21408403718971e-06,3.91752109822229e-06,4.74186872166605e-06,5.69995956449911e-06,6.80421596012514e-06,8.06619041339657e-06,9.49604833691972e-06,1.11020052764101e-05,1.28897355790431e-05,1.48617740170699e-05,1.70169359562755e-05,1.93497848991313e-05,2.18501782820052e-05,2.45029229422816e-05,2.72875704349673e-05,3.0178379202322e-05,3.3144465436485e-05,3.61501574149851e-05,3.91555593722571e-05,4.21173209837202e-05,4.49895978018586e-05,4.77251771200216e-05,5.0276733438604e-05,5.25981686758998e-05,5.4645985171118e-05,5.63806349465947e-05,5.77677870641453e-05,5.8779456476219e-05,5.93949425725652e-05,5.96015334692439e-05,5.93949425725652e-05,5.8779456476219e-05,5.77677870641453e-05,5.63806349465947e-05,5.4645985171118e-05,5.25981686758998e-05,5.0276733438604e-05,4.77251771200216e-05,4.49895978018586e-05,4.21173209837202e-05,3.91555593722571e-05,3.61501574149851e-05,3.3144465436485e-05,3.0178379202322e-05,2.72875704349673e-05,2.45029229422816e-05,2.18501782820052e-05,1.93497848991313e-05,1.70169359562755e-05,1.48617740170699e-05,1.28897355790431e-05,1.11020052764101e-05,9.49604833691972e-06,8.06619041339657e-06,6.80421596012514e-06,5.69995956449911e-06,4.74186872166605e-06,3.91752109822229e-06,3.21408403718971e-06,2.61870861989146e-06],[3.91752109822229e-06,4.77491296974167e-06,5.77967798824878e-06,6.94745737652323e-06,8.29339223001709e-06,9.83156344424305e-06,1.15743612423243e-05,1.35317992310307e-05,1.57107936498014e-05,1.81144340332153e-05,2.07412764770443e-05,2.35846946474647e-05,2.66323261710725e-05,2.98656526972564e-05,3.32597504176278e-05,3.67832439560669e-05,4.03984902492659e-05,4.40620104323993e-05,4.77251771200215e-05,5.13351523000597e-05,5.48360579717204e-05,5.81703484167626e-05,6.12803404380319e-05,6.41098468899587e-05,6.66058501781364e-05,6.87201468221651e-05,7.04108921866515e-05,7.16439763936501e-05,7.23941682804207e-05,7.26459738297078e-05,7.23941682804207e-05,7.16439763936501e-05,7.04108921866515e-05,6.87201468221651e-05,6.66058501781364e-05,6.41098468899587e-05,6.12803404380319e-05,5.81703484167626e-05,5.48360579717204e-05,5.13351523000597e-05,4.77251771200215e-05,4.40620104323993e-05,4.03984902492659e-05,3.67832439560669e-05,3.32597504176278e-05,2.98656526972564e-05,2.66323261710725e-05,2.35846946474647e-05,2.07412764770443e-05,1.81144340332153e-05,1.57107936498014e-05,1.35317992310307e-05,1.15743612423243e-05,9.83156344424305e-06,8.29339223001709e-06,6.94745737652323e-06,5.77967798824878e-06,4.77491296974167e-06,3.91752109822229e-06,3.19184133016366e-06],[4.74186872166605e-06,5.77967798824878e-06,6.99587151839852e-06,8.40938185215977e-06,1.00385361625421e-05,1.19003783291651e-05,1.40099057981198e-05,1.6379239297679e-05,1.90167504226969e-05,2.19261788256264e-05,2.51057767674959e-05,2.85475235626955e-05,3.22364554751534e-05,3.61501574149851e-05,4.02584609607684e-05,4.45233885468631e-05,4.88993760371714e-05,5.3333795490707e-05,5.77677870641453e-05,6.21373942629379e-05,6.63749809116695e-05,7.04108921866516e-05,7.41753068561679e-05,7.76002145479816e-05,8.06214413964487e-05,8.31806406638612e-05,8.52271625227473e-05,8.67197194958292e-05,8.76277711320385e-05,8.79325630726992e-05,8.76277711320385e-05,8.67197194958292e-05,8.52271625227473e-05,8.31806406638612e-05,8.06214413964487e-05,7.76002145479816e-05,7.41753068561679e-05,7.04108921866516e-05,6.63749809116695e-05,6.21373942629379e-05,5.77677870641453e-05,5.3333795490707e-05,4.88993760371714e-05,4.45233885468631e-05,4.02584609607684e-05,3.61501574149851e-05,3.22364554751534e-05,2.85475235626955e-05,2.51057767674959e-05,2.19261788256264e-05,1.90167504226969e-05,1.6379239297679e-05,1.40099057981198e-05,1.19003783291651e-05,1.00385361625421e-05,8.40938185215977e-06,6.99587151839852e-06,5.77967798824878e-06,4.74186872166605e-06,3.86348718706127e-06],[5.69995956449911e-06,6.94745737652323e-06,8.40938185215977e-06,1.01084908362672e-05,1.20668144927362e-05,1.43048404036478e-05,1.68405962372715e-05,1.96886517054869e-05,2.28590698772992e-05,2.6356345998996e-05,3.0178379202322e-05,3.43155282284531e-05,3.87498059302222e-05,4.3454268266477e-05,4.83926513099927e-05,5.35193041578842e-05,5.8779456476219e-05,6.41098468899587e-05,6.94397229707644e-05,7.46922058647048e-05,7.97859935603593e-05,8.46373575317392e-05,8.91623692222171e-05,9.32792768173774e-05,9.69109401725347e-05,9.99872236375526e-05,0.000102447243627186,0.00010424137056187,0.000105332893316438,0.000105699268228803,0.000105332893316438,0.00010424137056187,0.000102447243627186,9.99872236375526e-05,9.69109401725347e-05,9.32792768173774e-05,8.91623692222171e-05,8.46373575317392e-05,7.97859935603593e-05,7.46922058647048e-05,6.94397229707644e-05,6.41098468899587e-05,5.8779456476219e-05,5.35193041578842e-05,4.83926513099927e-05,4.3454268266477e-05,3.87498059302222e-05,3.43155282284531e-05,3.0178379202322e-05,2.6356345998996e-05,2.28590698772992e-05,1.96886517054869e-05,1.68405962372715e-05,1.43048404036478e-05,1.20668144927362e-05,1.01084908362672e-05,8.40938185215977e-06,6.94745737652323e-06,5.69995956449911e-06,4.64410173221167e-06],[6.80421596012514e-06,8.29339223001709e-06,1.00385361625421e-05,1.20668144927362e-05,1.44045253006211e-05,1.70761252391615e-05,2.01031344870138e-05,2.35029453545942e-05,2.72875704349673e-05,3.14623758410308e-05,3.60248537021319e-05,4.09634949529126e-05,4.62568277859949e-05,5.18726882758693e-05,5.77677870641453e-05,6.38876292726592e-05,7.01668338796569e-05,7.65298838480742e-05,8.28923198415467e-05,8.9162369222217e-05,9.5242979293932e-05,0.000101034200755928,0.000106435845524756,0.000111350323960676,0.000115685551515073,0.000119357805118574,0.000122294406174473,0.00012443611033664,0.000125739094412829,0.00012617644734453,0.000125739094412829,0.00012443611033664,0.000122294406174473,0.000119357805118574,0.000115685551515073,0.000111350323960676,0.000106435845524756,0.000101034200755928,9.5242979293932e-05,8.9162369222217e-05,8.28923198415467e-05,7.65298838480742e-05,7.01668338796569e-05,6.38876292726592e-05,5.77677870641453e-05,5.18726882758693e-05,4.62568277859949e-05,4.09634949529126e-05,3.60248537021319e-05,3.14623758410308e-05,2.72875704349673e-05,2.35029453545942e-05,2.01031344870138e-05,1.70761252391615e-05,1.44045253006211e-05,1.20668144927362e-05,1.00385361625421e-05,8.29339223001709e-06,6.80421596012514e-06,5.54380619181398e-06],[8.06619041339657e-06,9.83156344424305e-06,1.19003783291651e-05,1.43048404036478e-05,1.70761252391615e-05,2.02432254515847e-05,2.38316525561e-05,2.78620246060391e-05,3.23485821639572e-05,3.72976865929657e-05,4.27063648889249e-05,4.85609734060124e-05,5.48360579717205e-05,6.14934892337295e-05,6.84819489784938e-05,7.5736835190675e-05,8.31806406638612e-05,9.07238422547564e-05,9.8266315997088e-05,0.000105699268228803,0.000112907645939844,0.000119772962283764,0.00012617644734453,0.000132002411581847,0.000137141691572972,0.000141495036173689,0.00014497628712514,0.000147515212062625,0.000149059859928855,0.00014957832848506,0.000149059859928855,0.000147515212062625,0.00014497628712514,0.000141495036173689,0.000137141691572972,0.000132002411581847,0.00012617644734453,0.000119772962283764,0.000112907645939844,0.000105699268228803,9.8266315997088e-05,9.07238422547564e-05,8.31806406638612e-05,7.5736835190675e-05,6.84819489784938e-05,6.14934892337295e-05,5.48360579717205e-05,4.85609734060124e-05,4.27063648889249e-05,3.72976865929657e-05,3.23485821639572e-05,2.78620246060391e-05,2.38316525561e-05,2.02432254515847e-05,1.70761252391615e-05,1.43048404036478e-05,1.19003783291651e-05,9.83156344424305e-06,8.06619041339657e-06,6.57201309014831e-06],[9.49604833691972e-06,1.15743612423243e-05,1.40099057981198e-05,1.68405962372715e-05,2.01031344870138e-05,2.38316525561e-05,2.80561842732531e-05,3.2801002562991e-05,3.80828723494522e-05,4.3909282646471e-05,5.02767334386039e-05,5.71691625312361e-05,6.45566036032019e-05,7.23941682804207e-05,8.06214413964486e-05,8.9162369222217e-05,9.79257051914008e-05,0.000106806056788768,0.000115685551515073,0.00012443611033664,0.000132922285304829,0.000141004585933616,0.000148543188488892,0.000155401895656881,0.000161452193097372,0.000166577235854486,0.00017067559277562,0.000173664581715198,0.000175483042481617,0.000176093417667247,0.000175483042481617,0.000173664581715198,0.00017067559277562,0.000166577235854486,0.000161452193097372,0.000155401895656881,0.000148543188488892,0.000141004585933616,0.000132922285304829,0.00012443611033664,0.000115685551515073,0.000106806056788768,9.79257051914008e-05,8.9162369222217e-05,8.06214413964486e-05,7.23941682804207e-05,6.45566036032019e-05,5.71691625312361e-05,5.02767334386039e-05,4.3909282646471e-05,3.80828723494522e-05,3.2801002562991e-05,2.80561842732531e-05,2.38316525561e-05,2.01031344870138e-05,1.68405962372715e-05,1.40099057981198e-05,1.15743612423243e-05,9.49604833691972e-06,7.73700480356479e-06],[1.11020052764101e-05,1.35317992310307e-05,1.6379239297679e-05,1.96886517054869e-05,2.35029453545942e-05,2.78620246060391e-05,3.2801002562991e-05,3.8348257149246e-05,4.45233885468631e-05,5.13351523000598e-05,5.8779456476219e-05,6.68375224673307e-05,7.54743160945561e-05,8.46373575317391e-05,9.42560142933618e-05,0.00010424137056187,0.000114486748293424,0.000124868931154376,0.000135250112231564,0.000145480551964149,0.000155401895656881,0.000164851062409484,0.000173664581715198,0.000181683222782168,0.000188756737124659,0.000194748519149408,0.000199539983824892,0.000203034465929549,0.000205160461955206,0.000205874062843809,0.000205160461955206,0.000203034465929549,0.000199539983824892,0.000194748519149408,0.000188756737124659,0.000181683222782168,0.000173664581715198,0.000164851062409484,0.000155401895656881,0.000145480551964149,0.000135250112231564,0.000124868931154376,0.000114486748293424,0.00010424137056187,9.42560142933618e-05,8.46373575317391e-05,7.54743160945561e-05,6.68375224673307e-05,5.8779456476219e-05,5.13351523000598e-05,4.45233885468631e-05,3.8348257149246e-05,3.2801002562991e-05,2.78620246060391e-05,2.35029453545942e-05,1.96886517054869e-05,1.6379239297679e-05,1.35317992310307e-05,1.11020052764101e-05,9.04547503394966e-06],[1.28897355790431e-05,1.57107936498014e-05,1.90167504226969e-05,2.28590698772992e-05,2.72875704349673e-05,3.23485821639572e-05,3.80828723494522e-05,4.45233885468631e-05,5.16928871103578e-05,5.96015334692439e-05,6.82445767764334e-05,7.76002145479816e-05,8.76277711320385e-05,9.8266315997088e-05,0.000109433842871385,0.00012102711802836,0.000132922285304829,0.00014497628712514,0.000157029125846758,0.000168906949692739,0.000180425904476507,0.000191396648756564,0.000201629388747495,0.000210939253090302,0.000219151799132142,0.000226108423996155,0.00023167144717671,0.000235728637674578,0.000238196977936588,0.000239025488330347,0.000238196977936588,0.000235728637674578,0.00023167144717671,0.000226108423996155,0.000219151799132142,0.000210939253090302,0.000201629388747495,0.000191396648756564,0.000180425904476507,0.000168906949692739,0.000157029125846758,0.00014497628712514,0.000132922285304829,0.00012102711802836,0.000109433842871385,9.8266315997088e-05,8.76277711320385e-05,7.76002145479816e-05,6.82445767764334e-05,5.96015334692439e-05,5.16928871103578e-05,4.45233885468631e-05,3.80828723494522e-05,3.23485821639572e-05,2.72875704349673e-05,2.28590698772992e-05,1.90167504226969e-05,1.57107936498014e-05,1.28897355790431e-05,1.0502047015073e-05],[1.48617740170699e-05,1.81144340332153e-05,2.19261788256264e-05,2.6356345998996e-05,3.14623758410308e-05,3.72976865929657e-05,4.3909282646471e-05,5.13351523000598e-05,5.96015334692439e-05,6.87201468221652e-05,7.86855146657106e-05,8.94724988899932e-05,0.000101034200755928,0.00011330036779134,0.00012617644734453,0.00013954341165843,0.000153258455452311,0.000167156634352589,0.000181053472208294,0.000194748519149408,0.000208029792598302,0.000220678983211207,0.000232477260095017,0.000243211467879491,0.000252680475418874,0.000260701414717162,0.000267115541124499,0.00027179345309203,0.000274639431967723,0.000275594698595757,0.000274639431967723,0.00027179345309203,0.000267115541124499,0.000260701414717162,0.000252680475418874,0.000243211467879491,0.000232477260095017,0.000220678983211207,0.000208029792598302,0.000194748519149408,0.000181053472208294,0.000167156634352589,0.000153258455452311,0.00013954341165843,0.00012617644734453,0.00011330036779134,0.000101034200755928,8.94724988899932e-05,7.86855146657106e-05,6.87201468221652e-05,5.96015334692439e-05,5.13351523000598e-05,4.3909282646471e-05,3.72976865929657e-05,3.14623758410308e-05,2.6356345998996e-05,2.19261788256264e-05,1.81144340332153e-05,1.48617740170699e-05,1.21087859791647e-05],[1.70169359562755e-05,2.07412764770443e-05,2.51057767674959e-05,3.0178379202322e-05,3.60248537021319e-05,4.27063648889249e-05,5.02767334386039e-05,5.8779456476219e-05,6.82445767764334e-05,7.86855146657106e-05,9.00959981099861e-05,0.000102447243627186,0.000115685551515073,0.000129730481725344,0.000144473770169435,0.000159779128426005,0.000175483042481618,0.000191396648756564,0.000207308719517003,0.000222989736900759,0.000238196977936588,0.000252680475418874,0.000266189664960822,0.000278480480727496,0.000289322624786617,0.000298506710763929,0.000305850973848789,0.000311207247485378,0.000314465932498685,0.000315559725945668,0.000314465932498685,0.000311207247485378,0.000305850973848789,0.000298506710763929,0.000289322624786617,0.000278480480727496,0.000266189664960822,0.000252680475418874,0.000238196977936588,0.000222989736900759,0.000207308719517003,0.000191396648756564,0.000175483042481618,0.000159779128426005,0.000144473770169435,0.000129730481725344,0.000115685551515073,0.000102447243627186,9.00959981099861e-05,7.86855146657106e-05,6.82445767764334e-05,5.8779456476219e-05,5.02767334386039e-05,4.27063648889249e-05,3.60248537021319e-05,3.0178379202322e-05,2.51057767674959e-05,2.07412764770443e-05,1.70169359562755e-05,1.38647267330955e-05],[1.93497848991313e-05,2.35846946474647e-05,2.85475235626955e-05,3.43155282284531e-05,4.09634949529126e-05,4.85609734060124e-05,5.71691625312361e-05,6.68375224673307e-05,7.76002145479816e-05,8.94724988899932e-05,0.000102447243627186,0.000116491719354677,0.000131544864686908,0.000147515212062625,0.000164279655487224,0.000181683222782168,0.000199539983824891,0.000217635183758703,0.000235728637674578,0.000253559363144478,0.000270851362345075,0.000287320400107775,0.000302681562215334,0.000316657323887768,0.000328985815687258,0.000339428946496043,0.000347780033395578,0.000353870597701349,0.000357576015305525,0.000358819756715705,0.000357576015305525,0.000353870597701349,0.000347780033395578,0.000339428946496043,0.000328985815687258,0.000316657323887768,0.000302681562215334,0.000287320400107775,0.000270851362345075,0.000253559363144478,0.000235728637674578,0.000217635183758703,0.000199539983824891,0.000181683222782168,0.000164279655487224,0.000147515212062625,0.000131544864686908,0.000116491719354677,0.000102447243627186,8.94724988899932e-05,7.76002145479816e-05,6.68375224673307e-05,5.71691625312361e-05,4.85609734060124e-05,4.09634949529126e-05,3.43155282284531e-05,2.85475235626955e-05,2.35846946474647e-05,1.93497848991313e-05,1.57654398335851e-05],[2.18501782820052e-05,2.66323261710725e-05,3.22364554751534e-05,3.87498059302222e-05,4.62568277859949e-05,5.48360579717205e-05,6.45566036032019e-05,7.54743160945561e-05,8.76277711320385e-05,0.000101034200755928,0.000115685551515073,0.000131544864686908,0.000148543188488893,0.000166577235854486,0.000185507992942257,0.000205160461955206,0.000225324686744092,0.000245758161672284,0.000266189664960822,0.000286324489841087,0.000305850973848789,0.000324448152738576,0.00034179429546929,0.000357576015305525,0.000371497603848827,0.000383290203672741,0.000392720424140542,0.000399598015628657,0.000403782250010723,0.000405186708597256,0.000403782250010723,0.000399598015628657,0.000392720424140542,0.000383290203672741,0.000371497603848827,0.000357576015305525,0.00034179429546929,0.000324448152738576,0.000305850973848789,0.000286324489841087,0.000266189664960822,0.000245758161672284,0.000225324686744092,0.000205160461955206,0.000185507992942257,0.000166577235854486,0.000148543188488893,0.000131544864686908,0.000115685551515073,0.000101034200755928,8.76277711320385e-05,7.54743160945561e-05,6.45566036032019e-05,5.48360579717205e-05,4.62568277859949e-05,3.87498059302222e-05,3.22364554751534e-05,2.66323261710725e-05,2.18501782820052e-05,1.78026615207246e-05],[2.45029229422816e-05,2.98656526972564e-05,3.61501574149851e-05,4.3454268266477e-05,5.18726882758693e-05,6.14934892337295e-05,7.23941682804207e-05,8.46373575317391e-05,9.8266315997088e-05,0.00011330036779134,0.000129730481725344,0.000147515212062625,0.000166577235854486,0.000186800726355729,0.000208029792598302,0.000230068190987318,0.000252680475418874,0.000275594698595757,0.000298506710763929,0.00032108602595898,0.000342983143996156,0.000363838133616793,0.000383290203672741,0.000400987920371117,0.000416599674513718,0.000429823967745801,0.000440399074386536,0.000448111647349867,0.000452803873258186,0.000454378841667015,0.000452803873258186,0.000448111647349867,0.000440399074386536,0.000429823967745801,0.000416599674513718,0.000400987920371117,0.000383290203672741,0.000363838133616793,0.000342983143996156,0.00032108602595898,0.000298506710763929,0.000275594698595757,0.000252680475418874,0.000230068190987318,0.000208029792598302,0.000186800726355729,0.000166577235854486,0.000147515212062625,0.000129730481725344,0.00011330036779134,9.8266315997088e-05,8.46373575317391e-05,7.23941682804207e-05,6.14934892337295e-05,5.18726882758693e-05,4.3454268266477e-05,3.61501574149851e-05,2.98656526972564e-05,2.45029229422816e-05,1.99640130062044e-05],[2.72875704349673e-05,3.32597504176278e-05,4.02584609607684e-05,4.83926513099927e-05,5.77677870641453e-05,6.84819489784938e-05,8.06214413964486e-05,9.42560142933618e-05,0.000109433842871385,0.00012617644734453,0.000144473770169435,0.000164279655487224,0.000185507992942257,0.000208029792598302,0.00023167144717671,0.000256214410876621,0.000281396480198517,0.000306914802252365,0.00033243066202626,0.000357576015305525,0.000381961642774123,0.000405186708597256,0.00042684941932805,0.000446558402296434,0.000463944362403443,0.000478671537356126,0.000490448457521777,0.000499037529873165,0.000504263006248846,0.000506016962766197,0.000504263006248846,0.000499037529873165,0.000490448457521777,0.000478671537356126,0.000463944362403443,0.000446558402296434,0.00042684941932805,0.000405186708597256,0.000381961642774123,0.000357576015305525,0.00033243066202626,0.000306914802252365,0.000281396480198517,0.000256214410876621,0.00023167144717671,0.000208029792598302,0.000185507992942257,0.000164279655487224,0.000144473770169435,0.00012617644734453,0.000109433842871385,9.42560142933618e-05,8.06214413964486e-05,6.84819489784938e-05,5.77677870641453e-05,4.83926513099927e-05,4.02584609607684e-05,3.32597504176278e-05,2.72875704349673e-05,2.22328337053766e-05],[3.0178379202322e-05,3.67832439560669e-05,4.45233885468631e-05,5.35193041578842e-05,6.38876292726592e-05,7.5736835190675e-05,8.9162369222217e-05,0.00010424137056187,0.00012102711802836,0.00013954341165843,0.000159779128426005,0.000181683222782168,0.000205160461955206,0.000230068190987318,0.000256214410876621,0.000283357423371997,0.000311207247485378,0.000339428946496043,0.000367647922376107,0.000395457140798338,0.000422426149072188,0.000448111647349867,0.000472069276723363,0.000493866203024644,0.000513094008525181,0.000529381360723144,0.000542405912082214,0.00055190489928718,0.000557683955651099,0.000559623723979362,0.000557683955651099,0.00055190489928718,0.000542405912082214,0.000529381360723144,0.000513094008525181,0.000493866203024644,0.000472069276723363,0.000448111647349867,0.000422426149072188,0.000395457140798338,0.000367647922376107,0.000339428946496043,0.000311207247485378,0.000283357423371997,0.000256214410876621,0.000230068190987318,0.000205160461955206,0.000181683222782168,0.000159779128426005,0.00013954341165843,0.00012102711802836,0.00010424137056187,8.9162369222217e-05,7.5736835190675e-05,6.38876292726592e-05,5.35193041578842e-05,4.45233885468631e-05,3.67832439560669e-05,3.0178379202322e-05,2.45881504145653e-05],[3.3144465436485e-05,4.03984902492659e-05,4.88993760371714e-05,5.8779456476219e-05,7.01668338796569e-05,8.31806406638612e-05,9.79257051914008e-05,0.000114486748293424,0.000132922285304829,0.000153258455452311,0.000175483042481618,0.000199539983824891,0.000225324686744092,0.000252680475418874,0.000281396480198517,0.000311207247485378,0.00034179429546929,0.000372789768126945,0.000403782250010723,0.000434324701367435,0.000463944362403443,0.00049215436348322,0.000518466671821133,0.000542405912082214,0.000563523525144183,0.000581411682038166,0.000595716353255009,0.000606148949750197,0.000612496001479691,0.000614626420210262,0.000612496001479691,0.000606148949750197,0.000595716353255009,0.000581411682038166,0.000563523525144183,0.000542405912082214,0.000518466671821133,0.00049215436348322,0.000463944362403443,0.000434324701367435,0.000403782250010723,0.000372789768126945,0.00034179429546929,0.000311207247485378,0.000281396480198517,0.000252680475418874,0.000225324686744092,0.000199539983824891,0.000175483042481618,0.000153258455452311,0.000132922285304829,0.000114486748293424,9.79257051914008e-05,8.31806406638612e-05,7.01668338796569e-05,5.8779456476219e-05,4.88993760371714e-05,4.03984902492659e-05,3.3144465436485e-05,2.70048002279708e-05],[3.61501574149851e-05,4.40620104323993e-05,5.3333795490707e-05,6.41098468899587e-05,7.65298838480742e-05,9.07238422547564e-05,0.000106806056788768,0.000124868931154376,0.00014497628712514,0.000167156634352589,0.000191396648756564,0.000217635183758703,0.000245758161672284,0.000275594698595757,0.000306914802252365,0.000339428946496043,0.000372789768126945,0.000406596052252216,0.000440399074386536,0.00047371125516376,0.000506016962766197,0.000536785175989159,0.000565483604998067,0.000591593765244629,0.000614626420210262,0.000634136757126711,0.000649738641466932,0.00066111731360967,0.00066803994506927,0.00067036355993093,0.00066803994506927,0.00066111731360967,0.000649738641466932,0.000634136757126711,0.000614626420210262,0.000591593765244629,0.000565483604998067,0.000536785175989159,0.000506016962766197,0.00047371125516376,0.000440399074386536,0.000406596052252216,0.000372789768126945,0.000339428946496043,0.000306914802252365,0.000275594698595757,0.000245758161672284,0.000217635183758703,0.000191396648756564,0.000167156634352589,0.00014497628712514,0.000124868931154376,0.000106806056788768,9.07238422547564e-05,7.65298838480742e-05,6.41098468899587e-05,5.3333795490707e-05,4.40620104323993e-05,3.61501574149851e-05,2.94537192362364e-05],[3.91555593722571e-05,4.77251771200215e-05,5.77677870641453e-05,6.94397229707644e-05,8.28923198415467e-05,9.8266315997088e-05,0.000115685551515073,0.000135250112231564,0.000157029125846758,0.000181053472208294,0.000207308719517003,0.000235728637674578,0.000266189664960822,0.000298506710763929,0.00033243066202626,0.000367647922376107,0.000403782250010723,0.000440399074386536,0.000477012365580488,0.000513094008525181,0.00054808550351562,0.000581411682038166,0.000612496001479691,0.000640776872238212,0.000665724384323837,0.000686856744737517,0.000703755717032154,0.000716080373534971,0.000723578529186605,0.000726095321537729,0.000723578529186605,0.000716080373534971,0.000703755717032154,0.000686856744737517,0.000665724384323837,0.000640776872238212,0.000612496001479691,0.000581411682038166,0.00054808550351562,0.000513094008525181,0.000477012365580488,0.000440399074386536,0.000403782250010723,0.000367647922376107,0.00033243066202626,0.000298506710763929,0.000266189664960822,0.000235728637674578,0.000207308719517003,0.000181053472208294,0.000157029125846758,0.000135250112231564,0.000115685551515073,9.8266315997088e-05,8.28923198415467e-05,6.94397229707644e-05,5.77677870641453e-05,4.77251771200215e-05,3.91555593722571e-05,3.19024019466699e-05],[4.21173209837202e-05,5.13351523000597e-05,6.21373942629379e-05,7.46922058647048e-05,8.9162369222217e-05,0.000105699268228803,0.00012443611033664,0.000145480551964149,0.000168906949692739,0.000194748519149408,0.000222989736900759,0.000253559363144478,0.000286324489841087,0.00032108602595898,0.000357576015305525,0.000395457140798338,0.000434324701367435,0.00047371125516376,0.000513094008525181,0.00055190489928718,0.000589543182326414,0.000625390182867271,0.000658825748096529,0.000689245809271282,0.000716080373534971,0.000738811204634201,0.000756988430342091,0.000770245334911076,0.000778310657777834,0.000781017822558546,0.000778310657777834,0.000770245334911076,0.000756988430342091,0.000738811204634201,0.000716080373534971,0.000689245809271282,0.000658825748096529,0.000625390182867271,0.000589543182326414,0.00055190489928718,0.000513094008525181,0.00047371125516376,0.000434324701367435,0.000395457140798338,0.000357576015305525,0.00032108602595898,0.000286324489841087,0.000253559363144478,0.000222989736900759,0.000194748519149408,0.000168906949692739,0.000145480551964149,0.00012443611033664,0.000105699268228803,8.9162369222217e-05,7.46922058647048e-05,6.21373942629379e-05,5.13351523000597e-05,4.21173209837202e-05,3.4315528228453e-05],[4.49895978018586e-05,5.48360579717204e-05,6.63749809116695e-05,7.97859935603593e-05,9.5242979293932e-05,0.000112907645939844,0.000132922285304829,0.000155401895656881,0.000180425904476507,0.000208029792598302,0.000238196977936588,0.000270851362345075,0.000305850973848789,0.000342983143996156,0.000381961642774123,0.000422426149072188,0.000463944362403443,0.000506016962766197,0.00054808550351562,0.000589543182326414,0.00062974828503326,0.00066803994506927,0.000703755717032154,0.000736250336475995,0.000764914938715965,0.000789195945317777,0.000808612804098222,0.000822773790379538,0.000831389144429665,0.000834280929847704,0.000831389144429665,0.000822773790379538,0.000808612804098222,0.000789195945317777,0.000764914938715965,0.000736250336475995,0.000703755717032154,0.00066803994506927,0.00062974828503326,0.000589543182326414,0.00054808550351562,0.000506016962766197,0.000463944362403443,0.000422426149072188,0.000381961642774123,0.000342983143996156,0.000305850973848789,0.000270851362345075,0.000238196977936588,0.000208029792598302,0.000180425904476507,0.000155401895656881,0.000132922285304829,0.000112907645939844,9.5242979293932e-05,7.97859935603593e-05,6.63749809116695e-05,5.48360579717204e-05,4.49895978018586e-05,3.66557458379932e-05],[4.77251771200216e-05,5.81703484167626e-05,7.04108921866516e-05,8.46373575317392e-05,0.000101034200755928,0.000119772962283764,0.000141004585933616,0.000164851062409484,0.000191396648756564,0.000220678983211207,0.000252680475418874,0.000287320400107775,0.000324448152738576,0.000363838133616793,0.000405186708597256,0.000448111647349867,0.00049215436348322,0.000536785175989159,0.000581411682038166,0.000625390182867271,0.00066803994506927,0.000708659918279228,0.000746547377296177,0.000781017822558547,0.000811425367542667,0.000837182773639683,0.000857780268831626,0.000872802309736425,0.000881941517866377,0.000885009137449838,0.000881941517866377,0.000872802309736425,0.000857780268831626,0.000837182773639683,0.000811425367542667,0.000781017822558547,0.000746547377296177,0.000708659918279228,0.00066803994506927,0.000625390182867271,0.000581411682038166,0.000536785175989159,0.00049215436348322,0.000448111647349867,0.000405186708597256,0.000363838133616793,0.000324448152738576,0.000287320400107775,0.000252680475418874,0.000220678983211207,0.000191396648756564,0.000164851062409484,0.000141004585933616,0.000119772962283764,0.000101034200755928,8.46373575317392e-05,7.04108921866516e-05,5.81703484167626e-05,4.77251771200216e-05,3.88845877282426e-05],[5.0276733438604e-05,6.12803404380319e-05,7.41753068561679e-05,8.91623692222171e-05,0.000106435845524756,0.00012617644734453,0.000148543188488892,0.000173664581715198,0.000201629388747495,0.000232477260095017,0.000266189664960822,0.000302681562215334,0.00034179429546929,0.000383290203672741,0.00042684941932805,0.000472069276723363,0.000518466671821133,0.000565483604998067,0.000612496001479691,0.000658825748096529,0.000703755717032154,0.000746547377296177,0.000786460433519536,0.000822773790379538,0.000854807029980605,0.000881941517866376,0.000903640227808592,0.000919465400010154,0.000929093222445134,0.000932324847792503,0.000929093222445134,0.000919465400010154,0.000903640227808592,0.000881941517866376,0.000854807029980605,0.000822773790379538,0.000786460433519536,0.000746547377296177,0.000703755717032154,0.000658825748096529,0.000612496001479691,0.000565483604998067,0.000518466671821133,0.000472069276723363,0.00042684941932805,0.000383290203672741,0.00034179429546929,0.000302681562215334,0.000266189664960822,0.000232477260095017,0.000201629388747495,0.000173664581715198,0.000148543188488892,0.00012617644734453,0.000106435845524756,8.91623692222171e-05,7.41753068561679e-05,6.12803404380319e-05,5.0276733438604e-05,4.09634949529126e-05],[5.25981686758998e-05,6.41098468899587e-05,7.76002145479816e-05,9.32792768173774e-05,0.000111350323960676,0.000132002411581847,0.000155401895656881,0.000181683222782168,0.000210939253090302,0.000243211467879491,0.000278480480727496,0.000316657323887768,0.000357576015305525,0.000400987920371117,0.000446558402296434,0.000493866203024644,0.000542405912082214,0.000591593765244629,0.000640776872238212,0.000689245809271282,0.000736250336475995,0.000781017822558547,0.000822773790379538,0.00086076384937259,0.00089427616460345,0.000922663537313192,0.00094536414508008,0.000961920015357519,0.000971992384697803,0.000975373224372397,0.000971992384697803,0.000961920015357519,0.00094536414508008,0.000922663537313192,0.00089427616460345,0.00086076384937259,0.000822773790379538,0.000781017822558547,0.000736250336475995,0.000689245809271282,0.000640776872238212,0.000591593765244629,0.000542405912082214,0.000493866203024644,0.000446558402296434,0.000400987920371117,0.000357576015305525,0.000316657323887768,0.000278480480727496,0.000243211467879491,0.000210939253090302,0.000181683222782168,0.000155401895656881,0.000132002411581847,0.000111350323960676,9.32792768173774e-05,7.76002145479816e-05,6.41098468899587e-05,5.25981686758998e-05,4.28549086172989e-05],[5.4645985171118e-05,6.66058501781364e-05,8.06214413964487e-05,9.69109401725347e-05,0.000115685551515073,0.000137141691572972,0.000161452193097372,0.000188756737124659,0.000219151799132142,0.000252680475418874,0.000289322624786617,0.000328985815687258,0.000371497603848827,0.000416599674513718,0.000463944362403443,0.000513094008525181,0.000563523525144183,0.000614626420210262,0.000665724384323837,0.000716080373534971,0.000764914938715965,0.000811425367542667,0.000854807029980605,0.00089427616460345,0.000929093222445134,0.000958585807209864,0.000982170222915445,0.000999370666665693,0.00100983518585834,0.00101334765253493,0.00100983518585834,0.000999370666665693,0.000982170222915445,0.000958585807209864,0.000929093222445134,0.00089427616460345,0.000854807029980605,0.000811425367542667,0.000764914938715965,0.000716080373534971,0.000665724384323837,0.000614626420210262,0.000563523525144183,0.000513094008525181,0.000463944362403443,0.000416599674513718,0.000371497603848827,0.000328985815687258,0.000289322624786617,0.000252680475418874,0.000219151799132142,0.000188756737124659,0.000161452193097372,0.000137141691572972,0.000115685551515073,9.69109401725347e-05,8.06214413964487e-05,6.66058501781364e-05,5.4645985171118e-05,4.45233885468631e-05],[5.63806349465947e-05,6.87201468221651e-05,8.31806406638612e-05,9.99872236375526e-05,0.000119357805118574,0.000141495036173689,0.000166577235854486,0.000194748519149408,0.000226108423996155,0.000260701414717162,0.000298506710763929,0.000339428946496043,0.000383290203672741,0.000429823967745801,0.000478671537356126,0.000529381360723144,0.000581411682038166,0.000634136757126711,0.000686856744737517,0.000738811204634201,0.000789195945317777,0.000837182773639683,0.000881941517866376,0.000922663537313192,0.000958585807209864,0.000989014587110983,0.00101334765253493,0.00103109409698031,0.00104189079566998,0.00104551476000761,0.00104189079566998,0.00103109409698031,0.00101334765253493,0.000989014587110983,0.000958585807209864,0.000922663537313192,0.000881941517866376,0.000837182773639683,0.000789195945317777,0.000738811204634201,0.000686856744737517,0.000634136757126711,0.000581411682038166,0.000529381360723144,0.000478671537356126,0.000429823967745801,0.000383290203672741,0.000339428946496043,0.000298506710763929,0.000260701414717162,0.000226108423996155,0.000194748519149408,0.000166577235854486,0.000141495036173689,0.000119357805118574,9.99872236375526e-05,8.31806406638612e-05,6.87201468221651e-05,5.63806349465947e-05,4.59367126127471e-05],[5.77677870641453e-05,7.04108921866515e-05,8.52271625227473e-05,0.000102447243627186,0.000122294406174473,0.00014497628712514,0.00017067559277562,0.000199539983824892,0.00023167144717671,0.000267115541124499,0.000305850973848789,0.000347780033395578,0.000392720424140542,0.000440399074386536,0.000490448457521777,0.000542405912082214,0.000595716353255009,0.000649738641466932,0.000703755717032154,0.000756988430342091,0.000808612804098222,0.000857780268831626,0.000903640227808592,0.00094536414508008,0.000982170222915445,0.00101334765253493,0.00103827939272126,0.00105646245903184,0.00106752479260597,0.00107123791858233,0.00106752479260597,0.00105646245903184,0.00103827939272126,0.00101334765253493,0.000982170222915445,0.00094536414508008,0.000903640227808592,0.000857780268831626,0.000808612804098222,0.000756988430342091,0.000703755717032154,0.000649738641466932,0.000595716353255009,0.000542405912082214,0.000490448457521777,0.000440399074386536,0.000392720424140542,0.000347780033395578,0.000305850973848789,0.000267115541124499,0.00023167144717671,0.000199539983824892,0.00017067559277562,0.00014497628712514,0.000122294406174473,0.000102447243627186,8.52271625227473e-05,7.04108921866515e-05,5.77677870641453e-05,4.70669093236292e-05],[5.8779456476219e-05,7.16439763936501e-05,8.67197194958292e-05,0.00010424137056187,0.00012443611033664,0.000147515212062625,0.000173664581715198,0.000203034465929549,0.000235728637674578,0.00027179345309203,0.000311207247485378,0.000353870597701349,0.000399598015628657,0.000448111647349867,0.000499037529873165,0.00055190489928718,0.000606148949750197,0.00066111731360967,0.000716080373534971,0.000770245334911076,0.000822773790379538,0.000872802309736425,0.000919465400010154,0.000961920015357519,0.000999370666665693,0.00103109409698031,0.00105646245903184,0.00107496395976649,0.00108622002457167,0.00108999817737639,0.00108622002457167,0.00107496395976649,0.00105646245903184,0.00103109409698031,0.000999370666665693,0.000961920015357519,0.000919465400010154,0.000872802309736425,0.000822773790379538,0.000770245334911076,0.000716080373534971,0.00066111731360967,0.000606148949750197,0.00055190489928718,0.000499037529873165,0.000448111647349867,0.000399598015628657,0.000353870597701349,0.000311207247485378,0.00027179345309203,0.000235728637674578,0.000203034465929549,0.000173664581715198,0.000147515212062625,0.00012443611033664,0.00010424137056187,8.67197194958292e-05,7.16439763936501e-05,5.8779456476219e-05,4.78911775690215e-05],[5.93949425725652e-05,7.23941682804207e-05,8.76277711320385e-05,0.000105332893316438,0.000125739094412829,0.000149059859928855,0.000175483042481617,0.000205160461955206,0.000238196977936588,0.000274639431967723,0.000314465932498685,0.000357576015305525,0.000403782250010723,0.000452803873258186,0.000504263006248846,0.000557683955651099,0.000612496001479691,0.00066803994506927,0.000723578529186605,0.000778310657777834,0.000831389144429665,0.000881941517866377,0.000929093222445134,0.000971992384697803,0.00100983518585834,0.00104189079566998,0.00106752479260597,0.00108622002457167,0.00109759395285846,0.00110141166711305,0.00109759395285846,0.00108622002457167,0.00106752479260597,0.00104189079566998,0.00100983518585834,0.000971992384697803,0.000929093222445134,0.000881941517866377,0.000831389144429665,0.000778310657777834,0.000723578529186605,0.00066803994506927,0.000612496001479691,0.000557683955651099,0.000504263006248846,0.000452803873258186,0.000403782250010723,0.000357576015305525,0.000314465932498685,0.000274639431967723,0.000238196977936588,0.000205160461955206,0.000175483042481617,0.000149059859928855,0.000125739094412829,0.000105332893316438,8.76277711320385e-05,7.23941682804207e-05,5.93949425725652e-05,4.83926513099926e-05],[5.96015334692439e-05,7.26459738297078e-05,8.79325630726992e-05,0.000105699268228803,0.00012617644734453,0.00014957832848506,0.000176093417667247,0.000205874062843809,0.000239025488330347,0.000275594698595757,0.000315559725945668,0.000358819756715705,0.000405186708597256,0.000454378841667015,0.000506016962766197,0.000559623723979362,0.000614626420210262,0.00067036355993093,0.000726095321537729,0.000781017822558546,0.000834280929847704,0.000885009137449838,0.000932324847792503,0.000975373224372397,0.00101334765253493,0.00104551476000761,0.00107123791858233,0.00108999817737639,0.00110141166711305,0.00110524266036038,0.00110141166711305,0.00108999817737639,0.00107123791858233,0.00104551476000761,0.00101334765253493,0.000975373224372397,0.000932324847792503,0.000885009137449838,0.000834280929847704,0.000781017822558546,0.000726095321537729,0.00067036355993093,0.000614626420210262,0.000559623723979362,0.000506016962766197,0.000454378841667015,0.000405186708597256,0.000358819756715705,0.000315559725945668,0.000275594698595757,0.000239025488330347,0.000205874062843809,0.000176093417667247,0.00014957832848506,0.00012617644734453,0.000105699268228803,8.79325630726992e-05,7.26459738297078e-05,5.96015334692439e-05,4.85609734060124e-05],[5.93949425725652e-05,7.23941682804207e-05,8.76277711320385e-05,0.000105332893316438,0.000125739094412829,0.000149059859928855,0.000175483042481617,0.000205160461955206,0.000238196977936588,0.000274639431967723,0.000314465932498685,0.000357576015305525,0.000403782250010723,0.000452803873258186,0.000504263006248846,0.000557683955651099,0.000612496001479691,0.00066803994506927,0.000723578529186605,0.000778310657777834,0.000831389144429665,0.000881941517866377,0.000929093222445134,0.000971992384697803,0.00100983518585834,0.00104189079566998,0.00106752479260597,0.00108622002457167,0.00109759395285846,0.00110141166711305,0.00109759395285846,0.00108622002457167,0.00106752479260597,0.00104189079566998,0.00100983518585834,0.000971992384697803,0.000929093222445134,0.000881941517866377,0.000831389144429665,0.000778310657777834,0.000723578529186605,0.00066803994506927,0.000612496001479691,0.000557683955651099,0.000504263006248846,0.000452803873258186,0.000403782250010723,0.000357576015305525,0.000314465932498685,0.000274639431967723,0.000238196977936588,0.000205160461955206,0.000175483042481617,0.000149059859928855,0.000125739094412829,0.000105332893316438,8.76277711320385e-05,7.23941682804207e-05,5.93949425725652e-05,4.83926513099926e-05],[5.8779456476219e-05,7.16439763936501e-05,8.67197194958292e-05,0.00010424137056187,0.00012443611033664,0.000147515212062625,0.000173664581715198,0.000203034465929549,0.000235728637674578,0.00027179345309203,0.000311207247485378,0.000353870597701349,0.000399598015628657,0.000448111647349867,0.000499037529873165,0.00055190489928718,0.000606148949750197,0.00066111731360967,0.000716080373534971,0.000770245334911076,0.000822773790379538,0.000872802309736425,0.000919465400010154,0.000961920015357519,0.000999370666665693,0.00103109409698031,0.00105646245903184,0.00107496395976649,0.00108622002457167,0.00108999817737639,0.00108622002457167,0.00107496395976649,0.00105646245903184,0.00103109409698031,0.000999370666665693,0.000961920015357519,0.000919465400010154,0.000872802309736425,0.000822773790379538,0.000770245334911076,0.000716080373534971,0.00066111731360967,0.000606148949750197,0.00055190489928718,0.000499037529873165,0.000448111647349867,0.000399598015628657,0.000353870597701349,0.000311207247485378,0.00027179345309203,0.000235728637674578,0.000203034465929549,0.000173664581715198,0.000147515212062625,0.00012443611033664,0.00010424137056187,8.67197194958292e-05,7.16439763936501e-05,5.8779456476219e-05,4.78911775690215e-05],[5.77677870641453e-05,7.04108921866515e-05,8.52271625227473e-05,0.000102447243627186,0.000122294406174473,0.00014497628712514,0.00017067559277562,0.000199539983824892,0.00023167144717671,0.000267115541124499,0.000305850973848789,0.000347780033395578,0.000392720424140542,0.000440399074386536,0.000490448457521777,0.000542405912082214,0.000595716353255009,0.000649738641466932,0.000703755717032154,0.000756988430342091,0.000808612804098222,0.000857780268831626,0.000903640227808592,0.00094536414508008,0.000982170222915445,0.00101334765253493,0.00103827939272126,0.00105646245903184,0.00106752479260597,0.00107123791858233,0.00106752479260597,0.00105646245903184,0.00103827939272126,0.00101334765253493,0.000982170222915445,0.00094536414508008,0.000903640227808592,0.000857780268831626,0.000808612804098222,0.000756988430342091,0.000703755717032154,0.000649738641466932,0.000595716353255009,0.000542405912082214,0.000490448457521777,0.000440399074386536,0.000392720424140542,0.000347780033395578,0.000305850973848789,0.000267115541124499,0.00023167144717671,0.000199539983824892,0.00017067559277562,0.00014497628712514,0.000122294406174473,0.000102447243627186,8.52271625227473e-05,7.04108921866515e-05,5.77677870641453e-05,4.70669093236292e-05],[5.63806349465947e-05,6.87201468221651e-05,8.31806406638612e-05,9.99872236375526e-05,0.000119357805118574,0.000141495036173689,0.000166577235854486,0.000194748519149408,0.000226108423996155,0.000260701414717162,0.000298506710763929,0.000339428946496043,0.000383290203672741,0.000429823967745801,0.000478671537356126,0.000529381360723144,0.000581411682038166,0.000634136757126711,0.000686856744737517,0.000738811204634201,0.000789195945317777,0.000837182773639683,0.000881941517866376,0.000922663537313192,0.000958585807209864,0.000989014587110983,0.00101334765253493,0.00103109409698031,0.00104189079566998,0.00104551476000761,0.00104189079566998,0.00103109409698031,0.00101334765253493,0.000989014587110983,0.000958585807209864,0.000922663537313192,0.000881941517866376,0.000837182773639683,0.000789195945317777,0.000738811204634201,0.000686856744737517,0.000634136757126711,0.000581411682038166,0.000529381360723144,0.000478671537356126,0.000429823967745801,0.000383290203672741,0.000339428946496043,0.000298506710763929,0.000260701414717162,0.000226108423996155,0.000194748519149408,0.000166577235854486,0.000141495036173689,0.000119357805118574,9.99872236375526e-05,8.31806406638612e-05,6.87201468221651e-05,5.63806349465947e-05,4.59367126127471e-05],[5.4645985171118e-05,6.66058501781364e-05,8.06214413964487e-05,9.69109401725347e-05,0.000115685551515073,0.000137141691572972,0.000161452193097372,0.000188756737124659,0.000219151799132142,0.000252680475418874,0.000289322624786617,0.000328985815687258,0.000371497603848827,0.000416599674513718,0.000463944362403443,0.000513094008525181,0.000563523525144183,0.000614626420210262,0.000665724384323837,0.000716080373534971,0.000764914938715965,0.000811425367542667,0.000854807029980605,0.00089427616460345,0.000929093222445134,0.000958585807209864,0.000982170222915445,0.000999370666665693,0.00100983518585834,0.00101334765253493,0.00100983518585834,0.000999370666665693,0.000982170222915445,0.000958585807209864,0.000929093222445134,0.00089427616460345,0.000854807029980605,0.000811425367542667,0.000764914938715965,0.000716080373534971,0.000665724384323837,0.000614626420210262,0.000563523525144183,0.000513094008525181,0.000463944362403443,0.000416599674513718,0.000371497603848827,0.000328985815687258,0.000289322624786617,0.000252680475418874,0.000219151799132142,0.000188756737124659,0.000161452193097372,0.000137141691572972,0.000115685551515073,9.69109401725347e-05,8.06214413964487e-05,6.66058501781364e-05,5.4645985171118e-05,4.45233885468631e-05],[5.25981686758998e-05,6.41098468899587e-05,7.76002145479816e-05,9.32792768173774e-05,0.000111350323960676,0.000132002411581847,0.000155401895656881,0.000181683222782168,0.000210939253090302,0.000243211467879491,0.000278480480727496,0.000316657323887768,0.000357576015305525,0.000400987920371117,0.000446558402296434,0.000493866203024644,0.000542405912082214,0.000591593765244629,0.000640776872238212,0.000689245809271282,0.000736250336475995,0.000781017822558547,0.000822773790379538,0.00086076384937259,0.00089427616460345,0.000922663537313192,0.00094536414508008,0.000961920015357519,0.000971992384697803,0.000975373224372397,0.000971992384697803,0.000961920015357519,0.00094536414508008,0.000922663537313192,0.00089427616460345,0.00086076384937259,0.000822773790379538,0.000781017822558547,0.000736250336475995,0.000689245809271282,0.000640776872238212,0.000591593765244629,0.000542405912082214,0.000493866203024644,0.000446558402296434,0.000400987920371117,0.000357576015305525,0.000316657323887768,0.000278480480727496,0.000243211467879491,0.000210939253090302,0.000181683222782168,0.000155401895656881,0.000132002411581847,0.000111350323960676,9.32792768173774e-05,7.76002145479816e-05,6.41098468899587e-05,5.25981686758998e-05,4.28549086172989e-05],[5.0276733438604e-05,6.12803404380319e-05,7.41753068561679e-05,8.91623692222171e-05,0.000106435845524756,0.00012617644734453,0.000148543188488892,0.000173664581715198,0.000201629388747495,0.000232477260095017,0.000266189664960822,0.000302681562215334,0.00034179429546929,0.000383290203672741,0.00042684941932805,0.000472069276723363,0.000518466671821133,0.000565483604998067,0.000612496001479691,0.000658825748096529,0.000703755717032154,0.000746547377296177,0.000786460433519536,0.000822773790379538,0.000854807029980605,0.000881941517866376,0.000903640227808592,0.000919465400010154,0.000929093222445134,0.000932324847792503,0.000929093222445134,0.000919465400010154,0.000903640227808592,0.000881941517866376,0.000854807029980605,0.000822773790379538,0.000786460433519536,0.000746547377296177,0.000703755717032154,0.000658825748096529,0.000612496001479691,0.000565483604998067,0.000518466671821133,0.000472069276723363,0.00042684941932805,0.000383290203672741,0.00034179429546929,0.000302681562215334,0.000266189664960822,0.000232477260095017,0.000201629388747495,0.000173664581715198,0.000148543188488892,0.00012617644734453,0.000106435845524756,8.91623692222171e-05,7.41753068561679e-05,6.12803404380319e-05,5.0276733438604e-05,4.09634949529126e-05],[4.77251771200216e-05,5.81703484167626e-05,7.04108921866516e-05,8.46373575317392e-05,0.000101034200755928,0.000119772962283764,0.000141004585933616,0.000164851062409484,0.000191396648756564,0.000220678983211207,0.000252680475418874,0.000287320400107775,0.000324448152738576,0.000363838133616793,0.000405186708597256,0.000448111647349867,0.00049215436348322,0.000536785175989159,0.000581411682038166,0.000625390182867271,0.00066803994506927,0.000708659918279228,0.000746547377296177,0.000781017822558547,0.000811425367542667,0.000837182773639683,0.000857780268831626,0.000872802309736425,0.000881941517866377,0.000885009137449838,0.000881941517866377,0.000872802309736425,0.000857780268831626,0.000837182773639683,0.000811425367542667,0.000781017822558547,0.000746547377296177,0.000708659918279228,0.00066803994506927,0.000625390182867271,0.000581411682038166,0.000536785175989159,0.00049215436348322,0.000448111647349867,0.000405186708597256,0.000363838133616793,0.000324448152738576,0.000287320400107775,0.000252680475418874,0.000220678983211207,0.000191396648756564,0.000164851062409484,0.000141004585933616,0.000119772962283764,0.000101034200755928,8.46373575317392e-05,7.04108921866516e-05,5.81703484167626e-05,4.77251771200216e-05,3.88845877282426e-05],[4.49895978018586e-05,5.48360579717204e-05,6.63749809116695e-05,7.97859935603593e-05,9.5242979293932e-05,0.000112907645939844,0.000132922285304829,0.000155401895656881,0.000180425904476507,0.000208029792598302,0.000238196977936588,0.000270851362345075,0.000305850973848789,0.000342983143996156,0.000381961642774123,0.000422426149072188,0.000463944362403443,0.000506016962766197,0.00054808550351562,0.000589543182326414,0.00062974828503326,0.00066803994506927,0.000703755717032154,0.000736250336475995,0.000764914938715965,0.000789195945317777,0.000808612804098222,0.000822773790379538,0.000831389144429665,0.000834280929847704,0.000831389144429665,0.000822773790379538,0.000808612804098222,0.000789195945317777,0.000764914938715965,0.000736250336475995,0.000703755717032154,0.00066803994506927,0.00062974828503326,0.000589543182326414,0.00054808550351562,0.000506016962766197,0.000463944362403443,0.000422426149072188,0.000381961642774123,0.000342983143996156,0.000305850973848789,0.000270851362345075,0.000238196977936588,0.000208029792598302,0.000180425904476507,0.000155401895656881,0.000132922285304829,0.000112907645939844,9.5242979293932e-05,7.97859935603593e-05,6.63749809116695e-05,5.48360579717204e-05,4.49895978018586e-05,3.66557458379932e-05],[4.21173209837202e-05,5.13351523000597e-05,6.21373942629379e-05,7.46922058647048e-05,8.9162369222217e-05,0.000105699268228803,0.00012443611033664,0.000145480551964149,0.000168906949692739,0.000194748519149408,0.000222989736900759,0.000253559363144478,0.000286324489841087,0.00032108602595898,0.000357576015305525,0.000395457140798338,0.000434324701367435,0.00047371125516376,0.000513094008525181,0.00055190489928718,0.000589543182326414,0.000625390182867271,0.000658825748096529,0.000689245809271282,0.000716080373534971,0.000738811204634201,0.000756988430342091,0.000770245334911076,0.000778310657777834,0.000781017822558546,0.000778310657777834,0.000770245334911076,0.000756988430342091,0.000738811204634201,0.000716080373534971,0.000689245809271282,0.000658825748096529,0.000625390182867271,0.000589543182326414,0.00055190489928718,0.000513094008525181,0.00047371125516376,0.000434324701367435,0.000395457140798338,0.000357576015305525,0.00032108602595898,0.000286324489841087,0.000253559363144478,0.000222989736900759,0.000194748519149408,0.000168906949692739,0.000145480551964149,0.00012443611033664,0.000105699268228803,8.9162369222217e-05,7.46922058647048e-05,6.21373942629379e-05,5.13351523000597e-05,4.21173209837202e-05,3.4315528228453e-05],[3.91555593722571e-05,4.77251771200215e-05,5.77677870641453e-05,6.94397229707644e-05,8.28923198415467e-05,9.8266315997088e-05,0.000115685551515073,0.000135250112231564,0.000157029125846758,0.000181053472208294,0.000207308719517003,0.000235728637674578,0.000266189664960822,0.000298506710763929,0.00033243066202626,0.000367647922376107,0.000403782250010723,0.000440399074386536,0.000477012365580488,0.000513094008525181,0.00054808550351562,0.000581411682038166,0.000612496001479691,0.000640776872238212,0.000665724384323837,0.000686856744737517,0.000703755717032154,0.000716080373534971,0.000723578529186605,0.000726095321537729,0.000723578529186605,0.000716080373534971,0.000703755717032154,0.000686856744737517,0.000665724384323837,0.000640776872238212,0.000612496001479691,0.000581411682038166,0.00054808550351562,0.000513094008525181,0.000477012365580488,0.000440399074386536,0.000403782250010723,0.000367647922376107,0.00033243066202626,0.000298506710763929,0.000266189664960822,0.000235728637674578,0.000207308719517003,0.000181053472208294,0.000157029125846758,0.000135250112231564,0.000115685551515073,9.8266315997088e-05,8.28923198415467e-05,6.94397229707644e-05,5.77677870641453e-05,4.77251771200215e-05,3.91555593722571e-05,3.19024019466699e-05],[3.61501574149851e-05,4.40620104323993e-05,5.3333795490707e-05,6.41098468899587e-05,7.65298838480742e-05,9.07238422547564e-05,0.000106806056788768,0.000124868931154376,0.00014497628712514,0.000167156634352589,0.000191396648756564,0.000217635183758703,0.000245758161672284,0.000275594698595757,0.000306914802252365,0.000339428946496043,0.000372789768126945,0.000406596052252216,0.000440399074386536,0.00047371125516376,0.000506016962766197,0.000536785175989159,0.000565483604998067,0.000591593765244629,0.000614626420210262,0.000634136757126711,0.000649738641466932,0.00066111731360967,0.00066803994506927,0.00067036355993093,0.00066803994506927,0.00066111731360967,0.000649738641466932,0.000634136757126711,0.000614626420210262,0.000591593765244629,0.000565483604998067,0.000536785175989159,0.000506016962766197,0.00047371125516376,0.000440399074386536,0.000406596052252216,0.000372789768126945,0.000339428946496043,0.000306914802252365,0.000275594698595757,0.000245758161672284,0.000217635183758703,0.000191396648756564,0.000167156634352589,0.00014497628712514,0.000124868931154376,0.000106806056788768,9.07238422547564e-05,7.65298838480742e-05,6.41098468899587e-05,5.3333795490707e-05,4.40620104323993e-05,3.61501574149851e-05,2.94537192362364e-05],[3.3144465436485e-05,4.03984902492659e-05,4.88993760371714e-05,5.8779456476219e-05,7.01668338796569e-05,8.31806406638612e-05,9.79257051914008e-05,0.000114486748293424,0.000132922285304829,0.000153258455452311,0.000175483042481618,0.000199539983824891,0.000225324686744092,0.000252680475418874,0.000281396480198517,0.000311207247485378,0.00034179429546929,0.000372789768126945,0.000403782250010723,0.000434324701367435,0.000463944362403443,0.00049215436348322,0.000518466671821133,0.000542405912082214,0.000563523525144183,0.000581411682038166,0.000595716353255009,0.000606148949750197,0.000612496001479691,0.000614626420210262,0.000612496001479691,0.000606148949750197,0.000595716353255009,0.000581411682038166,0.000563523525144183,0.000542405912082214,0.000518466671821133,0.00049215436348322,0.000463944362403443,0.000434324701367435,0.000403782250010723,0.000372789768126945,0.00034179429546929,0.000311207247485378,0.000281396480198517,0.000252680475418874,0.000225324686744092,0.000199539983824891,0.000175483042481618,0.000153258455452311,0.000132922285304829,0.000114486748293424,9.79257051914008e-05,8.31806406638612e-05,7.01668338796569e-05,5.8779456476219e-05,4.88993760371714e-05,4.03984902492659e-05,3.3144465436485e-05,2.70048002279708e-05],[3.0178379202322e-05,3.67832439560669e-05,4.45233885468631e-05,5.35193041578842e-05,6.38876292726592e-05,7.5736835190675e-05,8.9162369222217e-05,0.00010424137056187,0.00012102711802836,0.00013954341165843,0.000159779128426005,0.000181683222782168,0.000205160461955206,0.000230068190987318,0.000256214410876621,0.000283357423371997,0.000311207247485378,0.000339428946496043,0.000367647922376107,0.000395457140798338,0.000422426149072188,0.000448111647349867,0.000472069276723363,0.000493866203024644,0.000513094008525181,0.000529381360723144,0.000542405912082214,0.00055190489928718,0.000557683955651099,0.000559623723979362,0.000557683955651099,0.00055190489928718,0.000542405912082214,0.000529381360723144,0.000513094008525181,0.000493866203024644,0.000472069276723363,0.000448111647349867,0.000422426149072188,0.000395457140798338,0.000367647922376107,0.000339428946496043,0.000311207247485378,0.000283357423371997,0.000256214410876621,0.000230068190987318,0.000205160461955206,0.000181683222782168,0.000159779128426005,0.00013954341165843,0.00012102711802836,0.00010424137056187,8.9162369222217e-05,7.5736835190675e-05,6.38876292726592e-05,5.35193041578842e-05,4.45233885468631e-05,3.67832439560669e-05,3.0178379202322e-05,2.45881504145653e-05],[2.72875704349673e-05,3.32597504176278e-05,4.02584609607684e-05,4.83926513099927e-05,5.77677870641453e-05,6.84819489784938e-05,8.06214413964486e-05,9.42560142933618e-05,0.000109433842871385,0.00012617644734453,0.000144473770169435,0.000164279655487224,0.000185507992942257,0.000208029792598302,0.00023167144717671,0.000256214410876621,0.000281396480198517,0.000306914802252365,0.00033243066202626,0.000357576015305525,0.000381961642774123,0.000405186708597256,0.00042684941932805,0.000446558402296434,0.000463944362403443,0.000478671537356126,0.000490448457521777,0.000499037529873165,0.000504263006248846,0.000506016962766197,0.000504263006248846,0.000499037529873165,0.000490448457521777,0.000478671537356126,0.000463944362403443,0.000446558402296434,0.00042684941932805,0.000405186708597256,0.000381961642774123,0.000357576015305525,0.00033243066202626,0.000306914802252365,0.000281396480198517,0.000256214410876621,0.00023167144717671,0.000208029792598302,0.000185507992942257,0.000164279655487224,0.000144473770169435,0.00012617644734453,0.000109433842871385,9.42560142933618e-05,8.06214413964486e-05,6.84819489784938e-05,5.77677870641453e-05,4.83926513099927e-05,4.02584609607684e-05,3.32597504176278e-05,2.72875704349673e-05,2.22328337053766e-05],[2.45029229422816e-05,2.98656526972564e-05,3.61501574149851e-05,4.3454268266477e-05,5.18726882758693e-05,6.14934892337295e-05,7.23941682804207e-05,8.46373575317391e-05,9.8266315997088e-05,0.00011330036779134,0.000129730481725344,0.000147515212062625,0.000166577235854486,0.000186800726355729,0.000208029792598302,0.000230068190987318,0.000252680475418874,0.000275594698595757,0.000298506710763929,0.00032108602595898,0.000342983143996156,0.000363838133616793,0.000383290203672741,0.000400987920371117,0.000416599674513718,0.000429823967745801,0.000440399074386536,0.000448111647349867,0.000452803873258186,0.000454378841667015,0.000452803873258186,0.000448111647349867,0.000440399074386536,0.000429823967745801,0.000416599674513718,0.000400987920371117,0.000383290203672741,0.000363838133616793,0.000342983143996156,0.00032108602595898,0.000298506710763929,0.000275594698595757,0.000252680475418874,0.000230068190987318,0.000208029792598302,0.000186800726355729,0.000166577235854486,0.000147515212062625,0.000129730481725344,0.00011330036779134,9.8266315997088e-05,8.46373575317391e-05,7.23941682804207e-05,6.14934892337295e-05,5.18726882758693e-05,4.3454268266477e-05,3.61501574149851e-05,2.98656526972564e-05,2.45029229422816e-05,1.99640130062044e-05],[2.18501782820052e-05,2.66323261710725e-05,3.22364554751534e-05,3.87498059302222e-05,4.62568277859949e-05,5.48360579717205e-05,6.45566036032019e-05,7.54743160945561e-05,8.76277711320385e-05,0.000101034200755928,0.000115685551515073,0.000131544864686908,0.000148543188488893,0.000166577235854486,0.000185507992942257,0.000205160461955206,0.000225324686744092,0.000245758161672284,0.000266189664960822,0.000286324489841087,0.000305850973848789,0.000324448152738576,0.00034179429546929,0.000357576015305525,0.000371497603848827,0.000383290203672741,0.000392720424140542,0.000399598015628657,0.000403782250010723,0.000405186708597256,0.000403782250010723,0.000399598015628657,0.000392720424140542,0.000383290203672741,0.000371497603848827,0.000357576015305525,0.00034179429546929,0.000324448152738576,0.000305850973848789,0.000286324489841087,0.000266189664960822,0.000245758161672284,0.000225324686744092,0.000205160461955206,0.000185507992942257,0.000166577235854486,0.000148543188488893,0.000131544864686908,0.000115685551515073,0.000101034200755928,8.76277711320385e-05,7.54743160945561e-05,6.45566036032019e-05,5.48360579717205e-05,4.62568277859949e-05,3.87498059302222e-05,3.22364554751534e-05,2.66323261710725e-05,2.18501782820052e-05,1.78026615207246e-05],[1.93497848991313e-05,2.35846946474647e-05,2.85475235626955e-05,3.43155282284531e-05,4.09634949529126e-05,4.85609734060124e-05,5.71691625312361e-05,6.68375224673307e-05,7.76002145479816e-05,8.94724988899932e-05,0.000102447243627186,0.000116491719354677,0.000131544864686908,0.000147515212062625,0.000164279655487224,0.000181683222782168,0.000199539983824891,0.000217635183758703,0.000235728637674578,0.000253559363144478,0.000270851362345075,0.000287320400107775,0.000302681562215334,0.000316657323887768,0.000328985815687258,0.000339428946496043,0.000347780033395578,0.000353870597701349,0.000357576015305525,0.000358819756715705,0.000357576015305525,0.000353870597701349,0.000347780033395578,0.000339428946496043,0.000328985815687258,0.000316657323887768,0.000302681562215334,0.000287320400107775,0.000270851362345075,0.000253559363144478,0.000235728637674578,0.000217635183758703,0.000199539983824891,0.000181683222782168,0.000164279655487224,0.000147515212062625,0.000131544864686908,0.000116491719354677,0.000102447243627186,8.94724988899932e-05,7.76002145479816e-05,6.68375224673307e-05,5.71691625312361e-05,4.85609734060124e-05,4.09634949529126e-05,3.43155282284531e-05,2.85475235626955e-05,2.35846946474647e-05,1.93497848991313e-05,1.57654398335851e-05],[1.70169359562755e-05,2.07412764770443e-05,2.51057767674959e-05,3.0178379202322e-05,3.60248537021319e-05,4.27063648889249e-05,5.02767334386039e-05,5.8779456476219e-05,6.82445767764334e-05,7.86855146657106e-05,9.00959981099861e-05,0.000102447243627186,0.000115685551515073,0.000129730481725344,0.000144473770169435,0.000159779128426005,0.000175483042481618,0.000191396648756564,0.000207308719517003,0.000222989736900759,0.000238196977936588,0.000252680475418874,0.000266189664960822,0.000278480480727496,0.000289322624786617,0.000298506710763929,0.000305850973848789,0.000311207247485378,0.000314465932498685,0.000315559725945668,0.000314465932498685,0.000311207247485378,0.000305850973848789,0.000298506710763929,0.000289322624786617,0.000278480480727496,0.000266189664960822,0.000252680475418874,0.000238196977936588,0.000222989736900759,0.000207308719517003,0.000191396648756564,0.000175483042481618,0.000159779128426005,0.000144473770169435,0.000129730481725344,0.000115685551515073,0.000102447243627186,9.00959981099861e-05,7.86855146657106e-05,6.82445767764334e-05,5.8779456476219e-05,5.02767334386039e-05,4.27063648889249e-05,3.60248537021319e-05,3.0178379202322e-05,2.51057767674959e-05,2.07412764770443e-05,1.70169359562755e-05,1.38647267330955e-05],[1.48617740170699e-05,1.81144340332153e-05,2.19261788256264e-05,2.6356345998996e-05,3.14623758410308e-05,3.72976865929657e-05,4.3909282646471e-05,5.13351523000598e-05,5.96015334692439e-05,6.87201468221652e-05,7.86855146657106e-05,8.94724988899932e-05,0.000101034200755928,0.00011330036779134,0.00012617644734453,0.00013954341165843,0.000153258455452311,0.000167156634352589,0.000181053472208294,0.000194748519149408,0.000208029792598302,0.000220678983211207,0.000232477260095017,0.000243211467879491,0.000252680475418874,0.000260701414717162,0.000267115541124499,0.00027179345309203,0.000274639431967723,0.000275594698595757,0.000274639431967723,0.00027179345309203,0.000267115541124499,0.000260701414717162,0.000252680475418874,0.000243211467879491,0.000232477260095017,0.000220678983211207,0.000208029792598302,0.000194748519149408,0.000181053472208294,0.000167156634352589,0.000153258455452311,0.00013954341165843,0.00012617644734453,0.00011330036779134,0.000101034200755928,8.94724988899932e-05,7.86855146657106e-05,6.87201468221652e-05,5.96015334692439e-05,5.13351523000598e-05,4.3909282646471e-05,3.72976865929657e-05,3.14623758410308e-05,2.6356345998996e-05,2.19261788256264e-05,1.81144340332153e-05,1.48617740170699e-05,1.21087859791647e-05],[1.28897355790431e-05,1.57107936498014e-05,1.90167504226969e-05,2.28590698772992e-05,2.72875704349673e-05,3.23485821639572e-05,3.80828723494522e-05,4.45233885468631e-05,5.16928871103578e-05,5.96015334692439e-05,6.82445767764334e-05,7.76002145479816e-05,8.76277711320385e-05,9.8266315997088e-05,0.000109433842871385,0.00012102711802836,0.000132922285304829,0.00014497628712514,0.000157029125846758,0.000168906949692739,0.000180425904476507,0.000191396648756564,0.000201629388747495,0.000210939253090302,0.000219151799132142,0.000226108423996155,0.00023167144717671,0.000235728637674578,0.000238196977936588,0.000239025488330347,0.000238196977936588,0.000235728637674578,0.00023167144717671,0.000226108423996155,0.000219151799132142,0.000210939253090302,0.000201629388747495,0.000191396648756564,0.000180425904476507,0.000168906949692739,0.000157029125846758,0.00014497628712514,0.000132922285304829,0.00012102711802836,0.000109433842871385,9.8266315997088e-05,8.76277711320385e-05,7.76002145479816e-05,6.82445767764334e-05,5.96015334692439e-05,5.16928871103578e-05,4.45233885468631e-05,3.80828723494522e-05,3.23485821639572e-05,2.72875704349673e-05,2.28590698772992e-05,1.90167504226969e-05,1.57107936498014e-05,1.28897355790431e-05,1.0502047015073e-05],[1.11020052764101e-05,1.35317992310307e-05,1.6379239297679e-05,1.96886517054869e-05,2.35029453545942e-05,2.78620246060391e-05,3.2801002562991e-05,3.8348257149246e-05,4.45233885468631e-05,5.13351523000598e-05,5.8779456476219e-05,6.68375224673307e-05,7.54743160945561e-05,8.46373575317391e-05,9.42560142933618e-05,0.00010424137056187,0.000114486748293424,0.000124868931154376,0.000135250112231564,0.000145480551964149,0.000155401895656881,0.000164851062409484,0.000173664581715198,0.000181683222782168,0.000188756737124659,0.000194748519149408,0.000199539983824892,0.000203034465929549,0.000205160461955206,0.000205874062843809,0.000205160461955206,0.000203034465929549,0.000199539983824892,0.000194748519149408,0.000188756737124659,0.000181683222782168,0.000173664581715198,0.000164851062409484,0.000155401895656881,0.000145480551964149,0.000135250112231564,0.000124868931154376,0.000114486748293424,0.00010424137056187,9.42560142933618e-05,8.46373575317391e-05,7.54743160945561e-05,6.68375224673307e-05,5.8779456476219e-05,5.13351523000598e-05,4.45233885468631e-05,3.8348257149246e-05,3.2801002562991e-05,2.78620246060391e-05,2.35029453545942e-05,1.96886517054869e-05,1.6379239297679e-05,1.35317992310307e-05,1.11020052764101e-05,9.04547503394966e-06],[9.49604833691972e-06,1.15743612423243e-05,1.40099057981198e-05,1.68405962372715e-05,2.01031344870138e-05,2.38316525561e-05,2.80561842732531e-05,3.2801002562991e-05,3.80828723494522e-05,4.3909282646471e-05,5.02767334386039e-05,5.71691625312361e-05,6.45566036032019e-05,7.23941682804207e-05,8.06214413964486e-05,8.9162369222217e-05,9.79257051914008e-05,0.000106806056788768,0.000115685551515073,0.00012443611033664,0.000132922285304829,0.000141004585933616,0.000148543188488892,0.000155401895656881,0.000161452193097372,0.000166577235854486,0.00017067559277562,0.000173664581715198,0.000175483042481617,0.000176093417667247,0.000175483042481617,0.000173664581715198,0.00017067559277562,0.000166577235854486,0.000161452193097372,0.000155401895656881,0.000148543188488892,0.000141004585933616,0.000132922285304829,0.00012443611033664,0.000115685551515073,0.000106806056788768,9.79257051914008e-05,8.9162369222217e-05,8.06214413964486e-05,7.23941682804207e-05,6.45566036032019e-05,5.71691625312361e-05,5.02767334386039e-05,4.3909282646471e-05,3.80828723494522e-05,3.2801002562991e-05,2.80561842732531e-05,2.38316525561e-05,2.01031344870138e-05,1.68405962372715e-05,1.40099057981198e-05,1.15743612423243e-05,9.49604833691972e-06,7.73700480356479e-06],[8.06619041339657e-06,9.83156344424305e-06,1.19003783291651e-05,1.43048404036478e-05,1.70761252391615e-05,2.02432254515847e-05,2.38316525561e-05,2.78620246060391e-05,3.23485821639572e-05,3.72976865929657e-05,4.27063648889249e-05,4.85609734060124e-05,5.48360579717205e-05,6.14934892337295e-05,6.84819489784938e-05,7.5736835190675e-05,8.31806406638612e-05,9.07238422547564e-05,9.8266315997088e-05,0.000105699268228803,0.000112907645939844,0.000119772962283764,0.00012617644734453,0.000132002411581847,0.000137141691572972,0.000141495036173689,0.00014497628712514,0.000147515212062625,0.000149059859928855,0.00014957832848506,0.000149059859928855,0.000147515212062625,0.00014497628712514,0.000141495036173689,0.000137141691572972,0.000132002411581847,0.00012617644734453,0.000119772962283764,0.000112907645939844,0.000105699268228803,9.8266315997088e-05,9.07238422547564e-05,8.31806406638612e-05,7.5736835190675e-05,6.84819489784938e-05,6.14934892337295e-05,5.48360579717205e-05,4.85609734060124e-05,4.27063648889249e-05,3.72976865929657e-05,3.23485821639572e-05,2.78620246060391e-05,2.38316525561e-05,2.02432254515847e-05,1.70761252391615e-05,1.43048404036478e-05,1.19003783291651e-05,9.83156344424305e-06,8.06619041339657e-06,6.57201309014831e-06],[6.80421596012514e-06,8.29339223001709e-06,1.00385361625421e-05,1.20668144927362e-05,1.44045253006211e-05,1.70761252391615e-05,2.01031344870138e-05,2.35029453545942e-05,2.72875704349673e-05,3.14623758410308e-05,3.60248537021319e-05,4.09634949529126e-05,4.62568277859949e-05,5.18726882758693e-05,5.77677870641453e-05,6.38876292726592e-05,7.01668338796569e-05,7.65298838480742e-05,8.28923198415467e-05,8.9162369222217e-05,9.5242979293932e-05,0.000101034200755928,0.000106435845524756,0.000111350323960676,0.000115685551515073,0.000119357805118574,0.000122294406174473,0.00012443611033664,0.000125739094412829,0.00012617644734453,0.000125739094412829,0.00012443611033664,0.000122294406174473,0.000119357805118574,0.000115685551515073,0.000111350323960676,0.000106435845524756,0.000101034200755928,9.5242979293932e-05,8.9162369222217e-05,8.28923198415467e-05,7.65298838480742e-05,7.01668338796569e-05,6.38876292726592e-05,5.77677870641453e-05,5.18726882758693e-05,4.62568277859949e-05,4.09634949529126e-05,3.60248537021319e-05,3.14623758410308e-05,2.72875704349673e-05,2.35029453545942e-05,2.01031344870138e-05,1.70761252391615e-05,1.44045253006211e-05,1.20668144927362e-05,1.00385361625421e-05,8.29339223001709e-06,6.80421596012514e-06,5.54380619181398e-06],[5.69995956449911e-06,6.94745737652323e-06,8.40938185215977e-06,1.01084908362672e-05,1.20668144927362e-05,1.43048404036478e-05,1.68405962372715e-05,1.96886517054869e-05,2.28590698772992e-05,2.6356345998996e-05,3.0178379202322e-05,3.43155282284531e-05,3.87498059302222e-05,4.3454268266477e-05,4.83926513099927e-05,5.35193041578842e-05,5.8779456476219e-05,6.41098468899587e-05,6.94397229707644e-05,7.46922058647048e-05,7.97859935603593e-05,8.46373575317392e-05,8.91623692222171e-05,9.32792768173774e-05,9.69109401725347e-05,9.99872236375526e-05,0.000102447243627186,0.00010424137056187,0.000105332893316438,0.000105699268228803,0.000105332893316438,0.00010424137056187,0.000102447243627186,9.99872236375526e-05,9.69109401725347e-05,9.32792768173774e-05,8.91623692222171e-05,8.46373575317392e-05,7.97859935603593e-05,7.46922058647048e-05,6.94397229707644e-05,6.41098468899587e-05,5.8779456476219e-05,5.35193041578842e-05,4.83926513099927e-05,4.3454268266477e-05,3.87498059302222e-05,3.43155282284531e-05,3.0178379202322e-05,2.6356345998996e-05,2.28590698772992e-05,1.96886517054869e-05,1.68405962372715e-05,1.43048404036478e-05,1.20668144927362e-05,1.01084908362672e-05,8.40938185215977e-06,6.94745737652323e-06,5.69995956449911e-06,4.64410173221167e-06],[4.74186872166605e-06,5.77967798824878e-06,6.99587151839852e-06,8.40938185215977e-06,1.00385361625421e-05,1.19003783291651e-05,1.40099057981198e-05,1.6379239297679e-05,1.90167504226969e-05,2.19261788256264e-05,2.51057767674959e-05,2.85475235626955e-05,3.22364554751534e-05,3.61501574149851e-05,4.02584609607684e-05,4.45233885468631e-05,4.88993760371714e-05,5.3333795490707e-05,5.77677870641453e-05,6.21373942629379e-05,6.63749809116695e-05,7.04108921866516e-05,7.41753068561679e-05,7.76002145479816e-05,8.06214413964487e-05,8.31806406638612e-05,8.52271625227473e-05,8.67197194958292e-05,8.76277711320385e-05,8.79325630726992e-05,8.76277711320385e-05,8.67197194958292e-05,8.52271625227473e-05,8.31806406638612e-05,8.06214413964487e-05,7.76002145479816e-05,7.41753068561679e-05,7.04108921866516e-05,6.63749809116695e-05,6.21373942629379e-05,5.77677870641453e-05,5.3333795490707e-05,4.88993760371714e-05,4.45233885468631e-05,4.02584609607684e-05,3.61501574149851e-05,3.22364554751534e-05,2.85475235626955e-05,2.51057767674959e-05,2.19261788256264e-05,1.90167504226969e-05,1.6379239297679e-05,1.40099057981198e-05,1.19003783291651e-05,1.00385361625421e-05,8.40938185215977e-06,6.99587151839852e-06,5.77967798824878e-06,4.74186872166605e-06,3.86348718706127e-06],[3.91752109822229e-06,4.77491296974167e-06,5.77967798824878e-06,6.94745737652323e-06,8.29339223001709e-06,9.83156344424305e-06,1.15743612423243e-05,1.35317992310307e-05,1.57107936498014e-05,1.81144340332153e-05,2.07412764770443e-05,2.35846946474647e-05,2.66323261710725e-05,2.98656526972564e-05,3.32597504176278e-05,3.67832439560669e-05,4.03984902492659e-05,4.40620104323993e-05,4.77251771200215e-05,5.13351523000597e-05,5.48360579717204e-05,5.81703484167626e-05,6.12803404380319e-05,6.41098468899587e-05,6.66058501781364e-05,6.87201468221651e-05,7.04108921866515e-05,7.16439763936501e-05,7.23941682804207e-05,7.26459738297078e-05,7.23941682804207e-05,7.16439763936501e-05,7.04108921866515e-05,6.87201468221651e-05,6.66058501781364e-05,6.41098468899587e-05,6.12803404380319e-05,5.81703484167626e-05,5.48360579717204e-05,5.13351523000597e-05,4.77251771200215e-05,4.40620104323993e-05,4.03984902492659e-05,3.67832439560669e-05,3.32597504176278e-05,2.98656526972564e-05,2.66323261710725e-05,2.35846946474647e-05,2.07412764770443e-05,1.81144340332153e-05,1.57107936498014e-05,1.35317992310307e-05,1.15743612423243e-05,9.83156344424305e-06,8.29339223001709e-06,6.94745737652323e-06,5.77967798824878e-06,4.77491296974167e-06,3.91752109822229e-06,3.19184133016366e-06],[3.21408403718971e-06,3.91752109822229e-06,4.74186872166605e-06,5.69995956449911e-06,6.80421596012514e-06,8.06619041339657e-06,9.49604833691972e-06,1.11020052764101e-05,1.28897355790431e-05,1.48617740170699e-05,1.70169359562755e-05,1.93497848991313e-05,2.18501782820052e-05,2.45029229422816e-05,2.72875704349673e-05,3.0178379202322e-05,3.3144465436485e-05,3.61501574149851e-05,3.91555593722571e-05,4.21173209837202e-05,4.49895978018586e-05,4.77251771200216e-05,5.0276733438604e-05,5.25981686758998e-05,5.4645985171118e-05,5.63806349465947e-05,5.77677870641453e-05,5.8779456476219e-05,5.93949425725652e-05,5.96015334692439e-05,5.93949425725652e-05,5.8779456476219e-05,5.77677870641453e-05,5.63806349465947e-05,5.4645985171118e-05,5.25981686758998e-05,5.0276733438604e-05,4.77251771200216e-05,4.49895978018586e-05,4.21173209837202e-05,3.91555593722571e-05,3.61501574149851e-05,3.3144465436485e-05,3.0178379202322e-05,2.72875704349673e-05,2.45029229422816e-05,2.18501782820052e-05,1.93497848991313e-05,1.70169359562755e-05,1.48617740170699e-05,1.28897355790431e-05,1.11020052764101e-05,9.49604833691972e-06,8.06619041339657e-06,6.80421596012514e-06,5.69995956449911e-06,4.74186872166605e-06,3.91752109822229e-06,3.21408403718971e-06,2.61870861989146e-06],[2.61870861989146e-06,3.19184133016366e-06,3.86348718706127e-06,4.64410173221167e-06,5.54380619181398e-06,6.57201309014831e-06,7.73700480356479e-06,9.04547503394966e-06,1.0502047015073e-05,1.21087859791647e-05,1.38647267330955e-05,1.57654398335851e-05,1.78026615207246e-05,1.99640130062044e-05,2.22328337053766e-05,2.45881504145653e-05,2.70048002279708e-05,2.94537192362364e-05,3.19024019466699e-05,3.4315528228453e-05,3.66557458379932e-05,3.88845877282426e-05,4.09634949529126e-05,4.28549086172989e-05,4.45233885468631e-05,4.59367126127471e-05,4.70669093236292e-05,4.78911775690215e-05,4.83926513099926e-05,4.85609734060124e-05,4.83926513099926e-05,4.78911775690215e-05,4.70669093236292e-05,4.59367126127471e-05,4.45233885468631e-05,4.28549086172989e-05,4.09634949529126e-05,3.88845877282426e-05,3.66557458379932e-05,3.4315528228453e-05,3.19024019466699e-05,2.94537192362364e-05,2.70048002279708e-05,2.45881504145653e-05,2.22328337053766e-05,1.99640130062044e-05,1.78026615207246e-05,1.57654398335851e-05,1.38647267330955e-05,1.21087859791647e-05,1.0502047015073e-05,9.04547503394966e-06,7.73700480356479e-06,6.57201309014831e-06,5.54380619181398e-06,4.64410173221167e-06,3.86348718706127e-06,3.19184133016366e-06,2.61870861989146e-06,2.13362026522802e-06]],\"type\":\"surface\",\"showlegend\":false,\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\nAssessing MCMC samples\nหัวข้อนี้จะกล่าวถึงการประเมินประสิทธิภาพของลูกโซ่มาร์คอฟที่จำลองขึ้นจากอัลกอริทึมในข้างต้นว่า มีคุณสมบัติที่ดีเพียงพอจะใช้เป็นตัวอย่างสำหรับอนุมานไปยังพารามิเตอร์ภายในโมเดลการวิเคราะห์ได้หรือไม่ การตรวจสอบในส่วนนี้เป็นการดำเนินงานที่จะไม่พบในการวิเคราะห์ข้อมูลด้วยสถิติแบบดั้งเดิม คำถามสำคัญที่ผู้วิเคราะห์ต้องการคำตอบในส่วนนี้คือ กระบวนการสุ่มที่สร้างจากอัลกอริทึม MCMC มีคุณสมบัติลู่เข้าสู่การแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์แล้วหรือไม่ หรือตัวอย่างพารามิเตอร์ที่จำลองขึ้นจากอัลกอริทึมดังกล่าว มีความเป็นตัวแทนของการแจกแจงความน่าจะเป็นภายหลังของพารามิเตอร์ดังกล่าวแล้วหรือไม่นั่นเอง\nการตรวจสอบดังกล่าวประกอบด้วยการตรวจสอบการลู่เข้า (convergence) อัตราการยอมรับ (acceptance rates) อัตสหสัมพันธ์ระหว่างลูกโซ่ (autocorrelation)\nConvergence\nการลู่เข้าของกระบวนการ MCMC คือการที่ตัวอย่างสุ่มของพารามิเตอร์ที่จำลองจากอัลกอริทึมอยู่ในสถานะที่ถูกสุ่่มจากการแจกแจงความน่าจะเป็นเป้าหมาย (target distribution) หรือการแจกแจงความน่าจะเป็นภายหลัง (posterior distribution) ที่ต้องการ การลู่เข้าดังกล่าวแตกต่างจากการลู่เข้าทั่ว ๆ ไป กล่าวคือแทนที่จะเป็นการลู่เข้าไปสู่คำตอบที่เป็นค่าคงที่ การลู่เข้าของกระบวนการ MCMC เป็นการลู่เข้าสู่การแจกแจงความน่าจะเป็น\nโดยธรรมชาติของกระบวนการ MCMC เมื่อกำหนดค่าเริ่มต้นแล้ว กระบวนการจะต้องการเวลาต้องดำเนินการทวนซ้ำไปจำนวนหนึ่ง ตัวอย่างที่สุ่มจากกระบวนการจึงจะถูกสุ่มจากการแจกแจงที่เป็นสถานะคงที่ของกระบวนการ การแจกแจงสถานะคงที่นี้อาจะเป็นการแจกแจงความน่าจะเป็นภายหลังหรือไม่ก็ได้ (ประเด็นนี้จะกล่าวถึงอีกครั้งภายหลัง)\nการตรวจสอบแนวโน้มการลู่เข้าด้วย Trace plot และ Density plot\nแผนภาพร่องรอย (trace plot) และแผนภาพโค้งความหนาแน่น (density plot) เป็นเครื่องมือพื้นฐานอย่างแรก ๆ ที่ผู้วิเคราะห์มักใช้พิจารณาแนวโน้มการลู่เข้าของกระบวนการสุ่มที่สร้างจากอัลกอริทึม MCMC รูปด้านล่างแสดงตัวอย่าง Trace plot ในลักษณะที่มีแนวโน้มลู่เข้าและไม่ลู่เข้าสู่การแจกแจงความน่าจะเป็นภายหลัง\n\n\n\nDensity plot (และ Histogram) เป็นทัศนภาพอีกประเภทหนึ่งที่ให้สารสนเทศคล้ายคลึงกับ trace plot จุดเด่นคือเป็นแผนภาพที่แสดงรูปทรงการแจกแจงของการแจกแจงความน่าจะเป็นภายหลังที่สร้างขึ้นจากกระบวนการสุ่มด้วย รูปด้านล่างแสดงตัวอย่าง density plot ของตัวอย่างสุ่มพารามิเตอร์ \\(\\mu\\) และ \\(\\sigma\\)\n\n\n\nในโปรแกรม R มี package-coda ที่ช่วยอำนวยความสะดวกแก่ผู้วิเคราะห์ในการตรวจสอบ/วินิจฉัยการลู่เข้าของลูกโซ่มาร์คอฟที่สร้างขึ้นจากอัลกอริทึม MCMC\n\n\n\nหากตัวอย่างสุ่มของพารามิเตอร์ (ลูกโซ่มาร์คอฟ) ไม่ได้บันทึกไว้ในรูปแบบ mcmc object ผู้วิเคราะห์จำเป็นต้องเปลี่ยนตัวแปรที่บันทึกข้อมูลดังกล่าวให้อยู่ในรูปแบบดังกล่าวด้วยฟังก์ชัน mcmc(x, start=1, end=numeric(0), thin=1)\n\n\n\nอย่างที่กล่าวไว้ในข้างต้น แผนภาพร่องรอย และแผนภาพความหนาแน่น เป็นเครื่องมือที่ใช้สำหรับตรวจสอบพฤติกรรมของตัวอย่างหรือลูกโซ่มาร์คอฟที่จำลองขึ้นว่ามีแนวโน้มที่จะลู่เข้าไปสู่การแจกแจงสถานะคงที่หรือไม่ อย่างไรก็ตามเครื่องมือดังกล่าวไม่สามารถที่จะใช้ยืนยันได้ 100% ว่าการแจกแจงสถานะคงที่ดังกล่าวนั้นเป็นการแจกแจงความน่าจะเป็นภายหลังที่แท้จริงหรือไม่ การจะยืนยันหรือพิสูจน์ข้อสงสัยดังกล่าว ผู้วิเคราะห์จำเป็นต้องมีหลักฐานอื่น ๆ มาเพิ่มเติมเพื่อสร้างข้อสรุปในประเด็นดังกล่าว\nAutocorrelation\nกระบวนการสุ่มที่สร้างขึ้นจากอัลกอริทึม MCMC จะให้ตัวอย่างสุ่มที่มีความสัมพันธ์ระหว่างกัน ทั้งนี้เป็นเพราะตัวอย่างสุ่มที่สร้างขึ้นใหม่นั้น จะขึ้นกับตัวอย่างที่ถูกสร้างไว้ในรอบก่อนหน้าเสมอ ลักษณะดังกล่าวจึงทำให้เกิดอัตสหสัมพันธ์ขึ้นระหว่างตัวอย่างขึ้น ซึ่งมีมากน้อยต่างกันไปตามปัจจัยต่าง ๆ ที่เกี่ยวข้อง\nในการอนุมานเชิงสถิติต่าง ๆ เกี่ยวกับพารามิเตอร์ในโมเดล ผู้วิเคราะห์จะใช้ตัวอย่างสุ่มของพารามิเตอร์ที่จำลองขึ้นจากกระบวนการ MCMC ดังกล่าว เพื่อวิเคราะห์และสร้างข้อสรุปซึ่งการวิเคราะห์ต่าง ๆ นี้ต้องการความเป็นอิสระของตัวอย่างสุ่มเป็นเงื่อนไขจำเป็นในการวิเคราะห์ การเกิดอัตสหสัมพันธ์ดังกล่าวจึงอาจเป็นปัญหาในการขั้นตอนของการอนุมานเชิงสถิติได้\nนอกจากนี้หากกระบวนการสุ่มดังกล่าวมีอัตสหสัมพันธ์ที่สูงในช่วงที่กว้าง ตัวอย่างที่สุ่มได้ในแต่ละรอบของการทวนซ้ำจะมีความสัมพันธ์กันสูงและย่อมมีค่าอยู่ในบริเวณที่ใกล้เคียงกัน ส่งผลให้พฤติกรรมของกระบวนการสุ่มดังกล่าวมีแนวโน้มการเดินที่ช้าและใช้เวลานานกว่ากระบวนการดังกล่าวจะลู่เข้าไปสู่การแจกแจงสถานะคงตัว\nจากเหตุผลในข้างต้น ปัญหาอัตสหสัมพันธ์ของกระบวนการ MCMC จึงเป็นปัญหาที่ต้องตรวจสอบและแก้ไขก่อนที่จะนำตัวอย่างสุ่มดังกล่าวไปใช้ในขั้นการอนุมานเชิงสถิติ\nค่าอัตสหสัมพันธ์สามารถคำนวณได้โดยใช้สูตรเดียวกับสหสัมพันธ์ของเพียร์สัน โดยเป็นการหาสหสัมพันธ์ระหว่างข้อมูลสองชุด ชุดแรกคือตัวอย่างของพารามิเตอร์ \\(\\theta_m, \\theta_{m-1}, \\theta_{m-2}, ...,\\theta_{2}\\) และชุดที่สองคือตัวอย่างของพารามิเตอร์ที่มีการเหลื่อมค่า 1 ช่วงเวลา \\(\\theta_{m-1}, \\theta_{m-2},...,\\theta_{1}\\) สหสัมพันธ์ระหว่างชุดข้อมูลทั้งสองนี้เรียกว่า อัตสหสัมพันธ์อันดับที่ 1 (lag-1 autocorrelation)\nในทำนองเดียวกัน อัตสหสัมพันธ์ในอันดับที่สูงกว่า 1 สามารถหาได้โดยการเหลื่อมข้อมูลเพิ่มขึ้นเป็น 2, 3, 4 ,… ช่วงเวลา ข้อสังเกตคือยิ่งมีการเหลื่อมช่วงเวลามากขึ้น จำนวนตัวอย่างที่นำมาคำนวณค่าอัตสหสัมพันธ์ก็จะลดลงทีละ 1 หน่วยไปเรื่อย ๆ การวิเคราะห์อัตสหสัมพันธ์ของกระบวนการสุ่มสามารถทำได้สองลักษณะ ลักษณะแรกคือวิเคราะห์จากค่าสถิติโดยตรง และลักษณะที่สองคือใช้แผนภาพอัตสหสัมพันธ์ โดยทั้งสองแบบสามารถทำได้ในโปรแกรม R ด้วย package-coda โดยเขียนคำสั่งดังนี้\n\n       mu_sdpro1 sigma_sdpro1   mu_sdpro2 sigma_sdpro2 mu_sdpro3\nLag 0  1.0000000    1.0000000  1.00000000   1.00000000 1.0000000\nLag 1  0.9994292    0.9998234  0.82152505   0.72753970 0.9860251\nLag 5  0.9971468    0.9990995  0.39664748   0.18920770 0.9336869\nLag 10 0.9942847    0.9981647  0.17519306   0.04112503 0.8774738\nLag 50 0.9709985    0.9898665 -0.02851881  -0.02866540 0.5591402\n       sigma_sdpro3\nLag 0     1.0000000\nLag 1     0.9832460\nLag 5     0.9159518\nLag 10    0.8293820\nLag 50    0.4494689\n\n\nThining\nการแก้ปัญหาอัตสหสัมพันธ์สามารถทำได้โดยการกำหนดรอบการทวนซ้ำให้มากขึ้น เขียนแทนด้วย \\(\\theta_1, \\theta_2, \\theta_3, ...,\\theta_m\\) หาก \\(n_0\\) คือระยะห่าง (lag) ที่น้อยที่สุดระหว่างตัวอย่างที่มีค่าอัตสหสัมพันธ์เท่ากับหรือใกล้เคียง 0 ผู้วิเคราะห์จะเลือกเฉพาะตัวอย่าง \\(\\theta_{n_0}, \\theta_{2n_0}, \\theta_{3n_0},...,\\theta_{T}\\) ซึ่งมีแนวโน้มเป็นอิสระซึ่งกันและกัน ไปดำเนินการต่อในขั้นการอนุมานเชิงสถิติ เรียกการดำเนินการในข้างต้นว่า thinning\nEffective Sample Size (ESS)\nจากที่กล่าวในข้างต้นจะเห็นว่า ในสถานการณ์ที่กระบวนการสุ่มที่สร้างขึ้นมีอัตสหสัมพันธ์สูง ตัวอย่างสุ่มของพารามิเตอร์จะมีแนวโน้มซ้ำซ้อนกันมาก และทำให้การทวนซ้ำของกระบวนการสุ่มมีประสิทธิภาพต่ำกว่าจำนวนการทวนซ้ำที่กำหนดไว้ กล่าวคือจำนวนรอบทวนซ้ำที่กำหนดไว้อาจไม่เพียงพอที่จะนำไปประมาณการแจกแจงความน่าจะเป็นภายหลัง สถิติที่ช่วยวัดประสิทธิภาพในด้านนี้คือ effective sample size (ESS)\nกำหนดให้ \\(\\theta_1, \\theta_2, \\theta_3, ...,\\theta_m\\) เป็นตัวอย่างสุ่มของพารามิเตอร์ที่สร้างขึ้นจากอัลกอริทึม MCMC และ \\(n_0\\) เป็นระยะห่าง (lag) ที่น้อยที่สุดที่ตัวอย่างสุ่มของพารามิเตอร์มีอัตสหสัมพันธ์เท่ากับหรือใกล้เคียง 0 จากการกำหนดในข้างต้นจะได้ว่า ตัวอย่างสุ่มที่สร้างจากกระบวนการสุ่มข้างต้น และเป็นอิสระซึ่งกันและกันคือ\n\\(\\theta_{n_0}, \\theta_{2n_0}, \\theta_{3n_0},...,\\theta_{T}\\)\nจะเห็นว่าในกรณีที่เกิดอัตสหสัมพันธ์ขึ้น ตัวอย่างที่เป็นอิสระซึ่งกันและกันจะมีจำนวนน้อยกว่าจำนวนตัวอย่างรวม ค่า ESS จึงมีค่าเท่ากับ \\(m/n_0\\)\nการคำนวณค่า ESS ใน R สามารถทำได้โดยใช้ฟังก์ชัน effectiveSize()\n\n   mu_sdpro1 sigma_sdpro1    mu_sdpro2 sigma_sdpro2    mu_sdpro3 \n   1.4270665    0.4414857  489.8072701  788.4212271   28.6767087 \nsigma_sdpro3 \n  41.3083142 \n\nMonte Carlo Standard Error\n\n\nIterations = 1:5000\nThinning interval = 1 \nNumber of chains = 1 \nSample size per chain = 5000 \n\n1. Empirical mean and standard deviation for each variable,\n   plus standard error of the mean:\n\n               Mean      SD Naive SE Time-series SE\nmu_sdpro1    85.068 15.8021 0.223475      13.227925\nsigma_sdpro1 21.291 10.9451 0.154787      16.472555\nmu_sdpro2    99.119  0.1826 0.002582       0.008250\nsigma_sdpro2  9.944  0.1291 0.001825       0.004596\nmu_sdpro3    99.134  0.1512 0.002138       0.028234\nsigma_sdpro3  9.941  0.1132 0.001601       0.017609\n\n2. Quantiles for each variable:\n\n               2.5%    25%    50%   75% 97.5%\nmu_sdpro1    51.757 72.609 91.524 99.09 99.49\nsigma_sdpro1  9.753 10.005 19.253 33.43 36.84\nmu_sdpro2    98.770 99.002 99.116 99.25 99.47\nsigma_sdpro2  9.697  9.855  9.940 10.03 10.20\nmu_sdpro3    98.823 99.077 99.176 99.24 99.38\nsigma_sdpro3  9.693  9.879  9.948 10.01 10.15\n\n\\(SE_{naive}=\\sqrt{\\frac{Var(\\theta)}{m}}\\)\n\\(SE_{ts}=\\sqrt{\\frac{Var_{ts}(\\theta)}{m}}\\) โดยที่ \\(Var(\\theta)=\\frac{\\sigma^2}{(1-\\sum_{k=1}^K\\rho_k)^2}\\)\n\\(\\sigma^2\\) เป็นความแปรปรวนของความคลาดเคลื่อนสุ่มที่ประมาณจากโมเดล autoregressive (AR) อันดับที่ K ส่วน \\(\\rho_k\\) คือค่าสัมประสิทธิ์อัตสหสัมพันธ์อันดับที่ \\(k\\)\nPotential Scale Reduction (\\(\\hat{R}\\) หรือ RSRF)\nการตรวจสอบการลู่เข้าของลูกโซ่มาร์คอฟด้วยวิธีการที่กล่าวมา แม้จะได้ผลลัพธ์ว่ามีแนวโน้มที่ตัวอย่างลูกโซ่จะลู่เข้าไปสู่การแจกแจงใดการแจกแจงหนึ่ง แต่ก็ยังไม่สามารถยืนยันได้ว่าการแจกแจงดังกล่าวเป็นการแจกแจงเป้าหมายที่แท้จริงหรือไม่\nวิธีการหนึ่งที่ช่วยเพิ่มหลักฐานและเสริมความมั่นใจให้กับผู้วิเคราะห์ว่า ตัวอย่างลูกโซ่ที่สร้างขึ้นมีการแจกแจงที่ลู่เข้าไปหาการแจกแจงความน่าจะเป็นภายหลังที่ต้องการจริง ๆ คือ การสร้างตัวอย่างลูกโซ่หลาย ๆ ชุด โดยกำหนดค่าเริ่มต้นให้แตกต่างกัน จากนั้นสังเกตผลลัพธ์ที่ได้ หากตัวอย่างทุกชุดมีแนวโน้มที่ลู่เข้าไปหาการแจกแจงเดียวกัน ผู้วิเคราะห์จะมีหลักฐานที่สนับสนุนให้เชื่อได้ว่าตัวอย่างสุ่มที่สร้างขึ้นจากอัลกอริทึม MCMC ลู่เข้าไปหาการแจกแจงความน่าจะเป็นภายหลังที่ต้องการ\nการวิเคราะห์การลู่เข้านี้สามารถวิเคราะห์ได้จากทั้ง trace plot และ density plot และใช้ค่าสถิติ potential scale reduction (\\(\\hat{R}\\)) สถิตินี้มีค่าเท่ากับอัตราส่วนระหว่างความแปรปรวนรวม (total variance) ของตัวอย่างลูกโซ่ต่อความแปรปรวนภายลูกโซ่ (within-chain variance) ดังนี้\n\\(\\hat{R}=\\sqrt{\\frac{Var(\\theta)}{W}}\\)\nโดยที่ \\(Var(\\theta)=(1-\\frac{1}{m}W+\\frac{1}{m}B)\\)\n\\(W=\\frac{1}{C}\\sum_{j=1}^CS^2_j\\)\n\\(S^2_j=\\frac{1}{n-1}\\sum_{i=1}^n(\\theta_{ij}-\\overline{\\theta}_{.j})^2\\)\n\\(B = \\frac{n}{C-n}\\sum_{j=1}^C(\\overline{\\theta}_j-\\overline{\\theta}_{..})\\)\nจากสูตรของ \\(\\hat{R}\\) ข้างต้นจะเห็นว่า ถ้า \\(\\hat{R} \\approx 1\\) นั่นหมายความว่าตัวอย่างลูกโซ่ที่สร้างขึ้นแต่ละชุด มีการแจกแจงที่ใกล้เคียงกัน กล่าวคือตัวอย่างลูกโซ่ที่สร้างขึ้นมีคุณสมบัติลู่เข้าไปยังการแจกแจงความน่าจะเป็นภายหลังที่ต้องการ แต่ถ้าหาก \\(\\hat{R}>1\\) บ่งชี้ว่าตัวอย่างลูกโซ่ที่สร้างขึ้นมีการลู่ออก\nเกณฑ์การพิจารณา \\(\\hat{R}<1.1\\)\nนอกจากอัลกอริทึมที่กล่าวไว้ในบทเรียนนี้ยังมีอัลกอริทึม MCMC อีกหลายตัวที่สามารถใช้ประมาณการแจกแจงความน่าจะเป็นภายหลังได้ อีกอัลกอริทึมหนึ่งที่น่าสนใจคือ อัลกอริทึม Hamiltonial Monte Carlo ที่มีประสิทธิภาพสูงกว่า Metropilis และ Gibbs sampling ในแง่ของการลู่เข้าสู่การแจกแจงความน่าจะเป็นภายหลังที่ทำได้รวดเร็วกว่า ทำให้ไม่จำเป็นต้องใช้จำนวนรอบของการทวนซ้ำที่มากเท่ากับทั้งสองอัลกอริทึมข้างต้น แต่ก็มีข้อจำกัดคือในแต่ละรอบการทวนซ้ำอัลกอริทึม Hammiltoniam MCMC มีแนวโน้มที่จะใช้เวลาประมวลผลนานกว่าอัลกอริทึมทั้งสอง รายละเอียดของอัลกอริทึมนี้จะกล่าวในบทเรียนที่สอนการใช้งานโปรแกรม Stan\nบทเรียนต่อไปจะกล่าวถึงการใช้งานโปรแกรม JAGs ที่เป็นโปรแกรมสำเร็จรูปโปรแกรมหนึ่งที่ใช้สำหรับประมาณการแจกแจงความน่าจะเป็นภายหลังโดยอาศัยอัลกอริทึม Gibbs sampling ในข้างต้น\nnext –> Introduction to JAGs\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": "posts/2022-02-03-mcmc-via-jags/mcmc-via-jags_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-02-11T20:37:27+07:00",
    "input_file": {}
  }
]
